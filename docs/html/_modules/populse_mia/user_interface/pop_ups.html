<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>populse_mia.user_interface.pop_ups &#8212; populse_mia 3.0.0-dev+881d2af6 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=f63d8bfa" />
    <link rel="stylesheet" type="text/css" href="../../../_static/haiku.css?v=dfa0e015" />
    <script src="../../../_static/documentation_options.js?v=a73ba755"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="https://unpkg.com/mermaid@10.2.0/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../../../index.html">
          <span>populse_mia 3.0.0-dev+881d2af6 documentation</span></a></h1>
        <h2 class="heading"><span>populse_mia.user_interface.pop_ups</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        <a class="uplink" href="../../../index.html">Contents</a>
        </p>

      </div>
      <div class="content" role="main">
        
        
  <h1>Source code for populse_mia.user_interface.pop_ups</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module that defines all the pop-ups used across the Mia software.</span>

<span class="sd">:Contains:</span>
<span class="sd">    :Class:</span>
<span class="sd">        - ClickableLabel</span>
<span class="sd">        - DefaultValueListCreation</span>
<span class="sd">        - DefaultValueQLineEdit</span>
<span class="sd">        - PopUpAddPath</span>
<span class="sd">        - PopUpAddTag</span>
<span class="sd">        - PopUpCloneTag</span>
<span class="sd">        - PopUpClosePipeline</span>
<span class="sd">        - PopUpDataBrowserCurrentSelection</span>
<span class="sd">        - PopUpDeletedProject</span>
<span class="sd">        - PopUpDeleteProject</span>
<span class="sd">        - PopUpFilterSelection</span>
<span class="sd">        - PopUpInformation</span>
<span class="sd">        - PopUpInheritanceDict</span>
<span class="sd">        - PopUpMultipleSort</span>
<span class="sd">        - PopUpNewProject</span>
<span class="sd">        - PopUpOpenProject</span>
<span class="sd">        - PopUpPreferences</span>
<span class="sd">        - PopUpProperties</span>
<span class="sd">        - PopUpQuit</span>
<span class="sd">        - PopUpRemoveScan</span>
<span class="sd">        - PopUpRemoveTag</span>
<span class="sd">        - PopUpSaveProjectAs</span>
<span class="sd">        - PopUpSeeAllProjects</span>
<span class="sd">        - PopUpSelectFilter</span>
<span class="sd">        - PopUpSelectIteration</span>
<span class="sd">        - PopUpTagSelection  (must precede PopUpSelectTag)</span>
<span class="sd">        - PopUpSelectTag</span>
<span class="sd">        - PopUpSelectTagCountTable</span>
<span class="sd">        - PopUpShowHistory</span>
<span class="sd">        - PopUpVisualizedTags</span>
<span class="sd">        - QLabel_clickable</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">##########################################################################</span>
<span class="c1"># Populse_mia - Copyright (C) IRMaGe/CEA, 2018</span>
<span class="c1"># Distributed under the terms of the CeCILL license, as published by</span>
<span class="c1"># the CEA-CNRS-INRIA. Refer to the LICENSE file or to</span>
<span class="c1"># http://www.cecill.info/licences/Licence_CeCILL_V2.1-en.html</span>
<span class="c1"># for details.</span>
<span class="c1">##########################################################################</span>

<span class="kn">import</span> <span class="nn">ast</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">get_origin</span>

<span class="kn">import</span> <span class="nn">yaml</span>

<span class="c1"># Capsul imports</span>
<span class="kn">from</span> <span class="nn">capsul.api</span> <span class="kn">import</span> <span class="n">capsul_engine</span>
<span class="kn">from</span> <span class="nn">capsul.pipeline.pipeline_nodes</span> <span class="kn">import</span> <span class="n">PipelineNode</span>
<span class="kn">from</span> <span class="nn">capsul.qt_gui.widgets.pipeline_developer_view</span> <span class="kn">import</span> <span class="n">PipelineDeveloperView</span>
<span class="kn">from</span> <span class="nn">capsul.qt_gui.widgets.settings_editor</span> <span class="kn">import</span> <span class="n">SettingsEditor</span>

<span class="c1"># PyQt5 imports</span>
<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">QAbstractItemView</span><span class="p">,</span>
    <span class="n">QApplication</span><span class="p">,</span>
    <span class="n">QCheckBox</span><span class="p">,</span>
    <span class="n">QComboBox</span><span class="p">,</span>
    <span class="n">QDialog</span><span class="p">,</span>
    <span class="n">QDialogButtonBox</span><span class="p">,</span>
    <span class="n">QFileDialog</span><span class="p">,</span>
    <span class="n">QFormLayout</span><span class="p">,</span>
    <span class="n">QGroupBox</span><span class="p">,</span>
    <span class="n">QHBoxLayout</span><span class="p">,</span>
    <span class="n">QHeaderView</span><span class="p">,</span>
    <span class="n">QInputDialog</span><span class="p">,</span>
    <span class="n">QLabel</span><span class="p">,</span>
    <span class="n">QLineEdit</span><span class="p">,</span>
    <span class="n">QListWidget</span><span class="p">,</span>
    <span class="n">QListWidgetItem</span><span class="p">,</span>
    <span class="n">QMessageBox</span><span class="p">,</span>
    <span class="n">QPlainTextEdit</span><span class="p">,</span>
    <span class="n">QPushButton</span><span class="p">,</span>
    <span class="n">QRadioButton</span><span class="p">,</span>
    <span class="n">QScrollArea</span><span class="p">,</span>
    <span class="n">QSpinBox</span><span class="p">,</span>
    <span class="n">QSplitter</span><span class="p">,</span>
    <span class="n">QTableWidget</span><span class="p">,</span>
    <span class="n">QTableWidgetItem</span><span class="p">,</span>
    <span class="n">QTabWidget</span><span class="p">,</span>
    <span class="n">QTreeWidget</span><span class="p">,</span>
    <span class="n">QTreeWidgetItem</span><span class="p">,</span>
    <span class="n">QVBoxLayout</span><span class="p">,</span>
    <span class="n">QWidget</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Populse_mia imports</span>
<span class="kn">from</span> <span class="nn">populse_mia.data_manager</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">BRICK_EXEC</span><span class="p">,</span>
    <span class="n">BRICK_EXEC_TIME</span><span class="p">,</span>
    <span class="n">BRICK_INIT</span><span class="p">,</span>
    <span class="n">BRICK_INIT_TIME</span><span class="p">,</span>
    <span class="n">BRICK_INPUTS</span><span class="p">,</span>
    <span class="n">BRICK_NAME</span><span class="p">,</span>
    <span class="n">BRICK_OUTPUTS</span><span class="p">,</span>
    <span class="n">COLLECTION_BRICK</span><span class="p">,</span>
    <span class="n">COLLECTION_CURRENT</span><span class="p">,</span>
    <span class="n">COLLECTION_HISTORY</span><span class="p">,</span>
    <span class="n">COLLECTION_INITIAL</span><span class="p">,</span>
    <span class="n">FIELD_TYPE_BOOLEAN</span><span class="p">,</span>
    <span class="n">FIELD_TYPE_DATE</span><span class="p">,</span>
    <span class="n">FIELD_TYPE_DATETIME</span><span class="p">,</span>
    <span class="n">FIELD_TYPE_FLOAT</span><span class="p">,</span>
    <span class="n">FIELD_TYPE_INTEGER</span><span class="p">,</span>
    <span class="n">FIELD_TYPE_LIST_BOOLEAN</span><span class="p">,</span>
    <span class="n">FIELD_TYPE_LIST_DATE</span><span class="p">,</span>
    <span class="n">FIELD_TYPE_LIST_DATETIME</span><span class="p">,</span>
    <span class="n">FIELD_TYPE_LIST_FLOAT</span><span class="p">,</span>
    <span class="n">FIELD_TYPE_LIST_INTEGER</span><span class="p">,</span>
    <span class="n">FIELD_TYPE_LIST_STRING</span><span class="p">,</span>
    <span class="n">FIELD_TYPE_LIST_TIME</span><span class="p">,</span>
    <span class="n">FIELD_TYPE_STRING</span><span class="p">,</span>
    <span class="n">FIELD_TYPE_TIME</span><span class="p">,</span>
    <span class="n">HISTORY_BRICKS</span><span class="p">,</span>
    <span class="n">HISTORY_PIPELINE</span><span class="p">,</span>
    <span class="n">TAG_CHECKSUM</span><span class="p">,</span>
    <span class="n">TAG_FILENAME</span><span class="p">,</span>
    <span class="n">TAG_HISTORY</span><span class="p">,</span>
    <span class="n">TAG_ORIGIN_USER</span><span class="p">,</span>
    <span class="n">TAG_TYPE</span><span class="p">,</span>
    <span class="n">TAG_UNIT_DEGREE</span><span class="p">,</span>
    <span class="n">TAG_UNIT_HZPIXEL</span><span class="p">,</span>
    <span class="n">TAG_UNIT_MHZ</span><span class="p">,</span>
    <span class="n">TAG_UNIT_MM</span><span class="p">,</span>
    <span class="n">TAG_UNIT_MS</span><span class="p">,</span>
    <span class="n">TYPE_MAT</span><span class="p">,</span>
    <span class="n">TYPE_NII</span><span class="p">,</span>
    <span class="n">TYPE_TXT</span><span class="p">,</span>
    <span class="n">TYPE_UNKNOWN</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">populse_mia.data_manager.project</span> <span class="kn">import</span> <span class="n">Project</span>
<span class="kn">from</span> <span class="nn">populse_mia.software_properties</span> <span class="kn">import</span> <span class="n">Config</span>
<span class="kn">from</span> <span class="nn">populse_mia.user_interface.data_browser</span> <span class="kn">import</span> <span class="n">data_browser</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="ClickableLabel">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.ClickableLabel">[docs]</a>
<span class="k">class</span> <span class="nc">ClickableLabel</span><span class="p">(</span><span class="n">QLabel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A QLabel subclass that emits a signal when clicked.</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - mousePressEvent: overrides the mousePressEvent method by emitting</span>
<span class="sd">          the clicked signal</span>

<span class="sd">    .. Signals:</span>
<span class="sd">        - clicked(): Emitted when the label is clicked.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">clicked</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>

<div class="viewcode-block" id="ClickableLabel.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.ClickableLabel.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the ClickableLabel.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span></div>


<div class="viewcode-block" id="ClickableLabel.mousePressEvent">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.ClickableLabel.mousePressEvent">[docs]</a>
    <span class="k">def</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles the mouse press event by emitting the `clicked` signal.</span>

<span class="sd">        :param event (QMouseEvent): The mouse event triggering the signal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="DefaultValueListCreation">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.DefaultValueListCreation">[docs]</a>
<span class="k">class</span> <span class="nc">DefaultValueListCreation</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A dialog for creating or editing a list&#39;s default value.</span>

<span class="sd">    This widget allows users to input and manage a list of values</span>
<span class="sd">    based on a specified type (e.g., integers, floats, booleans, etc.).</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - add_element(): Adds one more element to the list.</span>
<span class="sd">        - default_init_table(): Initializes the table with a default value</span>
<span class="sd">                                when no previous value exists.</span>
<span class="sd">        - remove_element(): Removes the last element from the list.</span>
<span class="sd">        - resize_table(): Adjusts the popup size based on the table content.</span>
<span class="sd">        - update_default_value(): Validates user input and updates the</span>
<span class="sd">                                  parent&#39;s default value.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="DefaultValueListCreation.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.DefaultValueListCreation.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the DefaultValueListCreation dialog.</span>

<span class="sd">        :param parent (DefaultValueQLineEdit): The parent object.</span>
<span class="sd">        :param type (Type): The type of the list elements (e.g., int,</span>
<span class="sd">                            float, str).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setModal</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Current type chosen</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Adding a list of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="c1"># The table that will be filled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">QTableWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">list_value</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">list_value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="c1"># If the previous value was already a list, we fill it</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setColumnCount</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_value</span><span class="p">))</span>

                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">list_value</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)))</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">default_init_table</span><span class="p">()</span>

            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">default_init_table</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_init_table</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">resize_table</span><span class="p">()</span>
        <span class="c1"># Ok button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ok_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Ok&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ok_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_default_value</span><span class="p">)</span>
        <span class="c1"># Cancel button</span>
        <span class="n">cancel_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Cancel&quot;</span><span class="p">)</span>
        <span class="n">cancel_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="c1"># Button to add an element to the list</span>
        <span class="n">sources_images_dir</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span><span class="o">.</span><span class="n">getSourceImageDir</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_element_label</span> <span class="o">=</span> <span class="n">ClickableLabel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_element_label</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;plus&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_element_label</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sources_images_dir</span><span class="p">,</span> <span class="s2">&quot;green_plus.png&quot;</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">scaledToHeight</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_element_label</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_element</span><span class="p">)</span>
        <span class="c1"># Button to remove the last element of the list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_element_label</span> <span class="o">=</span> <span class="n">ClickableLabel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_element_label</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;minus&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_element_label</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span>
            <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sources_images_dir</span><span class="p">,</span> <span class="s2">&quot;red_minus.png&quot;</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">scaledToHeight</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_element_label</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_element</span><span class="p">)</span>
        <span class="c1"># Layouts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_element_label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_element_label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_final</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_final</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ok_button</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_final</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">cancel_button</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_box_final</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_box_final</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_box_final</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_box_final</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_box_final</span><span class="p">)</span></div>


<div class="viewcode-block" id="DefaultValueListCreation.add_element">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.DefaultValueListCreation.add_element">[docs]</a>
    <span class="k">def</span> <span class="nf">add_element</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a new empty element to the list.</span>

<span class="sd">        Increases the number of columns in the table by one and adds</span>
<span class="sd">        an empty `QTableWidgetItem` for user input.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setColumnCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">columnCount</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">columnCount</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resize_table</span><span class="p">()</span></div>


<div class="viewcode-block" id="DefaultValueListCreation.default_init_table">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.DefaultValueListCreation.default_init_table">[docs]</a>
    <span class="k">def</span> <span class="nf">default_init_table</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the table with a default value.</span>

<span class="sd">        If no previous value exists, the table is set up with a single empty</span>
<span class="sd">        column to allow user input.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Table filled with a single element at the beginning if no value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setColumnCount</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">())</span></div>


<div class="viewcode-block" id="DefaultValueListCreation.remove_element">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.DefaultValueListCreation.remove_element">[docs]</a>
    <span class="k">def</span> <span class="nf">remove_element</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes the last element from the list.</span>

<span class="sd">        Ensures that at least one column remains to prevent an empty table.</span>
<span class="sd">        Adjusts the table size accordingly.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">columnCount</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setColumnCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">columnCount</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resize_table</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjustSize</span><span class="p">()</span></div>


<div class="viewcode-block" id="DefaultValueListCreation.resize_table">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.DefaultValueListCreation.resize_table">[docs]</a>
    <span class="k">def</span> <span class="nf">resize_table</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adjusts the size of the popup window based on the table content.</span>

<span class="sd">        Dynamically resizes the table width and height based on the number</span>
<span class="sd">        of columns and rows, with a maximum width limit of 900 pixels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">resizeColumnsToContents</span><span class="p">()</span>
        <span class="n">total_width</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">columnWidth</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">columnCount</span><span class="p">())</span>
        <span class="p">)</span>
        <span class="n">total_height</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">rowHeight</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">rowCount</span><span class="p">())</span>
        <span class="p">)</span>
        <span class="n">max_width</span> <span class="o">=</span> <span class="mi">900</span>
        <span class="n">padding</span> <span class="o">=</span> <span class="mi">20</span> <span class="k">if</span> <span class="n">total_width</span> <span class="o">+</span> <span class="mi">20</span> <span class="o">&lt;</span> <span class="n">max_width</span> <span class="k">else</span> <span class="mi">40</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">total_width</span> <span class="o">+</span> <span class="mi">20</span><span class="p">,</span> <span class="n">max_width</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setFixedHeight</span><span class="p">(</span><span class="n">total_height</span> <span class="o">+</span> <span class="n">padding</span><span class="p">)</span></div>


<div class="viewcode-block" id="DefaultValueListCreation.update_default_value">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.DefaultValueListCreation.update_default_value">[docs]</a>
    <span class="k">def</span> <span class="nf">update_default_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates user input and updates the parent&#39;s default value.</span>

<span class="sd">        Converts table values to the specified list type, ensuring that</span>
<span class="sd">        each entry is valid. If any value is invalid, a warning message</span>
<span class="sd">        is displayed, and the update is aborted.</span>

<span class="sd">        If all values are valid, they are stored in the parent widget,</span>
<span class="sd">        and the dialog is closed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">type_parsers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">FIELD_TYPE_LIST_INTEGER</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
            <span class="n">FIELD_TYPE_LIST_FLOAT</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
            <span class="n">FIELD_TYPE_LIST_BOOLEAN</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;True&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;False&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}[</span>
                <span class="n">x</span>
            <span class="p">],</span>
            <span class="n">FIELD_TYPE_LIST_STRING</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">FIELD_TYPE_LIST_DATE</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span>
                <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">(),</span>
            <span class="n">FIELD_TYPE_LIST_DATETIME</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span>
                <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y %H:%M:%S.</span><span class="si">%f</span><span class="s2">&quot;</span>
            <span class="p">),</span>
            <span class="n">FIELD_TYPE_LIST_TIME</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span>
                <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;%H:%M:%S.</span><span class="si">%f</span><span class="s2">&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span>
        <span class="p">}</span>
        <span class="n">database_value</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">columnCount</span><span class="p">()):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="k">if</span> <span class="n">item</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">database_value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">type_parsers</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">](</span><span class="n">text</span><span class="p">))</span>

            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">):</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
                <span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">)</span>
                <span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Invalid value&quot;</span><span class="p">)</span>
                <span class="n">msg</span><span class="o">.</span><span class="n">setInformativeText</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The value &#39;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&#39; is invalid for type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>
                <span class="n">msg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">msg</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>
                <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">database_value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="DefaultValueQLineEdit">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.DefaultValueQLineEdit">[docs]</a>
<span class="k">class</span> <span class="nc">DefaultValueQLineEdit</span><span class="p">(</span><span class="n">QLineEdit</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A QLineEdit override for handling default values.</span>

<span class="sd">    This class customizes QLineEdit to handle list-type default values by</span>
<span class="sd">    displaying a popup when clicked.</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - mousePressEvent: Mouse pressed on the QLineEdit</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="DefaultValueQLineEdit.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.DefaultValueQLineEdit.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param parent: The parent widget, expected to have a `type` attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span></div>


<div class="viewcode-block" id="DefaultValueQLineEdit.mousePressEvent">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.DefaultValueQLineEdit.mousePressEvent">[docs]</a>
    <span class="k">def</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles mouse press events.</span>

<span class="sd">        If the parent&#39;s type is a list, displays a popup for list creation.</span>

<span class="sd">        :param event (QMouseEvent): The mouse press event (unused).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">get_origin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="c1"># We display the pop up to create the list if the checkbox is</span>
            <span class="c1"># checked, otherwise we do nothing</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_creation</span> <span class="o">=</span> <span class="n">DefaultValueListCreation</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">type</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_creation</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PopUpAddPath">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpAddPath">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpAddPath</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog for adding a document to the project without using the MRI Files</span>
<span class="sd">    Manager (File &gt; Import).</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - file_to_choose: Opens a file dialog to choose a document.</span>
<span class="sd">        - find_type: Determines the document type when the file path changes.</span>
<span class="sd">        - save_path: Adds the file path to the database and updates the UI.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PopUpAddPath.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpAddPath.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">databrowser</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the pop-up for adding a document.</span>

<span class="sd">        :param project (Project): The current project instance.</span>
<span class="sd">        :param databrowser (DataBrowser): The application&#39;s data browser.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span> <span class="o">=</span> <span class="n">databrowser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Add a document&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setModal</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">vbox_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="c1"># File selection layout</span>
        <span class="n">file_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">file_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;File: &quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_line_edit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_line_edit</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_line_edit</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_type</span><span class="p">)</span>
        <span class="n">file_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Choose a document&quot;</span><span class="p">)</span>
        <span class="n">file_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_to_choose</span><span class="p">)</span>
        <span class="n">file_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">file_label</span><span class="p">)</span>
        <span class="n">file_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_line_edit</span><span class="p">)</span>
        <span class="n">file_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">file_button</span><span class="p">)</span>
        <span class="n">vbox_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">file_layout</span><span class="p">)</span>
        <span class="c1"># File type layout</span>
        <span class="n">type_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">type_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Type: &quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_line_edit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="n">type_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">type_label</span><span class="p">)</span>
        <span class="n">type_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_line_edit</span><span class="p">)</span>
        <span class="n">vbox_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">type_layout</span><span class="p">)</span>
        <span class="c1"># Action buttons layout</span>
        <span class="n">button_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ok_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Ok&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ok_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_path</span><span class="p">)</span>
        <span class="n">cancel_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Cancel&quot;</span><span class="p">)</span>
        <span class="n">cancel_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ok_button</span><span class="p">)</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">cancel_button</span><span class="p">)</span>
        <span class="n">vbox_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">button_layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">vbox_layout</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpAddPath.file_to_choose">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpAddPath.file_to_choose">[docs]</a>
    <span class="k">def</span> <span class="nf">file_to_choose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens a file dialog for selecting documents.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fname</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileNames</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Choose a document to import&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">fname</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_line_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fname</span><span class="p">))</span></div>


<div class="viewcode-block" id="PopUpAddPath.find_type">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpAddPath.find_type">[docs]</a>
    <span class="k">def</span> <span class="nf">find_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines the document type when the file path changes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file_paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_line_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

        <span class="c1"># If the input is empty, clear the type field</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_paths</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type_line_edit</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">file_list</span> <span class="o">=</span> <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">file_paths</span><span class="p">)</span>

        <span class="k">except</span> <span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type_line_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">([</span><span class="n">TYPE_UNKNOWN</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_paths</span><span class="p">)))</span>
            <span class="k">return</span>

        <span class="n">type_mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;.nii&quot;</span><span class="p">:</span> <span class="n">TYPE_NII</span><span class="p">,</span> <span class="s2">&quot;.mat&quot;</span><span class="p">:</span> <span class="n">TYPE_MAT</span><span class="p">,</span> <span class="s2">&quot;.txt&quot;</span><span class="p">:</span> <span class="n">TYPE_TXT</span><span class="p">}</span>
        <span class="n">file_types</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">type_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">TYPE_UNKNOWN</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">file_list</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_line_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_types</span><span class="p">))</span></div>


<div class="viewcode-block" id="PopUpAddPath.save_path">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpAddPath.save_path">[docs]</a>
    <span class="k">def</span> <span class="nf">save_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds the selected document paths to the database and updates the UI.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">path_list</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_line_edit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_line_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">path_type_list</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">ast</span><span class="o">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_line_edit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_line_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="k">except</span> <span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;- Invalid Data! -&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setInformativeText</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid file(s) in:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path_list</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; or type format(s) in:</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path_type_list</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Warning: Invalid data!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">buttonClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
            <span class="n">doc_in_db</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_document_names</span><span class="p">(</span><span class="n">COLLECTION_CURRENT</span><span class="p">)</span>
            <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">unsavedModifications</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">for</span> <span class="n">path</span><span class="p">,</span> <span class="n">path_type</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">path_list</span><span class="p">,</span> <span class="n">path_type_list</span><span class="p">):</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">doc_in_db</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="si">}</span><span class="s2"> -&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setInformativeText</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The document &#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39; </span><span class="se">\n</span><span class="s2"> &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;already exists in the Data Browser!&quot;</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Warning: existing data!&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">buttonClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">path_type</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Invalid arguments&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setInformativeText</span><span class="p">(</span>
                    <span class="s2">&quot;The path must exist.</span><span class="se">\n</span><span class="s2">The path type can&#39;t be empty.&quot;</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">buttonClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                <span class="k">continue</span>

            <span class="c1"># Prepare history tracking</span>
            <span class="n">history_maker</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;add_scans&quot;</span><span class="p">]</span>
            <span class="n">values_added</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># Copy file to project directory</span>
            <span class="n">rel_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;downloaded_data&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            <span class="n">copy_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">folder</span><span class="p">,</span> <span class="n">rel_path</span><span class="p">)</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">copy_path</span><span class="p">)</span>

            <span class="c1"># Compute file checksum</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">scan_file</span><span class="p">:</span>
                <span class="n">checksum</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="n">scan_file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

            <span class="c1"># Add document to database</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">write</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">collection</span> <span class="ow">in</span> <span class="p">(</span><span class="n">COLLECTION_INITIAL</span><span class="p">,</span> <span class="n">COLLECTION_CURRENT</span><span class="p">):</span>
                    <span class="n">database_data</span><span class="o">.</span><span class="n">add_document</span><span class="p">(</span><span class="n">collection</span><span class="p">,</span> <span class="n">rel_path</span><span class="p">)</span>
                    <span class="n">database_data</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span>
                        <span class="n">collection_name</span><span class="o">=</span><span class="n">collection</span><span class="p">,</span>
                        <span class="n">primary_key</span><span class="o">=</span><span class="n">rel_path</span><span class="p">,</span>
                        <span class="n">values_dict</span><span class="o">=</span><span class="p">{</span><span class="n">TAG_TYPE</span><span class="p">:</span> <span class="n">path_type</span><span class="p">},</span>
                    <span class="p">)</span>
                    <span class="n">database_data</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span>
                        <span class="n">collection_name</span><span class="o">=</span><span class="n">collection</span><span class="p">,</span>
                        <span class="n">primary_key</span><span class="o">=</span><span class="n">rel_path</span><span class="p">,</span>
                        <span class="n">values_dict</span><span class="o">=</span><span class="p">{</span><span class="n">TAG_CHECKSUM</span><span class="p">:</span> <span class="n">checksum</span><span class="p">},</span>
                    <span class="p">)</span>

            <span class="n">values_added</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="p">[</span><span class="n">rel_path</span><span class="p">,</span> <span class="n">TAG_TYPE</span><span class="p">,</span> <span class="n">path_type</span><span class="p">,</span> <span class="n">path_type</span><span class="p">],</span>
                    <span class="p">[</span><span class="n">rel_path</span><span class="p">,</span> <span class="n">TAG_CHECKSUM</span><span class="p">,</span> <span class="n">checksum</span><span class="p">,</span> <span class="n">checksum</span><span class="p">],</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="c1"># Update history</span>
            <span class="n">history_maker</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">rel_path</span><span class="p">],</span> <span class="n">values_added</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">undos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">history_maker</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">redos</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

            <span class="c1"># Update data browser</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
                <span class="n">scans</span> <span class="o">=</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_document_names</span><span class="p">(</span><span class="n">COLLECTION_CURRENT</span><span class="p">)</span>

            <span class="n">table_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span><span class="o">.</span><span class="n">table_data</span>
            <span class="n">table_data</span><span class="o">.</span><span class="n">scans_to_visualize</span> <span class="o">=</span> <span class="n">scans</span>
            <span class="n">table_data</span><span class="o">.</span><span class="n">scans_to_search</span> <span class="o">=</span> <span class="n">scans</span>
            <span class="n">table_data</span><span class="o">.</span><span class="n">add_columns</span><span class="p">()</span>
            <span class="n">table_data</span><span class="o">.</span><span class="n">fill_headers</span><span class="p">()</span>
            <span class="n">table_data</span><span class="o">.</span><span class="n">add_rows</span><span class="p">([</span><span class="n">rel_path</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span><span class="o">.</span><span class="n">reset_search_bar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span><span class="o">.</span><span class="n">frame_advanced_search</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span><span class="o">.</span><span class="n">advanced_search</span><span class="o">.</span><span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PopUpAddTag">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpAddTag">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpAddTag</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog for adding a new tag to the project.</span>

<span class="sd">    This dialog allows users to create a new tag by specifying its name,</span>
<span class="sd">    default value, description, unit, and type.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        signal_add_tag: Signal emitted when a new tag is successfully added</span>

<span class="sd">    Methods:</span>
<span class="sd">        - _connect_signals: Connect signals to slots</span>
<span class="sd">        - _setup_layouts: Set up the layout of UI elements</span>
<span class="sd">        - _setup_ui: Set up the dialog UI elements</span>
<span class="sd">        - _show_error: Display an error message box</span>
<span class="sd">        - ok_action: Validates input fields and adds the new tag if valid</span>
<span class="sd">        - on_activated: Updates form fields when tag type is changed</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Signal emitted when tag is successfully added</span>
    <span class="n">signal_add_tag</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>

<div class="viewcode-block" id="PopUpAddTag.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpAddTag.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">databrowser</span><span class="p">,</span> <span class="n">project</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the dialog for adding a new tag.</span>

<span class="sd">        :param databrowser: The data browser instance</span>
<span class="sd">        :param project: The current project in the software</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span> <span class="o">=</span> <span class="n">databrowser</span>
        <span class="c1"># Default tag type is string</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">FIELD_TYPE_STRING</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;Add a tag&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Add a tag&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">700</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setModal</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_ui</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connect_signals</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">_connect_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Connect signals to slots.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ok_action</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_box_type</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_activated</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setup_layouts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up the layout of UI elements.&quot;&quot;&quot;</span>
        <span class="c1"># Labels column</span>
        <span class="n">v_box_labels</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_labels</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_tag_name</span><span class="p">)</span>
        <span class="n">v_box_labels</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_default_value</span><span class="p">)</span>
        <span class="n">v_box_labels</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_description_value</span><span class="p">)</span>
        <span class="n">v_box_labels</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_unit_value</span><span class="p">)</span>
        <span class="n">v_box_labels</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_type</span><span class="p">)</span>
        <span class="c1"># Edit fields column</span>
        <span class="n">v_box_edits</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_edits</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_edit_tag_name</span><span class="p">)</span>
        <span class="n">default_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">default_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_edit_default_value</span><span class="p">)</span>
        <span class="n">v_box_edits</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">default_layout</span><span class="p">)</span>
        <span class="n">v_box_edits</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_edit_description_value</span><span class="p">)</span>
        <span class="n">v_box_edits</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_box_unit</span><span class="p">)</span>
        <span class="n">v_box_edits</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_box_type</span><span class="p">)</span>
        <span class="c1"># Main content layout</span>
        <span class="n">h_box_top</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">h_box_top</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">v_box_labels</span><span class="p">)</span>
        <span class="n">h_box_top</span><span class="o">.</span><span class="n">addSpacing</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">h_box_top</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">v_box_edits</span><span class="p">)</span>
        <span class="c1"># OK button layout</span>
        <span class="n">h_box_ok</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">h_box_ok</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">h_box_ok</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="p">)</span>
        <span class="c1"># Main dialog layout</span>
        <span class="n">v_box_total</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_total</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">h_box_top</span><span class="p">)</span>
        <span class="n">v_box_total</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">h_box_ok</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">v_box_total</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setup_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up the dialog UI elements.&quot;&quot;&quot;</span>
        <span class="n">_translate</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">translate</span>
        <span class="c1"># Create UI components</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;push_button_ok&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Add a tag&quot;</span><span class="p">,</span> <span class="s2">&quot;OK&quot;</span><span class="p">))</span>
        <span class="c1"># Tag name components</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_tag_name</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Add a tag&quot;</span><span class="p">,</span> <span class="s2">&quot;Tag name:&quot;</span><span class="p">),</span> <span class="bp">self</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_tag_name</span><span class="o">.</span><span class="n">setTextFormat</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AutoText</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_tag_name</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;tag_name&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_edit_tag_name</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_edit_tag_name</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;textEdit_tag_name&quot;</span><span class="p">)</span>
        <span class="c1"># Default value components</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_default_value</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Add a tag&quot;</span><span class="p">,</span> <span class="s2">&quot;Default value:&quot;</span><span class="p">),</span> <span class="bp">self</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_default_value</span><span class="o">.</span><span class="n">setTextFormat</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AutoText</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_default_value</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;default_value&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_edit_default_value</span> <span class="o">=</span> <span class="n">DefaultValueQLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_edit_default_value</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;textEdit_default_value&quot;</span><span class="p">)</span>
        <span class="c1"># Default value for string type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_edit_default_value</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Undefined&quot;</span><span class="p">)</span>
        <span class="c1"># Description components</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_description_value</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Add a tag&quot;</span><span class="p">,</span> <span class="s2">&quot;Description:&quot;</span><span class="p">),</span> <span class="bp">self</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_description_value</span><span class="o">.</span><span class="n">setTextFormat</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AutoText</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_description_value</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;description_value&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_edit_description_value</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_edit_description_value</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span>
            <span class="s2">&quot;textEdit_description_value&quot;</span>
        <span class="p">)</span>
        <span class="c1"># Unit components</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_unit_value</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Add a tag&quot;</span><span class="p">,</span> <span class="s2">&quot;Unit:&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_unit_value</span><span class="o">.</span><span class="n">setTextFormat</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AutoText</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_unit_value</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;unit_value&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_box_unit</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_box_unit</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;combo_box_unit&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_box_unit</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="kc">None</span><span class="p">,</span>
                <span class="n">TAG_UNIT_MS</span><span class="p">,</span>
                <span class="n">TAG_UNIT_MM</span><span class="p">,</span>
                <span class="n">TAG_UNIT_MHZ</span><span class="p">,</span>
                <span class="n">TAG_UNIT_HZPIXEL</span><span class="p">,</span>
                <span class="n">TAG_UNIT_DEGREE</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="c1"># Type components</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_type</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Add a tag&quot;</span><span class="p">,</span> <span class="s2">&quot;Tag type:&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_type</span><span class="o">.</span><span class="n">setTextFormat</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AutoText</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_type</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_box_type</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_box_type</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;combo_box_type&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_box_type</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="s2">&quot;String&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Integer&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Float&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Boolean&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Date&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Datetime&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Time&quot;</span><span class="p">,</span>
                <span class="s2">&quot;String List&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Integer List&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Float List&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Boolean List&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Date List&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Datetime List&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Time List&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="c1"># Set up layouts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_layouts</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_show_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">informative_text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Display an error message box.</span>

<span class="sd">        :param text: The main error message text</span>
<span class="sd">        :param informative_text: The additional informative text</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Critical</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setInformativeText</span><span class="p">(</span><span class="n">informative_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Close</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>

<div class="viewcode-block" id="PopUpAddTag.ok_action">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpAddTag.ok_action">[docs]</a>
    <span class="k">def</span> <span class="nf">ok_action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate inputs and add the new tag if all fields are correct.</span>

<span class="sd">        Performs validation on the tag name, type and default value to ensure</span>
<span class="sd">        they are valid before adding the tag to the project.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Import check_value_type here to prevent circular import issues</span>
        <span class="kn">from</span> <span class="nn">populse_mia.utils</span> <span class="kn">import</span> <span class="n">check_value_type</span>

        <span class="c1"># Get existing tag names</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
            <span class="n">existing_tags</span> <span class="o">=</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_field_names</span><span class="p">(</span><span class="n">COLLECTION_CURRENT</span><span class="p">)</span>

        <span class="n">tag_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_edit_tag_name</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="n">default_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_edit_default_value</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

        <span class="c1"># Validation checks</span>
        <span class="c1"># Tag name can&#39;t be empty</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">tag_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_show_error</span><span class="p">(</span>
                <span class="s2">&quot;The tag name cannot be empty&quot;</span><span class="p">,</span> <span class="s2">&quot;Please enter a tag name&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Tag name can&#39;t exist already</span>
        <span class="k">if</span> <span class="n">tag_name</span> <span class="ow">in</span> <span class="n">existing_tags</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_show_error</span><span class="p">(</span>
                <span class="s2">&quot;This tag name already exists&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Please select another tag name&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Special validation for PatientName tag</span>
        <span class="k">if</span> <span class="n">tag_name</span> <span class="o">==</span> <span class="s2">&quot;PatientName&quot;</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">FIELD_TYPE_STRING</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_show_error</span><span class="p">(</span>
                    <span class="s2">&quot;PatientName is a special tag that must be a character &quot;</span>
                    <span class="s2">&quot;string containing no spaces!&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Please select string type.&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">return</span>

            <span class="c1"># Remove spaces from PatientName default value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text_edit_default_value</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
                <span class="n">default_value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">default_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_edit_default_value</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

        <span class="c1"># Validate default value type</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">check_value_type</span><span class="p">(</span><span class="n">default_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_show_error</span><span class="p">(</span>
                <span class="s2">&quot;Invalid default value&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;The default value &#39;</span><span class="si">{</span><span class="n">default_value</span><span class="si">}</span><span class="s2">&#39; is invalid &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;with the &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2">&#39; type!&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># All validations passed, add the tag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="c1"># Store values for databrowser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_tag_name</span> <span class="o">=</span> <span class="n">tag_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_default_value</span> <span class="o">=</span> <span class="n">default_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_tag_description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_edit_description_value</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_tag_unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_box_unit</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="ow">or</span> <span class="kc">None</span>
        <span class="c1"># Add tag to project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span><span class="o">.</span><span class="n">add_tag_infos</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">new_tag_name</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">new_default_value</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">new_tag_description</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">new_tag_unit</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpAddTag.on_activated">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpAddTag.on_activated">[docs]</a>
    <span class="k">def</span> <span class="nf">on_activated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the default value when the tag type changes.</span>

<span class="sd">        :param text: The new type selected from combo box</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">type_mapping</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;String&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">FIELD_TYPE_STRING</span><span class="p">,</span> <span class="s2">&quot;Undefined&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Integer&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">FIELD_TYPE_INTEGER</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Float&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">FIELD_TYPE_FLOAT</span><span class="p">,</span> <span class="s2">&quot;0.0&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Boolean&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">FIELD_TYPE_BOOLEAN</span><span class="p">,</span> <span class="s2">&quot;True&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Date&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">FIELD_TYPE_DATE</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y&quot;</span><span class="p">)),</span>
            <span class="s2">&quot;Datetime&quot;</span><span class="p">:</span> <span class="p">(</span>
                <span class="n">FIELD_TYPE_DATETIME</span><span class="p">,</span>
                <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">/%m/%Y %H:%M:%S.</span><span class="si">%f</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="p">),</span>
            <span class="s2">&quot;Time&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">FIELD_TYPE_TIME</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S.</span><span class="si">%f</span><span class="s2">&quot;</span><span class="p">)),</span>
        <span class="p">}</span>

        <span class="c1"># Handle list types separately to avoid repetition</span>
        <span class="n">list_types</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;String List&quot;</span><span class="p">:</span> <span class="p">(</span>
                <span class="n">FIELD_TYPE_LIST_STRING</span><span class="p">,</span>
                <span class="s2">&quot;[&#39;Undefined&#39;, &#39;Undefined&#39;]&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="s2">&quot;Integer List&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">FIELD_TYPE_LIST_INTEGER</span><span class="p">,</span> <span class="s2">&quot;[0, 0]&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Float List&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">FIELD_TYPE_LIST_FLOAT</span><span class="p">,</span> <span class="s2">&quot;[0.0, 0.0]&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Boolean List&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">FIELD_TYPE_LIST_BOOLEAN</span><span class="p">,</span> <span class="s2">&quot;[True, True]&quot;</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="c1"># Handle date-based list types which need current time formatting</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">date_list_types</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Date List&quot;</span><span class="p">:</span> <span class="p">(</span>
                <span class="n">FIELD_TYPE_LIST_DATE</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;[&#39;</span><span class="si">{</span><span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;,&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; &#39;</span><span class="si">{</span><span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;]&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="s2">&quot;Datetime List&quot;</span><span class="p">:</span> <span class="p">(</span>
                <span class="n">FIELD_TYPE_LIST_DATETIME</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;[&#39;</span><span class="si">{</span><span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y %H:%M:%S.</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;,&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; &#39;</span><span class="si">{</span><span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y %H:%M:%S.</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;]&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="s2">&quot;Time List&quot;</span><span class="p">:</span> <span class="p">(</span>
                <span class="n">FIELD_TYPE_LIST_TIME</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;[&#39;</span><span class="si">{</span><span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%H:%M:%S.</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;,&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; &#39;</span><span class="si">{</span><span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%H:%M:%S.</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;]&quot;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">}</span>
        <span class="c1"># Combine all type mappings</span>
        <span class="n">all_types</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">type_mapping</span><span class="p">,</span> <span class="o">**</span><span class="n">list_types</span><span class="p">,</span> <span class="o">**</span><span class="n">date_list_types</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">all_types</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">default_value</span> <span class="o">=</span> <span class="n">all_types</span><span class="p">[</span><span class="n">text</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text_edit_default_value</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">default_value</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="PopUpCloneTag">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpCloneTag">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpCloneTag</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog for cloning an existing tag with a new name.</span>

<span class="sd">    This dialog allows users to select an existing tag from the project and</span>
<span class="sd">    clone it with a new name.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        signal_clone_tag: Signal emitted when a tag is successfully cloned</span>

<span class="sd">    Methods:</span>
<span class="sd">        - _connect_signals: Connect signals to slots</span>
<span class="sd">        - _populate_tag_list: Populate the tag list with available tags</span>
<span class="sd">        - _setup_ui: Set up the dialog UI elements</span>
<span class="sd">        - _show_error: Display an error message box</span>
<span class="sd">        - ok_action: Validates the new tag name and clones the selected tag</span>
<span class="sd">        - search_str: Filters the tag list based on a search string</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Signal emitted when tag is successfully cloned</span>
    <span class="n">signal_clone_tag</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>

<div class="viewcode-block" id="PopUpCloneTag.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpCloneTag.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">databrowser</span><span class="p">,</span> <span class="n">project</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the dialog for cloning a tag.</span>

<span class="sd">        :param databrowser: The data browser instance</span>
<span class="sd">        :param project: The current project in the software</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span> <span class="o">=</span> <span class="n">databrowser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Clone a tag&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;Clone a tag&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setModal</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_ui</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_tag_list</span><span class="p">(</span><span class="n">project</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connect_signals</span><span class="p">(</span><span class="n">project</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_connect_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Connect signals to slots.</span>

<span class="sd">        :param project: The current project</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ok_action</span><span class="p">(</span><span class="n">project</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_str</span><span class="p">,</span> <span class="n">project</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_populate_tag_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Populate the tag list with available tags from the project.</span>

<span class="sd">        :param project: The current project</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_translate</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">translate</span>

        <span class="c1"># Get all tags except system tags</span>
        <span class="k">with</span> <span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
            <span class="n">tags_list</span> <span class="o">=</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_field_names</span><span class="p">(</span><span class="n">COLLECTION_CURRENT</span><span class="p">)</span>

        <span class="n">tags_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">TAG_CHECKSUM</span><span class="p">)</span>
        <span class="n">tags_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">TAG_HISTORY</span><span class="p">)</span>

        <span class="c1"># Add tags to list widget</span>
        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags_list</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">QListWidgetItem</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Dialog&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">sortItems</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_setup_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up the dialog UI elements.&quot;&quot;&quot;</span>
        <span class="n">_translate</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">translate</span>
        <span class="c1"># New tag name components</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_new_tag_name</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Clone a tag&quot;</span><span class="p">,</span> <span class="s2">&quot;New tag name:&quot;</span><span class="p">),</span> <span class="bp">self</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_new_tag_name</span><span class="o">.</span><span class="n">setTextFormat</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AutoText</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_new_tag_name</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_new_tag_name&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_edit_new_tag_name</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_edit_new_tag_name</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;lineEdit_new_tag_name&quot;</span><span class="p">)</span>
        <span class="c1"># OK button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span>
            <span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Clone a tag&quot;</span><span class="p">,</span> <span class="s2">&quot;OK&quot;</span><span class="p">),</span> <span class="bp">self</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;push_button_ok&quot;</span><span class="p">)</span>
        <span class="c1"># Bottom row layout</span>
        <span class="n">hbox_buttons</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_new_tag_name</span><span class="p">)</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">line_edit_new_tag_name</span><span class="p">)</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="p">)</span>
        <span class="c1"># Tag list components</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_tag_list</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Clone a tag&quot;</span><span class="p">,</span> <span class="s2">&quot;Available tags:&quot;</span><span class="p">),</span> <span class="bp">self</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_tag_list</span><span class="o">.</span><span class="n">setTextFormat</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AutoText</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_tag_list</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_tag_list&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;lineEdit_search_bar&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s2">&quot;Search&quot;</span><span class="p">)</span>
        <span class="c1"># Top row layout</span>
        <span class="n">hbox_top</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">hbox_top</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_tag_list</span><span class="p">)</span>
        <span class="n">hbox_top</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">hbox_top</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span><span class="p">)</span>
        <span class="c1"># Tag list widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span> <span class="o">=</span> <span class="n">QListWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;listWidget_tags&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">setSelectionMode</span><span class="p">(</span>
            <span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">SingleSelection</span>
        <span class="p">)</span>
        <span class="c1"># Main dialog layout</span>
        <span class="n">vbox</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">hbox_top</span><span class="p">)</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="p">)</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">hbox_buttons</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">vbox</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_show_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">informative_text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Display an error message box.</span>

<span class="sd">        :param text: The main error message text</span>
<span class="sd">        :param informative_text: The additional informative text</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Critical</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setInformativeText</span><span class="p">(</span><span class="n">informative_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">buttonClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<div class="viewcode-block" id="PopUpCloneTag.ok_action">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpCloneTag.ok_action">[docs]</a>
    <span class="k">def</span> <span class="nf">ok_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate new tag name and clone the selected tag if valid.</span>

<span class="sd">        :param project: The current project</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_tag_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_edit_new_tag_name</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="n">selected_items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">selectedItems</span><span class="p">()</span>

        <span class="c1"># Check if tag name already exists</span>
        <span class="k">with</span> <span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
            <span class="n">existing_tags</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">tag</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_field_attributes</span><span class="p">(</span>
                    <span class="n">COLLECTION_CURRENT</span>
                <span class="p">)</span>
            <span class="p">]</span>

        <span class="k">if</span> <span class="n">new_tag_name</span> <span class="ow">in</span> <span class="n">existing_tags</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_show_error</span><span class="p">(</span>
                <span class="s2">&quot;This tag name already exists&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Please select another tag name&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="n">new_tag_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_show_error</span><span class="p">(</span>
                <span class="s2">&quot;The tag name can&#39;t be empty&quot;</span><span class="p">,</span> <span class="s2">&quot;Please select a tag name&quot;</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="n">selected_items</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_show_error</span><span class="p">(</span>
                <span class="s2">&quot;The tag to clone must be selected&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Please select a tag to clone&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tag_to_replace</span> <span class="o">=</span> <span class="n">selected_items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">new_tag_name</span> <span class="o">=</span> <span class="n">new_tag_name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span><span class="o">.</span><span class="n">clone_tag_infos</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tag_to_replace</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_tag_name</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpCloneTag.search_str">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpCloneTag.search_str">[docs]</a>
    <span class="k">def</span> <span class="nf">search_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">search_text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the tag list based on the search string.</span>

<span class="sd">        :param project: The current project</span>
<span class="sd">        :param search_text: The search string to filter by</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_translate</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">translate</span>

        <span class="c1"># Get all tags except system tags</span>
        <span class="k">with</span> <span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
            <span class="n">all_tags</span> <span class="o">=</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_field_names</span><span class="p">(</span><span class="n">COLLECTION_CURRENT</span><span class="p">)</span>

        <span class="n">all_tags</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">TAG_CHECKSUM</span><span class="p">)</span>
        <span class="n">all_tags</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">TAG_HISTORY</span><span class="p">)</span>

        <span class="c1"># Filter tags by search text (case-insensitive)</span>
        <span class="k">if</span> <span class="n">search_text</span><span class="p">:</span>
            <span class="n">search_text</span> <span class="o">=</span> <span class="n">search_text</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="n">filtered_tags</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">tag</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">all_tags</span> <span class="k">if</span> <span class="n">search_text</span> <span class="ow">in</span> <span class="n">tag</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">filtered_tags</span> <span class="o">=</span> <span class="n">all_tags</span>

        <span class="c1"># Update the list widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">tag_name</span> <span class="ow">in</span> <span class="n">filtered_tags</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span>
                <span class="n">QListWidgetItem</span><span class="p">(</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Dialog&quot;</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">))</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">sortItems</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PopUpClosePipeline">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpClosePipeline">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpClosePipeline</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog displayed when closing a modified pipeline editor.</span>

<span class="sd">    This dialog asks the user whether they want to save changes before</span>
<span class="sd">    closing the pipeline editor. It provides three options: save, don&#39;t</span>
<span class="sd">    save, or cancel.</span>

<span class="sd">    Signals:</span>
<span class="sd">        save_as_signal: Emitted when the user chooses to save the pipeline.</span>
<span class="sd">        do_not_save_signal: Emitted when the user chooses not to save</span>
<span class="sd">                            the pipeline.</span>
<span class="sd">        cancel_signal: Emitted when the user cancels the closing action.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        bool_save_as (bool): Indicates if the pipeline should be saved</span>
<span class="sd">                             under a new name.</span>
<span class="sd">        bool_exit (bool): Indicates if the editor can be closed.</span>
<span class="sd">        pipeline_name (str): Name of the pipeline being edited.</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - _connect_signals: Connect button signals to their respective slots</span>
<span class="sd">        - _setup_ui: Set up the dialog&#39;s user interface</span>
<span class="sd">        - can_exit: returns the value of bool_exit</span>
<span class="sd">        - cancel_clicked: makes the actions to cancel the action</span>
<span class="sd">        - do_not_save_clicked: makes the actions not to save the pipeline</span>
<span class="sd">        - save_as_clicked: makes the actions to save the pipeline</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">save_as_signal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>
    <span class="n">do_not_save_signal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>
    <span class="n">cancel_signal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>

<div class="viewcode-block" id="PopUpClosePipeline.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpClosePipeline.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pipeline_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the dialog with the pipeline name.</span>

<span class="sd">        :param pipeline_name (str):  Name of the pipeline (basename).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pipeline_name</span> <span class="o">=</span> <span class="n">pipeline_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bool_exit</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bool_save_as</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_ui</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connect_signals</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">_connect_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Connect button signals to their respective slots.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_save_as</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_as_clicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_do_not_save</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">do_not_save_clicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cancel_clicked</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setup_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set up the dialog&#39;s user interface.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Confirm pipeline closing&quot;</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Do you want to close the pipeline without &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;saving </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pipeline_name</span><span class="si">}</span><span class="s2">?&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_save_as</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Save&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_do_not_save</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Do not save&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Cancel&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="c1"># Create button layout</span>
        <span class="n">button_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_save_as</span><span class="p">)</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_do_not_save</span><span class="p">)</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="p">)</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># Create main layout</span>
        <span class="n">main_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">main_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="n">main_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">button_layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">main_layout</span><span class="p">)</span>

<div class="viewcode-block" id="PopUpClosePipeline.can_exit">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpClosePipeline.can_exit">[docs]</a>
    <span class="k">def</span> <span class="nf">can_exit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the editor can be closed.</span>

<span class="sd">        Return (bool): True if the editor can be closed, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bool_exit</span></div>


<div class="viewcode-block" id="PopUpClosePipeline.cancel_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpClosePipeline.cancel_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">cancel_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the cancel button click.</span>

<span class="sd">        Sets bool_exit to False, emits cancel_signal, and closes the dialog.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bool_exit</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancel_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpClosePipeline.do_not_save_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpClosePipeline.do_not_save_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">do_not_save_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the &#39;Do not save&#39; button click.</span>

<span class="sd">        Sets bool_exit to True, emits do_not_save_signal,</span>
<span class="sd">        and closes the dialog.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bool_exit</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">do_not_save_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpClosePipeline.save_as_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpClosePipeline.save_as_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">save_as_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the &#39;Save&#39; button click.</span>

<span class="sd">        Sets bool_save_as and bool_exit to True, emits save_as_signal,</span>
<span class="sd">        and closes the dialog.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bool_save_as</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bool_exit</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_as_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PopUpDataBrowserCurrentSelection">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpDataBrowserCurrentSelection">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpDataBrowserCurrentSelection</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog to display and confirm the current data browser selection.</span>

<span class="sd">    This dialog shows a table of the currently selected document</span>
<span class="sd">    from the data browser and allows the user to confirm or cancel the</span>
<span class="sd">    selection. When confirmed, it updates the scan_list attribute of</span>
<span class="sd">    relevant components in the main window.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        project: Current project in the software.</span>
<span class="sd">        databrowser: Data browser instance of the software.</span>
<span class="sd">        filter: List of the current documents in the data browser.</span>
<span class="sd">        main_window: Main window of the software.</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - _set_dialog_size: Set the dialog size based on screen resolution</span>
<span class="sd">        - _setup_ui: Set up the dialog&#39;s user interface</span>
<span class="sd">        - ok_clicked: updates the &quot;scan_list&quot; attribute of several widgets</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PopUpDataBrowserCurrentSelection.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpDataBrowserCurrentSelection.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">databrowser</span><span class="p">,</span> <span class="nb">filter</span><span class="p">,</span> <span class="n">main_window</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the dialog with the current project and selection data.</span>

<span class="sd">        :param project: Current project in the software</span>
<span class="sd">        :param databrowser: Data browser instance of the software</span>
<span class="sd">        :param filter (list): List of the current documents in the data</span>
<span class="sd">                              browser</span>
<span class="sd">        :param main_window: Main window of the software</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span> <span class="o">=</span> <span class="n">databrowser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter</span> <span class="o">=</span> <span class="nb">filter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span> <span class="o">=</span> <span class="n">main_window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_ui</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">_set_dialog_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the dialog size based on screen resolution.&quot;&quot;&quot;</span>
        <span class="n">screen_resolution</span> <span class="o">=</span> <span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">desktop</span><span class="p">()</span><span class="o">.</span><span class="n">screenGeometry</span><span class="p">()</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">screen_resolution</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="n">screen_resolution</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">width</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="mf">0.8</span> <span class="o">*</span> <span class="n">height</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_setup_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up the dialog&#39;s user interface.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Confirm the selection&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setModal</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Create layout</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="c1"># Create and configure data browser table</span>
        <span class="n">databrowser_table</span> <span class="o">=</span> <span class="n">data_browser</span><span class="o">.</span><span class="n">TableDataBrowser</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span><span class="p">,</span> <span class="p">[</span><span class="n">TAG_FILENAME</span><span class="p">],</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span>
        <span class="p">)</span>
        <span class="n">old_scan_list</span> <span class="o">=</span> <span class="n">databrowser_table</span><span class="o">.</span><span class="n">scans_to_visualize</span>
        <span class="n">databrowser_table</span><span class="o">.</span><span class="n">scans_to_visualize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter</span>
        <span class="n">databrowser_table</span><span class="o">.</span><span class="n">update_visualized_rows</span><span class="p">(</span><span class="n">old_scan_list</span><span class="p">)</span>
        <span class="c1"># Create buttons</span>
        <span class="n">buttons</span> <span class="o">=</span> <span class="n">QDialogButtonBox</span><span class="p">(</span>
            <span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Cancel</span>
        <span class="p">)</span>
        <span class="n">buttons</span><span class="o">.</span><span class="n">accepted</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ok_clicked</span><span class="p">)</span>
        <span class="n">buttons</span><span class="o">.</span><span class="n">rejected</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="c1"># Add widgets to layout</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">databrowser_table</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">buttons</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
        <span class="c1"># Set dialog size based on screen resolution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_dialog_size</span><span class="p">()</span>

<div class="viewcode-block" id="PopUpDataBrowserCurrentSelection.ok_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpDataBrowserCurrentSelection.ok_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">ok_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the scan_list attribute of components when OK is clicked.</span>

<span class="sd">        This method propagates the current filter (selected documents)</span>
<span class="sd">        to various components in the main window&#39;s pipeline manager, and</span>
<span class="sd">        marks the data as sent in the data browser before closing the dialog.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Update scan_list in all required components</span>
        <span class="n">pipeline_manager</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">pipeline_manager</span>
        <span class="n">components</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">pipeline_manager</span><span class="p">,</span>
            <span class="n">pipeline_manager</span><span class="o">.</span><span class="n">nodeController</span><span class="p">,</span>
            <span class="n">pipeline_manager</span><span class="o">.</span><span class="n">pipelineEditorTabs</span><span class="p">,</span>
            <span class="n">pipeline_manager</span><span class="o">.</span><span class="n">iterationTable</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
            <span class="n">component</span><span class="o">.</span><span class="n">scan_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span><span class="o">.</span><span class="n">data_sent</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PopUpDeletedProject">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpDeletedProject">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpDeletedProject</span><span class="p">(</span><span class="n">QMessageBox</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Message box that displays a list of deleted, renamed, or moved projects.</span>

<span class="sd">    This dialog appears when the software starts and detects that previously</span>
<span class="sd">    available projects are no longer accessible at their expected locations.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        deleted_projects (list): List of project names that are no longer</span>
<span class="sd">                                 accessible.</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - _connect_signals: Connect button signals to their respective slots</span>
<span class="sd">        - _setup_message_box: Configure the message box appearance and</span>
<span class="sd">                              content</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PopUpDeletedProject.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpDeletedProject.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deleted_projects</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the message box with a list of inaccessible projects.</span>

<span class="sd">        :param deleted_projects (list): List of project names that are no</span>
<span class="sd">                                        longer accessible (deleted, renamed,</span>
<span class="sd">                                        or moved).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deleted_projects</span> <span class="o">=</span> <span class="n">deleted_projects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_message_box</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connect_signals</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">_connect_signals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Connect button signals to their respective slots.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttonClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setup_message_box</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Configure the message box appearance and content.&quot;&quot;&quot;</span>
        <span class="c1"># Create the message with the list of deleted projects</span>
        <span class="n">project_list</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">project</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">project</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">deleted_projects</span>
        <span class="p">)</span>
        <span class="n">message</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;These projects have been renamed, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;moved or deleted:</span><span class="se">\n</span><span class="si">{</span><span class="n">project_list</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="c1"># Set message box properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Deleted projects&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setInformativeText</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span></div>



<div class="viewcode-block" id="PopUpDeleteProject">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpDeleteProject">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpDeleteProject</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog for deleting selected projects.</span>

<span class="sd">    Allows the user to select and delete one or more projects</span>
<span class="sd">    from the projects directory after confirmation.</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - _delete_project: Handles project deletion</span>
<span class="sd">        - _setup_buttons: Creates and configures the dialog buttons</span>
<span class="sd">        - _setup_layout: Configures the main layout of the dialog</span>
<span class="sd">        - _setup_ui: Sets up the user interface components</span>
<span class="sd">        - ok_clicked: delete the selected projects after confirmation</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PopUpDeleteProject.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpDeleteProject.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_window</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the delete project dialog.</span>

<span class="sd">        :param main_window (QMainWindow): The main application window</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Delete project&quot;</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project_path</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_projects_save_path</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span> <span class="o">=</span> <span class="n">main_window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_ui</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">_delete_project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_path</span><span class="p">,</span> <span class="n">opened_projects</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles project deletion, updating application state accordingly.</span>

<span class="sd">        :param project_path (str): The path of the project to delete</span>
<span class="sd">        :param opened_projects (list): The list of currently opened projects</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">folder</span><span class="p">)</span> <span class="o">==</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span>
            <span class="n">project_path</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">Project</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">update_project</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">project_rel_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">project_path</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">project_rel_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">saved_projects</span><span class="o">.</span><span class="n">pathsList</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">saved_projects</span><span class="o">.</span><span class="n">removeSavedProject</span><span class="p">(</span>
                <span class="n">project_rel_path</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">update_recent_projects_actions</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">project_rel_path</span> <span class="ow">in</span> <span class="n">opened_projects</span><span class="p">:</span>
            <span class="n">opened_projects</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">project_rel_path</span><span class="p">)</span>

        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">project_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setup_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates and configures the dialog buttons.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_bottom</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_bottom</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_ok&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ok_clicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_bottom</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Cancel&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_cancel&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_bottom</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setup_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Configures the main layout of the dialog.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span> <span class="o">=</span> <span class="n">QScrollArea</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_box_bottom</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_layout</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setup_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets up the user interface components.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_box</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Select projects to delete:&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_boxes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">QCheckBox</span><span class="p">(</span><span class="n">project</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">project</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_path</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_path</span><span class="p">,</span> <span class="n">project</span><span class="p">))</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">check_box</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_boxes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">check_box</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_buttons</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_layout</span><span class="p">()</span>

<div class="viewcode-block" id="PopUpDeleteProject.ok_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpDeleteProject.ok_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">ok_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes the selected projects after user confirmation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selected_projects</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_boxes</span> <span class="k">if</span> <span class="n">cb</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">selected_projects</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
        <span class="n">opened_projects</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_opened_projects</span><span class="p">()</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">selected_projects</span><span class="p">:</span>
            <span class="n">project_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_path</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">reply</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">YesToAll</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">NoToAll</span><span class="p">):</span>
                <span class="n">reply</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="bp">self</span><span class="p">,</span>
                    <span class="s2">&quot;populse_mia - Warning: Delete project&quot;</span><span class="p">,</span>
                    <span class="sa">f</span><span class="s2">&quot;Do you really want to delete the </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> project?&quot;</span><span class="p">,</span>
                    <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span>
                    <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span>
                    <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">YesToAll</span>
                    <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">NoToAll</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">reply</span> <span class="ow">in</span> <span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">YesToAll</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_delete_project</span><span class="p">(</span><span class="n">project_path</span><span class="p">,</span> <span class="n">opened_projects</span><span class="p">)</span>

        <span class="n">config</span><span class="o">.</span><span class="n">set_opened_projects</span><span class="p">(</span><span class="n">opened_projects</span><span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PopUpFilterSelection">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpFilterSelection">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpFilterSelection</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog for selecting a previously saved filter.</span>

<span class="sd">    :Methods:</span>
<span class="sd">        - cancel_clicked: Closes the pop-up.</span>
<span class="sd">        - ok_clicked: Handles actions when the &quot;OK&quot; button is clicked.</span>
<span class="sd">        - search_str: Filters the list based on the search input.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PopUpFilterSelection.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpFilterSelection.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the pop-up dialog.</span>

<span class="sd">        :param project (object): The current project containing saved filters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setModal</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">_translate</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">translate</span>
        <span class="c1"># Label for the filter list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_filter_list</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;main_window&quot;</span><span class="p">,</span> <span class="s2">&quot;Available filters:&quot;</span><span class="p">),</span> <span class="bp">self</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_filter_list</span><span class="o">.</span><span class="n">setTextFormat</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AutoText</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_filter_list</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_filter_list&quot;</span><span class="p">)</span>
        <span class="c1"># Search bar for filtering the list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;lineEdit_search_bar&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s2">&quot;Search&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_str</span><span class="p">)</span>
        <span class="c1"># List widget for displaying filters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_filters</span> <span class="o">=</span> <span class="n">QListWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_filters</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;listWidget_tags&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_filters</span><span class="o">.</span><span class="n">setSelectionMode</span><span class="p">(</span>
            <span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">SingleSelection</span>
        <span class="p">)</span>
        <span class="c1"># OK and Cancel buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_ok&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ok_clicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Cancel&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_cancel&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cancel_clicked</span><span class="p">)</span>
        <span class="c1"># Layout setup</span>
        <span class="n">hbox_top_left</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">hbox_top_left</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_filter_list</span><span class="p">)</span>
        <span class="n">hbox_top_left</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span><span class="p">)</span>
        <span class="n">vbox_top_left</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">vbox_top_left</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">hbox_top_left</span><span class="p">)</span>
        <span class="n">vbox_top_left</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_widget_filters</span><span class="p">)</span>
        <span class="n">hbox_buttons</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="p">)</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="p">)</span>
        <span class="n">vbox_final</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">vbox_final</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">vbox_top_left</span><span class="p">)</span>
        <span class="n">vbox_final</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">hbox_buttons</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">vbox_final</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpFilterSelection.cancel_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpFilterSelection.cancel_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">cancel_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Closes the pop-up dialog.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpFilterSelection.ok_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpFilterSelection.ok_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">ok_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles actions when the &quot;OK&quot; button is clicked.</span>

<span class="sd">        This method should be overridden in subclasses to implement</span>
<span class="sd">        specific behavior.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="PopUpFilterSelection.search_str">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpFilterSelection.search_str">[docs]</a>
    <span class="k">def</span> <span class="nf">search_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search_text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filters the list of saved filters based on the search input.</span>

<span class="sd">        :param search_text (str): The text pattern to search for</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">search_text</span> <span class="o">=</span> <span class="n">search_text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">search_text</span><span class="p">:</span>
            <span class="n">matching_filters</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">f</span><span class="o">.</span><span class="n">name</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">filters</span>
                <span class="k">if</span> <span class="n">search_text</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">matching_filters</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">filters</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_widget_filters</span><span class="o">.</span><span class="n">count</span><span class="p">()):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_filters</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">matching_filters</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="PopUpInformation">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpInformation">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpInformation</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Popup window displaying the current project&#39;s information.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Signal emitted when project preferences change</span>
    <span class="n">signal_preferences_change</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>

<div class="viewcode-block" id="PopUpInformation.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpInformation.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the popup window with project details.</span>

<span class="sd">        :param project (Project): The current project instance</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># UI Elements</span>
        <span class="n">name_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Name: &quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name_value</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="n">project</span><span class="o">.</span><span class="n">getName</span><span class="p">())</span>
        <span class="n">folder_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Root folder: </span><span class="si">{</span><span class="n">project</span><span class="o">.</span><span class="n">folder</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">date_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Date of creation: </span><span class="si">{</span><span class="n">project</span><span class="o">.</span><span class="n">getDate</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Layout Setup</span>
        <span class="n">box</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">row</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">name_label</span><span class="p">)</span>
        <span class="n">row</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name_value</span><span class="p">)</span>
        <span class="n">box</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="n">box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">folder_label</span><span class="p">)</span>
        <span class="n">box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">date_label</span><span class="p">)</span>
        <span class="n">box</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">box</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="PopUpInheritanceDict">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpInheritanceDict">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpInheritanceDict</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog for selecting tag inheritance between input and output plugs.</span>

<span class="sd">    This dialog allows users to select which input plug should pass its tags</span>
<span class="sd">    to a specific output plug, or to choose to ignore tag inheritance</span>
<span class="sd">    altogether.</span>

<span class="sd">    :Methods:</span>
<span class="sd">        - _setup_buttons: Set up action buttons for the dialog</span>
<span class="sd">        - _setup_radio_buttons: Set up radio buttons for each input option</span>
<span class="sd">        - ok_clicked: Event when ok button is clicked</span>
<span class="sd">        - okall_clicked: Event when Ok all button is clicked</span>
<span class="sd">        - on_clicked: Event when radiobutton is clicked</span>
<span class="sd">        - ignoreall_clicked: Event when ignore all plugs button is clicked</span>
<span class="sd">        - ignore_clicked: Event when ignore button is clicked</span>
<span class="sd">        - ignore_node_clicked: Event when ignore all nodes button is clicked</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PopUpInheritanceDict.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpInheritanceDict.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">plug_name</span><span class="p">,</span> <span class="n">iterate</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the inheritance selection dialog.</span>

<span class="sd">        :param values (dict): Dict mapping input names (keys) to their</span>
<span class="sd">                              paths (values)</span>
<span class="sd">        :param node_name (str): Name of the current node</span>
<span class="sd">        :param plug_name (str): Name of the current output plug</span>
<span class="sd">        :param iterate (bool): Boolean indicating if the choice applies</span>
<span class="sd">                               to iterations</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setModal</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;Dialog&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plug inherited in </span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Initialize state flags</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignore</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">everything</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Create the main layout</span>
        <span class="n">v_box_values</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">label</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;In the node &lt;b&gt;&lt;i&gt;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&lt;/i&gt;&lt;/b&gt;, from which input plug, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;the output plug &lt;b&gt;&lt;i&gt;</span><span class="si">{</span><span class="n">plug_name</span><span class="si">}</span><span class="s2">&lt;/i&gt;&lt;/b&gt; should inherit &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;the tags?:&quot;</span>
        <span class="p">)</span>
        <span class="n">v_box_values</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>
        <span class="c1"># Add radio buttons for each input option</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_radio_buttons</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">v_box_values</span><span class="p">)</span>
        <span class="c1"># Add button row</span>
        <span class="n">h_box_buttons</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_buttons</span><span class="p">(</span><span class="n">node_name</span><span class="p">,</span> <span class="n">plug_name</span><span class="p">,</span> <span class="n">h_box_buttons</span><span class="p">)</span>
        <span class="n">v_box_values</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">h_box_buttons</span><span class="p">)</span>
        <span class="c1"># Add ignore node button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ignore_node</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span>
            <span class="s2">&quot;Ignore for all nodes in the pipeline&quot;</span><span class="p">,</span> <span class="bp">self</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ignore_node</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ignore_node_clicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ignore_node</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
            <span class="s2">&quot;No tags will be inherited for the whole pipeline.&quot;</span>
        <span class="p">)</span>
        <span class="n">v_box_values</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_ignore_node</span><span class="p">)</span>

        <span class="c1"># Add iteration notice if needed</span>
        <span class="k">if</span> <span class="n">iterate</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;&lt;i&gt;These choices will be valid for each iteration.&lt;/i&gt;&quot;</span>
            <span class="n">v_box_values</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="n">label</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">v_box_values</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_setup_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">plug_name</span><span class="p">,</span> <span class="n">layout</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up action buttons for the dialog.</span>

<span class="sd">        :param  node_name: Name of the current node</span>
<span class="sd">        :param  plug_name: Name of the current output plug</span>
<span class="sd">        :param  layout: Layout to add the buttons to</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># OK button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ok_clicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&lt;i&gt;</span><span class="si">{</span><span class="n">plug_name</span><span class="si">}</span><span class="s2">&lt;/i&gt; will inherit tags from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="p">)</span>
        <span class="c1"># Ignore button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ignore</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Ignore&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ignore</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ignore_clicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ignore</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&lt;i&gt;</span><span class="si">{</span><span class="n">plug_name</span><span class="si">}</span><span class="s2">&lt;/i&gt; will not inherit any tags.&quot;</span>
        <span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_ignore</span><span class="p">)</span>
        <span class="c1"># OK all button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_okall</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;OK for all output plugs&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_okall</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">okall_clicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_okall</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;All the output plugs from &lt;i&gt;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&lt;/i&gt; &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;will inherit tags from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_okall</span><span class="p">)</span>
        <span class="c1"># Ignore all button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ignoreall</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span>
            <span class="s2">&quot;Ignore for all output plugs&quot;</span><span class="p">,</span> <span class="bp">self</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ignoreall</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ignoreall_clicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ignoreall</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;All the output plugs from &lt;i&gt;</span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">&lt;/i&gt; will not &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;inherit any tags.&quot;</span>
        <span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_ignoreall</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setup_radio_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">layout</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up radio buttons for each input option.</span>

<span class="sd">        :param values: Dict mapping input names to their paths</span>
<span class="sd">        :param layout: Layout to add the radio buttons to</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">first_button</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">radiobutton</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="n">radiobutton</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
            <span class="n">radiobutton</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
            <span class="n">radiobutton</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">first_button</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">first_button</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
                <span class="n">first_button</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="n">radiobutton</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_clicked</span><span class="p">)</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">radiobutton</span><span class="p">)</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<div class="viewcode-block" id="PopUpInheritanceDict.ok_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpInheritanceDict.ok_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">ok_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle OK button click.</span>

<span class="sd">        Accepts the dialog with current selection applied to current plug.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpInheritanceDict.okall_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpInheritanceDict.okall_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">okall_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle &#39;OK for all output plugs&#39; button click.</span>

<span class="sd">        Accepts the dialog with current selection applied to all output</span>
<span class="sd">        plugs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpInheritanceDict.on_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpInheritanceDict.on_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">on_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle radio button selection event.</span>

<span class="sd">        Updates the currently selected input value and key.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">radiobutton</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">radiobutton</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">radiobutton</span><span class="o">.</span><span class="n">key</span>

        <span class="c1"># Update OK button tooltips with new selection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Output plug will inherit tags from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_okall</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;All output plugs will inherit tags from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PopUpInheritanceDict.ignoreall_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpInheritanceDict.ignoreall_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">ignoreall_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle &#39;Ignore for all output plugs&#39; button click.</span>

<span class="sd">        Accepts the dialog with tag inheritance ignored for all output plugs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignore</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpInheritanceDict.ignore_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpInheritanceDict.ignore_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">ignore_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle Ignore button click.</span>

<span class="sd">        Accepts the dialog with tag inheritance ignored for current plug.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignore</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpInheritanceDict.ignore_node_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpInheritanceDict.ignore_node_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">ignore_node_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle &#39;Ignore for all nodes in the pipeline&#39; button click.</span>

<span class="sd">        Accepts the dialog with tag inheritance ignored for the entire</span>
<span class="sd">        pipeline.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignore</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">all</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">everything</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PopUpMultipleSort">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpMultipleSort">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpMultipleSort</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog for sorting the data browser&#39;s table based on multiple tags.</span>

<span class="sd">    This dialog allows users to select multiple tags (columns) for sorting</span>
<span class="sd">    table data in either ascending or descending order. Users can dynamically</span>
<span class="sd">    add or remove sort criteria.</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - _setup_ui_elements: Create and configure all UI elements</span>
<span class="sd">        - add_tag: Adds a push button</span>
<span class="sd">        - fill_values: Fills the values list when a tag is added or removed</span>
<span class="sd">        - refresh_layout: Updates the layouts (especially when a tag push</span>
<span class="sd">                          button is added or removed)</span>
<span class="sd">        - remove_tag: Removes a push buttons and makes the changes in the</span>
<span class="sd">                      list of values</span>
<span class="sd">        - select_tag: Calls a pop-up to choose a tag</span>
<span class="sd">        - sort_scans: Collects the information and send them to the data</span>
<span class="sd">                      browser</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PopUpMultipleSort.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpMultipleSort.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">table_data_browser</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the multiple sort dialog.</span>

<span class="sd">        :param project: Current project in the software</span>
<span class="sd">        :param table_data_browser: Data browser&#39;s table to be sorted</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_data_browser</span> <span class="o">=</span> <span class="n">table_data_browser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setModal</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Multiple Sort&quot;</span><span class="p">)</span>
        <span class="c1"># Initialize data structures</span>
        <span class="c1"># Contains unique values for each selected tag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values_list</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[]]</span>
        <span class="c1"># Will hold the final list of tags for sorting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_tags</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Buttons for tag selection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_buttons</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Create UI elements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_ui_elements</span><span class="p">()</span>
        <span class="c1"># Create and set layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_box_final</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_box_final</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_layout</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">_setup_ui_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create and configure all UI elements.&quot;&quot;&quot;</span>
        <span class="c1"># Tag selection section</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_tags</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Tags: &quot;</span><span class="p">)</span>
        <span class="c1"># Create initial tag buttons</span>
        <span class="n">push_button_tag_1</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Tag n°1&quot;</span><span class="p">)</span>
        <span class="n">push_button_tag_1</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_tag</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">push_button_tag_2</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Tag n°2&quot;</span><span class="p">)</span>
        <span class="n">push_button_tag_2</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_tag</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_buttons</span> <span class="o">=</span> <span class="p">[</span><span class="n">push_button_tag_1</span><span class="p">,</span> <span class="n">push_button_tag_2</span><span class="p">]</span>
        <span class="c1"># Add/remove tag controls</span>
        <span class="n">sources_images_dir</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span><span class="o">.</span><span class="n">getSourceImageDir</span><span class="p">()</span>
        <span class="c1"># Remove tag button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_tag_label</span> <span class="o">=</span> <span class="n">ClickableLabel</span><span class="p">()</span>
        <span class="n">remove_tag_picture</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sources_images_dir</span><span class="p">,</span> <span class="s2">&quot;red_minus.png&quot;</span><span class="p">))</span>
        <span class="p">)</span><span class="o">.</span><span class="n">scaledToHeight</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_tag_label</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">remove_tag_picture</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_tag_label</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_tag</span><span class="p">)</span>
        <span class="c1"># Add tag button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_tag_label</span> <span class="o">=</span> <span class="n">ClickableLabel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_tag_label</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;plus&quot;</span><span class="p">)</span>
        <span class="n">add_tag_picture</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sources_images_dir</span><span class="p">,</span> <span class="s2">&quot;green_plus.png&quot;</span><span class="p">))</span>
        <span class="p">)</span><span class="o">.</span><span class="n">scaledToHeight</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_tag_label</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">add_tag_picture</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_tag_label</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_tag</span><span class="p">)</span>
        <span class="c1"># Sort order selection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="s2">&quot;Ascending&quot;</span><span class="p">,</span> <span class="s2">&quot;Descending&quot;</span><span class="p">])</span>
        <span class="c1"># Sort button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_sort</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Sort Scans&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_sort</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sort_scans</span><span class="p">)</span>

<div class="viewcode-block" id="PopUpMultipleSort.add_tag">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpMultipleSort.add_tag">[docs]</a>
    <span class="k">def</span> <span class="nf">add_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a new tag button to the sort criteria.&quot;&quot;&quot;</span>
        <span class="n">button_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_buttons</span><span class="p">)</span>
        <span class="n">push_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tag n°</span><span class="si">{</span><span class="n">button_index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">push_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">select_tag</span><span class="p">(</span><span class="n">button_index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_buttons</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">button_index</span><span class="p">,</span> <span class="n">push_button</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_layout</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpMultipleSort.fill_values">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpMultipleSort.fill_values">[docs]</a>
    <span class="k">def</span> <span class="nf">fill_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Collect unique values for the selected tag.</span>

<span class="sd">        :param idx: Index of the tag button in the push_buttons list</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tag_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">push_buttons</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

        <span class="c1"># Ensure values_list has enough slots</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values_list</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">idx</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">values_list</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>

        <span class="c1"># Clear existing values for this tag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values_list</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">scan</span> <span class="ow">in</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_document_names</span><span class="p">(</span><span class="n">COLLECTION_CURRENT</span><span class="p">):</span>
                <span class="n">current_value</span> <span class="o">=</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span>
                    <span class="n">collection_name</span><span class="o">=</span><span class="n">COLLECTION_CURRENT</span><span class="p">,</span>
                    <span class="n">primary_key</span><span class="o">=</span><span class="n">scan</span><span class="p">,</span>
                    <span class="n">field</span><span class="o">=</span><span class="n">tag_name</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">current_value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values_list</span><span class="p">[</span><span class="n">idx</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">values_list</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_value</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpMultipleSort.refresh_layout">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpMultipleSort.refresh_layout">[docs]</a>
    <span class="k">def</span> <span class="nf">refresh_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the dialog layout to reflect current tag buttons.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_top</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_top</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_top</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_tags</span><span class="p">)</span>

        <span class="c1"># Add all tag buttons</span>
        <span class="k">for</span> <span class="n">tag_button</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">push_buttons</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">h_box_top</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">tag_button</span><span class="p">)</span>

        <span class="c1"># Add control buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_top</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_tag_label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_top</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_tag_label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_top</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_top</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_sort</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_top</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Clear the previous layout if it exists</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_box_final</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Remove the previous h_box_top</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_box_final</span><span class="o">.</span><span class="n">takeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">layout</span><span class="p">():</span>

                <span class="k">while</span> <span class="n">item</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">():</span>
                    <span class="n">item</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">takeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">v_box_final</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_box_top</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpMultipleSort.remove_tag">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpMultipleSort.remove_tag">[docs]</a>
    <span class="k">def</span> <span class="nf">remove_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove the last tag button from the sort criteria.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">push_buttons</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Remove the last button</span>
        <span class="n">push_button</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">push_buttons</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="n">push_button</span><span class="o">.</span><span class="n">deleteLater</span><span class="p">()</span>
        <span class="n">push_button</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Remove corresponding values</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">values_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">values_list</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_layout</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpMultipleSort.select_tag">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpMultipleSort.select_tag">[docs]</a>
    <span class="k">def</span> <span class="nf">select_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open a pop-up dialog to choose a tag for the specified button.</span>

<span class="sd">        :param idx: Index of the button in the push_buttons list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
            <span class="n">pop_up</span> <span class="o">=</span> <span class="n">PopUpSelectTagCountTable</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span>
                <span class="n">database_data</span><span class="o">.</span><span class="n">get_shown_tags</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">push_buttons</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">pop_up</span><span class="o">.</span><span class="n">exec_</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">push_buttons</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">pop_up</span><span class="o">.</span><span class="n">selected_tag</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fill_values</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpMultipleSort.sort_scans">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpMultipleSort.sort_scans">[docs]</a>
    <span class="k">def</span> <span class="nf">sort_scans</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Collect sorting parameters and send them to the data browser.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="o">.</span><span class="n">itemText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">())</span>
        <span class="c1"># Clear previous tag list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_tags</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Collect valid tag names</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
            <span class="n">field_names</span> <span class="o">=</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_field_names</span><span class="p">(</span><span class="n">COLLECTION_CURRENT</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">push_button</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">push_buttons</span><span class="p">:</span>
            <span class="n">tag_name</span> <span class="o">=</span> <span class="n">push_button</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">tag_name</span> <span class="ow">in</span> <span class="n">field_names</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">list_tags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tag_name</span><span class="p">)</span>

        <span class="c1"># Close dialog and trigger sorting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_data_browser</span><span class="o">.</span><span class="n">multiple_sort_infos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_tags</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="PopUpNewProject">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpNewProject">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpNewProject</span><span class="p">(</span><span class="n">QFileDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog for creating a new project.</span>

<span class="sd">    This dialog is displayed when the user wants to create a new project.</span>
<span class="sd">    It manages file selection and handles the creation process.</span>

<span class="sd">    .. Method:</span>
<span class="sd">        - get_filename: Sets the widget&#39;s attributes depending on the</span>
<span class="sd">          selected file name</span>

<span class="sd">    .. Signals:</span>
<span class="sd">        - signal_create_project: Emitted when a project has been</span>
<span class="sd">                                 successfully created</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Signal emitted when project creation is successful</span>
    <span class="n">signal_create_project</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>

<div class="viewcode-block" id="PopUpNewProject.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpNewProject.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the new project dialog with appropriate settings.&quot;&quot;&quot;</span>

        <span class="c1"># Import here to prevent circular import issues</span>
        <span class="kn">from</span> <span class="nn">populse_mia.utils</span> <span class="kn">import</span> <span class="n">set_projects_directory_as_default</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLabelText</span><span class="p">(</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">Accept</span><span class="p">,</span> <span class="s2">&quot;Create&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAcceptMode</span><span class="p">(</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">AcceptSave</span><span class="p">)</span>
        <span class="c1"># Set the projects directory as default</span>
        <span class="n">set_projects_directory_as_default</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpNewProject.get_filename">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpNewProject.get_filename">[docs]</a>
    <span class="k">def</span> <span class="nf">get_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name_tuple</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Process the selected filename and set up project attributes.</span>

<span class="sd">        :param file_name_tuple (tuple): Tuple containing the selected</span>
<span class="sd">                                        filename(s), obtained from the</span>
<span class="sd">                                        selectedFiles method</span>

<span class="sd">        Note:</span>
<span class="sd">            If the file already exists, displays an error message.</span>
<span class="sd">            Otherwise, closes the dialog and emits signal_create_project.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Import here to prevent circular import issues</span>
        <span class="kn">from</span> <span class="nn">populse_mia.utils</span> <span class="kn">import</span> <span class="n">message_already_exists</span>

        <span class="c1"># Handle the case where file_name_tuple might be empty</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_name_tuple</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>

        <span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_name</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>

        <span class="n">entire_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">entire_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relative_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relative_subpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># Check if project already exists</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relative_path</span><span class="p">):</span>
            <span class="n">message_already_exists</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="c1"># Emit signal to notify that project has been created</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signal_create_project</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">file_name</span></div>
</div>



<div class="viewcode-block" id="PopUpOpenProject">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpOpenProject">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpOpenProject</span><span class="p">(</span><span class="n">QFileDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog for opening an existing MIA project.</span>

<span class="sd">    This dialog allows users to select an existing project directory from</span>
<span class="sd">    the filesystem. It uses the default projects directory as the starting</span>
<span class="sd">    location and emits a signal when a valid project is selected.</span>

<span class="sd">    .. Method:</span>
<span class="sd">        - get_filename: Sets the widget&#39;s attributes depending on the</span>
<span class="sd">                        selected file name</span>

<span class="sd">    .. Signals:</span>
<span class="sd">        - signal_create_project: Signal emitted when a valid project is</span>
<span class="sd">                                 selected</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Signal emitted when a valid project is selected</span>
    <span class="n">signal_create_project</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>

<div class="viewcode-block" id="PopUpOpenProject.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpOpenProject.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Import here to prevent circular imports</span>
        <span class="kn">from</span> <span class="nn">populse_mia.utils</span> <span class="kn">import</span> <span class="n">set_projects_directory_as_default</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setOption</span><span class="p">(</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">DontUseNativeDialog</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFileMode</span><span class="p">(</span><span class="n">QFileDialog</span><span class="o">.</span><span class="n">Directory</span><span class="p">)</span>
        <span class="c1"># Set the projects directory as default location</span>
        <span class="n">set_projects_directory_as_default</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpOpenProject.get_filename">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpOpenProject.get_filename">[docs]</a>
    <span class="k">def</span> <span class="nf">get_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name_tuple</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Process the selected directory and emit signal if valid.</span>

<span class="sd">        Sets the path, name, and relative_path attributes based on the</span>
<span class="sd">        selected directory. If the directory exists, emits</span>
<span class="sd">        signal_create_project.</span>

<span class="sd">        :param file_name_tuple (tuple): Tuple containing selected directory</span>
<span class="sd">                                        path(s). Typically obtained from</span>
<span class="sd">                                        selectedFiles() method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Import here to prevent circular imports</span>
        <span class="kn">from</span> <span class="nn">populse_mia.utils</span> <span class="kn">import</span> <span class="n">message_already_exists</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_name_tuple</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_name</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">entire_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">entire_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relative_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>

        <span class="c1"># Check if directory exists and emit signal</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">entire_path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signal_create_project</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">message_already_exists</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PopUpPreferences">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpPreferences</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog for changing software preferences.</span>

<span class="sd">    This class manages the preferences dialog for the software, allowing users</span>
<span class="sd">    to configure various settings related to tools, projects, and appearance.</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - admin_mode_switch: Called when the admin mode checkbox</span>
<span class="sd">                             is clicked</span>
<span class="sd">        - browse_afni: Called when afni browse button is clicked</span>
<span class="sd">        - browse_ants: Called when ants browse button is clicked</span>
<span class="sd">        - browse_freesurfer: Browse for the FreeSurfer env file</span>
<span class="sd">        - browse_fsl: Called when fsl browse button is clicked</span>
<span class="sd">        - browse_matlab: Called when matlab browse button is clicked</span>
<span class="sd">        - browse_matlab_standalone: Called when matlab browse button is clicked</span>
<span class="sd">        - browse_mri_conv_path: Called when &quot;MRIManager.jar&quot; browse</span>
<span class="sd">                                button is clicked</span>
<span class="sd">        - browse_mrtrix: Called when mrtrix browse button is clicked</span>
<span class="sd">        - browse_projects_save_path: Called when &quot;Projects folder&quot; browse</span>
<span class="sd">                                     button is clicked</span>
<span class="sd">        - browse_resources_path: Called when &quot;resources&quot; browse button is</span>
<span class="sd">                                 clicked</span>
<span class="sd">        - browse_spm: Called when spm browse button is clicked</span>
<span class="sd">        - browse_spm_standalone: Called when spm standalone browse button</span>
<span class="sd">                                 is clicked</span>
<span class="sd">        - change_admin_psswd: Method to change the admin password</span>
<span class="sd">        - control_checkbox_toggled: Check before changing controller version</span>
<span class="sd">        - create_afni_group: Create the AFNI group box</span>

<span class="sd">        - create_ants_group: Create the ANTS group box</span>
<span class="sd">        - create_appearance_tab: Create the &#39;Appearance&#39; tab</span>
<span class="sd">        - create_capsul_group: Create the CAPSUL group box</span>
<span class="sd">        - create_freesurfer_group: Create the FreeSurfer group box</span>
<span class="sd">        - create_fsl_group: Create the FSL group box</span>
<span class="sd">        - create_global_preferences: Create the global preferences group box</span>
<span class="sd">        - create_horizontal_box: Create a horizontal box layout with the</span>
<span class="sd">                                 given widgets</span>
<span class="sd">        - create_matlab_group: Create the Matlab group box</span>
<span class="sd">        - create_mrtrix_group: Create the mrtrix group box</span>
<span class="sd">        - create_pipeline_tab: Create the &#39;Pipeline&#39; tab</span>
<span class="sd">        - create_projects_preferences: Create the projects preferences group</span>
<span class="sd">                                       box</span>
<span class="sd">        - create_populse_preferences: Create the Populse third party</span>
<span class="sd">                                      preferences group box</span>
<span class="sd">        - create_resources_preferences: Create the external resources</span>
<span class="sd">                                        preferences group box</span>
<span class="sd">        - create_spm_group: Create the SPM group box</span>
<span class="sd">        - create_tools_tab: Create the &#39;Tools&#39; tab</span>
<span class="sd">        - edit_capsul_config: Capsul engine edition</span>
<span class="sd">        - edit_config_file: Create a window to view, edit the mia</span>
<span class="sd">                            configuration file</span>
<span class="sd">        - findChar: Highlights characters in red when using the Find button</span>
<span class="sd">                    when editing configuration</span>
<span class="sd">        - load_config: Load the configuration settings</span>
<span class="sd">        - ok_clicked: Saves the modifications to the config file and apply</span>
<span class="sd">                      them</span>
<span class="sd">        - save_minimal_config: Save minimal configuration for CAPSUL config</span>
<span class="sd">                               sync purposes</span>
<span class="sd">        - save_full_config: Save the full configuration and validate settings</span>
<span class="sd">        - setup_ui: Set up the user interface components</span>
<span class="sd">        - show_error_message: Show an error message dialog</span>
<span class="sd">        - show_warning_message: Show a warning message dialog</span>
<span class="sd">        - update_gui_from_capsul_config: Update the GUI based on the CAPSUL</span>
<span class="sd">                                         configuration</span>
<span class="sd">        - use_afni_changed: Called when the use_afni checkbox is changed</span>
<span class="sd">        - use_ants_changed: Called when the use_ants checkbox is changed</span>
<span class="sd">        - use_current_mainwindow_size: Use the current main window size</span>
<span class="sd">        - use_freesurfer_changed: Handle the use_freesurfer checkbox change</span>
<span class="sd">                                  event</span>
<span class="sd">        - use_fsl_changed: Called when the use_fsl checkbox is changed</span>
<span class="sd">        - use_matlab_changed: Called when the use_matlab checkbox is changed</span>
<span class="sd">        - use_matlab_standalone_changed: Called when the use_matlab_standalone</span>
<span class="sd">                                         checkbox is changed</span>
<span class="sd">        - use_mrtrix_changed: Called when the use_mrtrix checkbox is changed</span>
<span class="sd">        - use_spm_changed: Called when the use_spm checkbox is changed</span>
<span class="sd">        - use_spm_standalone_changed: Called when the use_spm_standalone</span>
<span class="sd">                                      checkbox is changed</span>
<span class="sd">        - validate_and_save: Validate and save the preferences</span>
<span class="sd">        - validate_matlab_path: Validate the Matlab path</span>
<span class="sd">        - validate_matlab_standalone_path: Validate the Matlab standalone path</span>
<span class="sd">        - validate_paths: Validate the paths and settings</span>
<span class="sd">        - validate_spm_path: Validate the SPM path</span>
<span class="sd">        - validate_spm_standalone_path: Validate the SPM standalone path</span>
<span class="sd">        - validate_tool_path: Validate the tool path</span>
<span class="sd">        - wrong_path: Show a wrong path message</span>


<span class="sd">    .. Signals:</span>
<span class="sd">        - signal_preferences_change: Signal emitted when the preferences are</span>
<span class="sd">                                     successfully validated and saved</span>
<span class="sd">        - use_clinical_mode_signal: Signal emitted when the clinical mode is</span>
<span class="sd">                                    enabled</span>
<span class="sd">        - not_use_clinical_mode_signal: Signal emitted when the clinical mode</span>
<span class="sd">                                        is disabled</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">signal_preferences_change</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>
    <span class="n">use_clinical_mode_signal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>
    <span class="n">not_use_clinical_mode_signal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>

<div class="viewcode-block" id="PopUpPreferences.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">main_window</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the preferences dialog.</span>

<span class="sd">        :param main_window: The main window object of the software</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setModal</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span> <span class="o">=</span> <span class="n">main_window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clicked</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">salt</span> <span class="o">=</span> <span class="s2">&quot;P0pulseM1@&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_ui</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_config</span><span class="p">()</span>
        <span class="c1"># Disabling widgets</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_changed</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_changed</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_changed</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_standalone_changed</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_fsl_changed</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_afni_changed</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_ants_changed</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_freesurfer_changed</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_mrtrix_changed</span><span class="p">()</span>
        <span class="c1"># Connects the change of state event for a checkbox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_checkbox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_changed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_checkbox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_changed</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_checkbox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spm_changed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_standalone_checkbox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_standalone_changed</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_fsl_checkbox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_fsl_changed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_afni_checkbox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_afni_changed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_ants_checkbox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_ants_changed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_mrtrix_checkbox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_mrtrix_changed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_freesurfer_checkbox</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_freesurfer_changed</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.admin_mode_switch">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.admin_mode_switch">[docs]</a>
    <span class="k">def</span> <span class="nf">admin_mode_switch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the admin mode checkbox click event.&quot;&quot;&quot;</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">admin_mode_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">psswd</span><span class="p">,</span> <span class="n">ok</span> <span class="o">=</span> <span class="n">QInputDialog</span><span class="o">.</span><span class="n">getText</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="s2">&quot;Password Input Dialog&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Enter the admin password:&quot;</span><span class="p">,</span>
                <span class="n">QLineEdit</span><span class="o">.</span><span class="n">Password</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">ok</span><span class="p">:</span>
                <span class="n">salt_psswd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">salt</span><span class="si">}{</span><span class="n">psswd</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">hash_psswd</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">salt_psswd</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">hash_psswd</span> <span class="o">!=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_admin_hash</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">admin_mode_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
                        <span class="s2">&quot;&lt;i style=&#39;color:red&#39;&gt;Wrong password.&lt;/i&gt;&quot;</span>
                    <span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">change_psswd</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">edit_config</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">admin_mode_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">change_psswd</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edit_config</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.browse_afni">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.browse_afni">[docs]</a>
    <span class="k">def</span> <span class="nf">browse_afni</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Browse for the AFNI directory.&quot;&quot;&quot;</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Choose AFNI directory&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">fname</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">afni_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.browse_ants">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.browse_ants">[docs]</a>
    <span class="k">def</span> <span class="nf">browse_ants</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Browse for the ANTS directory.&quot;&quot;&quot;</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Choose ANTS directory&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">fname</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ants_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.browse_freesurfer">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.browse_freesurfer">[docs]</a>
    <span class="k">def</span> <span class="nf">browse_freesurfer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Browse for the FreeSurfer env file.&quot;&quot;&quot;</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Choose freesurfer env file&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">fname</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">freesurfer_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.browse_fsl">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.browse_fsl">[docs]</a>
    <span class="k">def</span> <span class="nf">browse_fsl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Browse for the FSL config file.&quot;&quot;&quot;</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Choose FSL config file&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">fname</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fsl_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.browse_matlab">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.browse_matlab">[docs]</a>
    <span class="k">def</span> <span class="nf">browse_matlab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Browse for the Matlab file.&quot;&quot;&quot;</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Choose Matlab file&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">fname</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matlab_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.browse_matlab_standalone">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.browse_matlab_standalone">[docs]</a>
    <span class="k">def</span> <span class="nf">browse_matlab_standalone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Browse for the Matlab standalone directory.&quot;&quot;&quot;</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Choose MCR directory&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">fname</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.browse_mri_conv_path">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.browse_mri_conv_path">[docs]</a>
    <span class="k">def</span> <span class="nf">browse_mri_conv_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Browse for the MRIFileManager.jar file.&quot;&quot;&quot;</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;Select the location of the MRIManager.jar file&quot;</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">fname</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mri_conv_path_line_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.browse_mrtrix">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.browse_mrtrix">[docs]</a>
    <span class="k">def</span> <span class="nf">browse_mrtrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Browse for the mrtrix directory.&quot;&quot;&quot;</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Choose mrtrix directory&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">fname</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mrtrix_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.browse_projects_save_path">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.browse_projects_save_path">[docs]</a>
    <span class="k">def</span> <span class="nf">browse_projects_save_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Browse for the projects folder.&quot;&quot;&quot;</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;Select a folder where to save the projects&quot;</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">fname</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">projects_save_path_line_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;.gitignore&quot;</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">myFile</span><span class="p">:</span>
                <span class="n">myFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;/*&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.browse_resources_path">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.browse_resources_path">[docs]</a>
    <span class="k">def</span> <span class="nf">browse_resources_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Browse for the resources folder.&quot;&quot;&quot;</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;Select the location of the external resources folder&quot;</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">fname</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resources_path_line_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.browse_spm">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.browse_spm">[docs]</a>
    <span class="k">def</span> <span class="nf">browse_spm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Browse for the SPM directory.&quot;&quot;&quot;</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Choose SPM directory&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">fname</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.browse_spm_standalone">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.browse_spm_standalone">[docs]</a>
    <span class="k">def</span> <span class="nf">browse_spm_standalone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Browse for the SPM standalone directory.&quot;&quot;&quot;</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Choose SPM standalone directory&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">fname</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.change_admin_psswd">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.change_admin_psswd">[docs]</a>
    <span class="k">def</span> <span class="nf">change_admin_psswd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open a dialog to change the admin password with validation checks.</span>

<span class="sd">        :param status (str): Initial status message to display in the dialog.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">change</span> <span class="o">=</span> <span class="n">QDialog</span><span class="p">()</span>
        <span class="n">change</span><span class="o">.</span><span class="n">old_psswd</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="n">change</span><span class="o">.</span><span class="n">new_psswd</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="n">change</span><span class="o">.</span><span class="n">new_psswd_conf</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="n">status</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&lt;i&gt;</span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&lt;/i&gt;&quot;</span>
        <span class="n">change</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
        <span class="n">change</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;color:red&quot;</span><span class="p">)</span>
        <span class="n">change</span><span class="o">.</span><span class="n">old_psswd</span><span class="o">.</span><span class="n">setEchoMode</span><span class="p">(</span><span class="n">QLineEdit</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span>
        <span class="n">change</span><span class="o">.</span><span class="n">new_psswd</span><span class="o">.</span><span class="n">setEchoMode</span><span class="p">(</span><span class="n">QLineEdit</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span>
        <span class="n">change</span><span class="o">.</span><span class="n">new_psswd_conf</span><span class="o">.</span><span class="n">setEchoMode</span><span class="p">(</span><span class="n">QLineEdit</span><span class="o">.</span><span class="n">Password</span><span class="p">)</span>
        <span class="n">buttonBox</span> <span class="o">=</span> <span class="n">QDialogButtonBox</span><span class="p">(</span>
            <span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">,</span> <span class="bp">self</span>
        <span class="p">)</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QFormLayout</span><span class="p">()</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;Old password&quot;</span><span class="p">,</span> <span class="n">change</span><span class="o">.</span><span class="n">old_psswd</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;New password&quot;</span><span class="p">,</span> <span class="n">change</span><span class="o">.</span><span class="n">new_psswd</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;Confirm new password&quot;</span><span class="p">,</span> <span class="n">change</span><span class="o">.</span><span class="n">new_psswd_conf</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">change</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">buttonBox</span><span class="p">)</span>
        <span class="n">buttonBox</span><span class="o">.</span><span class="n">accepted</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">change</span><span class="o">.</span><span class="n">accept</span><span class="p">)</span>
        <span class="n">buttonBox</span><span class="o">.</span><span class="n">rejected</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">change</span><span class="o">.</span><span class="n">reject</span><span class="p">)</span>
        <span class="n">change</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
        <span class="n">event</span> <span class="o">=</span> <span class="n">change</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">event</span><span class="p">:</span>
            <span class="n">change</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
            <span class="n">old_psswd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">salt</span><span class="si">}{</span><span class="n">change</span><span class="o">.</span><span class="n">old_psswd</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">hash_psswd</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">old_psswd</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">hash_psswd</span> <span class="o">==</span> <span class="n">config</span><span class="o">.</span><span class="n">get_admin_hash</span><span class="p">()</span>
                <span class="ow">and</span> <span class="n">change</span><span class="o">.</span><span class="n">new_psswd</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="n">change</span><span class="o">.</span><span class="n">new_psswd_conf</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">change</span><span class="o">.</span><span class="n">new_psswd</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">6</span>
            <span class="p">):</span>
                <span class="n">new_psswd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">salt</span><span class="si">}{</span><span class="n">change</span><span class="o">.</span><span class="n">new_psswd</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_admin_hash</span><span class="p">(</span>
                    <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">new_psswd</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="n">hash_psswd</span> <span class="o">!=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_admin_hash</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">change_admin_psswd</span><span class="p">(</span><span class="s2">&quot;The old password is incorrect.&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">change</span><span class="o">.</span><span class="n">new_psswd</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">change_admin_psswd</span><span class="p">(</span>
                    <span class="s2">&quot;Your password must have more than 6 characters&quot;</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="n">change</span><span class="o">.</span><span class="n">new_psswd</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">!=</span> <span class="n">change</span><span class="o">.</span><span class="n">new_psswd_conf</span><span class="o">.</span><span class="n">text</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">change_admin_psswd</span><span class="p">(</span><span class="s2">&quot;The new passwords are not the same.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.control_checkbox_toggled">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.control_checkbox_toggled">[docs]</a>
    <span class="k">def</span> <span class="nf">control_checkbox_toggled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the user really wants to change the controller version.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_checkbox</span><span class="o">.</span><span class="n">toggle</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Controller version change&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">control_checkbox_changed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setInformativeText</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;To change the controller from &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;V1&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">config</span><span class="o">.</span><span class="n">isControlV1</span><span class="p">()</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;V2&#39;</span><span class="si">}</span><span class="s2"> to &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;V2&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">config</span><span class="o">.</span><span class="n">isControlV1</span><span class="p">()</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;V1&#39;</span><span class="si">}</span><span class="s2">, MIA must be &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;restarted. Would you like to plan this change for next &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;start-up?&quot;</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setInformativeText</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Change of controller from &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;V1&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">config</span><span class="o">.</span><span class="n">isControlV1</span><span class="p">()</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;V2&#39;</span><span class="si">}</span><span class="s2"> to &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;V2&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">config</span><span class="o">.</span><span class="n">isControlV1</span><span class="p">()</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;V1&#39;</span><span class="si">}</span><span class="s2"> is already &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;planned for next start-up. Would you like to cancel &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;this change?&quot;</span>
            <span class="p">)</span>

        <span class="n">return_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">return_value</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">control_checkbox_changed</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">control_checkbox_changed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">set_controller_version</span><span class="p">()</span>

        <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpPreferences.create_afni_group">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.create_afni_group">[docs]</a>
    <span class="k">def</span> <span class="nf">create_afni_group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the AFNI group box.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_afni_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Use AFNI&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_afni_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">afni_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;AFNI path (e.g. dir_containing_abin/abin):&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">afni_choice</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">afni_browse</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Browse&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">afni_browse</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">browse_afni</span><span class="p">)</span>
        <span class="n">v_box_afni_path</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_afni_path</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">afni_label</span><span class="p">)</span>
        <span class="n">v_box_afni_path</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">afni_choice</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">afni_browse</span><span class="p">,</span> <span class="n">add_stretch</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_afni</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_afni</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_afni_checkbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_afni_label</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_afni</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">v_box_afni_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_afni</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">v_box_afni</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.create_ants_group">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.create_ants_group">[docs]</a>
    <span class="k">def</span> <span class="nf">create_ants_group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the ANTS group box.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_ants_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Use ANTS&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_ants_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ants_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;ANTS path (e.g. ANTs_dir/bin):&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ants_choice</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ants_browse</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Browse&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ants_browse</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">browse_ants</span><span class="p">)</span>
        <span class="n">v_box_ants_path</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_ants_path</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ants_label</span><span class="p">)</span>
        <span class="n">v_box_ants_path</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ants_choice</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ants_browse</span><span class="p">,</span> <span class="n">add_stretch</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_ants</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_ants</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_ants_checkbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_ants_label</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_ants</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">v_box_ants_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_ants</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">v_box_ants</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.create_appearance_tab">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.create_appearance_tab">[docs]</a>
    <span class="k">def</span> <span class="nf">create_appearance_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_translate</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create and configure the &#39;Appearance&#39; tab with color and display</span>
<span class="sd">        settings.</span>

<span class="sd">        :param _translate (callable): Function used to translate UI text</span>
<span class="sd">                                      (translate method of QCoreApplication</span>
<span class="sd">                                      in the Qt framework.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_appearance</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_appearance</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;tab_appearance&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_widget</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tab_appearance</span><span class="p">,</span> <span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Dialog&quot;</span><span class="p">,</span> <span class="s2">&quot;Appearance&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;Black&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Blue&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Green&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Grey&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Orange&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Red&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Yellow&quot;</span><span class="p">,</span>
            <span class="s2">&quot;White&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appearance_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_background_color</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Background color&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background_color_combo</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_text_color</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Text color&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_color_combo</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background_color_combo</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_color_combo</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">color</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">background_color_combo</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">text_color_combo</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fullscreen_cbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Use full screen&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow_size_x_spinbox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow_size_x_spinbox</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span>
            <span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">desktop</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow_size_y_spinbox</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow_size_y_spinbox</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span>
            <span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">desktop</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow_size_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;use current size&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow_size_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_current_mainwindow_size</span>
        <span class="p">)</span>
        <span class="n">mainwindow_size_lay</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">mainwindow_size_lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Main window size&quot;</span><span class="p">))</span>
        <span class="n">mainwindow_size_lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainwindow_size_x_spinbox</span><span class="p">)</span>
        <span class="n">mainwindow_size_lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot; x &quot;</span><span class="p">))</span>
        <span class="n">mainwindow_size_lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainwindow_size_y_spinbox</span><span class="p">)</span>
        <span class="n">mainwindow_size_lay</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainwindow_size_button</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appearance_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_background_color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appearance_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">background_color_combo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appearance_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_text_color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appearance_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_color_combo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appearance_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullscreen_cbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appearance_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">mainwindow_size_lay</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appearance_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_appearance</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">appearance_layout</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.create_capsul_group">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.create_capsul_group">[docs]</a>
    <span class="k">def</span> <span class="nf">create_capsul_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groupbox_capsul</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create and configure the CAPSUL group box with a configuration</span>
<span class="sd">        button.</span>

<span class="sd">        :param groupbox_capsul (QGroupBox): The group box to be configured</span>
<span class="sd">                                            for CAPSUL settings.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">capsul_config_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span>
            <span class="s2">&quot;Edit CAPSUL config&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">autoDefault</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="n">capsul_config_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_capsul_config</span><span class="p">)</span>
        <span class="n">h_box_capsul</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">h_box_capsul</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">capsul_config_button</span><span class="p">)</span>
        <span class="n">h_box_capsul</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">v_box_capsul</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_capsul</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">h_box_capsul</span><span class="p">)</span>
        <span class="n">groupbox_capsul</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">v_box_capsul</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.create_freesurfer_group">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.create_freesurfer_group">[docs]</a>
    <span class="k">def</span> <span class="nf">create_freesurfer_group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the FreeSurfer group box.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_freesurfer_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Use FreeSurfer&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_freesurfer_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freesurfer_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="s2">&quot;FreeSurfer path (e.g. FreeSurfer_dir/FreeSurferEnv.sh):&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freesurfer_choice</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freesurfer_browse</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Browse&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freesurfer_browse</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">browse_freesurfer</span><span class="p">)</span>
        <span class="n">v_box_freesurfer_path</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_freesurfer_path</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">freesurfer_label</span><span class="p">)</span>
        <span class="n">v_box_freesurfer_path</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">freesurfer_choice</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">freesurfer_browse</span><span class="p">,</span>
                <span class="n">add_stretch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_freesurfer</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_freesurfer</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_freesurfer_checkbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_freesurfer_label</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_freesurfer</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">v_box_freesurfer_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_freesurfer</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">v_box_freesurfer</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.create_fsl_group">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.create_fsl_group">[docs]</a>
    <span class="k">def</span> <span class="nf">create_fsl_group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the FSL group box.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_fsl_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Use FSL&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_fsl_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fsl_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="s2">&quot;FSL config file (e.g., fsl_dir/etc/fslconf/fsl.sh):&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fsl_choice</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fsl_browse</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Browse&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fsl_browse</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">browse_fsl</span><span class="p">)</span>
        <span class="n">v_box_fsl_path</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_fsl_path</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsl_label</span><span class="p">)</span>
        <span class="n">v_box_fsl_path</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fsl_choice</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fsl_browse</span><span class="p">,</span> <span class="n">add_stretch</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_fsl</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_fsl</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_fsl_checkbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_fsl_label</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_fsl</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">v_box_fsl_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_fsl</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">v_box_fsl</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.create_global_preferences">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.create_global_preferences">[docs]</a>
    <span class="k">def</span> <span class="nf">create_global_preferences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the global preferences group box.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Auto save&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clinical_mode_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clinical_mode_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Clinical mode&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">admin_mode_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">admin_mode_checkbox</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">admin_mode_switch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">admin_mode_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Admin mode&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">change_psswd</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span>
            <span class="s2">&quot;Change password&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">autoDefault</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">change_psswd</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">change_admin_psswd</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit_config</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span>
            <span class="s2">&quot;Edit config&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">autoDefault</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit_config</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_config_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Version 1 controller&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_checkbox_changed</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">get_controller_version</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_checkbox</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">control_checkbox_toggled</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_thumbnails_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="s2">&quot;Number of thumbnails in Data Browser:&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_thumbnails_box</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_thumbnails_box</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_thumbnails_box</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_thumbnails_box</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioView_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioView_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="s2">&quot;Radiological orientation in miniviewer (data browser)&quot;</span>
        <span class="p">)</span>

        <span class="n">v_box_global</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_global</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_checkbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_label</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_global</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clinical_mode_checkbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clinical_mode_label</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_global</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">admin_mode_checkbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">admin_mode_label</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_global</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">change_psswd</span><span class="p">))</span>
        <span class="n">v_box_global</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_config</span><span class="p">))</span>
        <span class="n">v_box_global</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">control_checkbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">control_label</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_global</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_thumbnails_label</span><span class="p">)</span>
        <span class="n">v_box_global</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_thumbnails_box</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_global</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">radioView_checkbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioView_label</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_global</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">v_box_global</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.create_horizontal_box">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.create_horizontal_box">[docs]</a>
    <span class="k">def</span> <span class="nf">create_horizontal_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">widgets</span><span class="p">,</span> <span class="n">add_stretch</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a horizontal box layout containing the specified widgets.</span>

<span class="sd">        :param widgets (tuple[QtWidgets.QWidget, ...]): The widgets to add</span>
<span class="sd">                                                        to the layout.</span>
<span class="sd">        :param add_stretch (bool): Whether to add stretch at the end to push</span>
<span class="sd">                                   the widgets to the left. Defaults to True.</span>

<span class="sd">        :return (QHBoxLayout): The created horizontal box layout.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">h_box</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">widget</span> <span class="ow">in</span> <span class="n">widgets</span><span class="p">:</span>
            <span class="n">h_box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">add_stretch</span><span class="p">:</span>
            <span class="n">h_box</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">h_box</span></div>


<div class="viewcode-block" id="PopUpPreferences.create_matlab_group">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.create_matlab_group">[docs]</a>
    <span class="k">def</span> <span class="nf">create_matlab_group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the Matlab group box.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Use Matlab&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matlab_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="s2">&quot;Matlab path (e.g., matlab_dir/bin/matlab):&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matlab_choice</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matlab_browse</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Browse&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matlab_browse</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">browse_matlab</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Use Matlab standalone&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="s2">&quot;Matlab standalone path (e.g., MCR_dir/v95):&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_choice</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_browse</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Browse&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_browse</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">browse_matlab_standalone</span>
        <span class="p">)</span>
        <span class="n">v_box_matlab_path</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_matlab_path</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matlab_label</span><span class="p">)</span>
        <span class="n">v_box_matlab_path</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">matlab_choice</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matlab_browse</span><span class="p">,</span> <span class="n">add_stretch</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_matlab_standalone_path</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_matlab_standalone_path</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_checkbox</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_label</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_matlab_standalone_path</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_label</span><span class="p">)</span>
        <span class="n">v_box_matlab_standalone_path</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_choice</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_browse</span><span class="p">,</span>
                <span class="n">add_stretch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_matlab</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_matlab</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_checkbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_label</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_matlab</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">v_box_matlab_path</span><span class="p">)</span>
        <span class="n">v_box_matlab</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">v_box_matlab_standalone_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_matlab</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">v_box_matlab</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.create_mrtrix_group">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.create_mrtrix_group">[docs]</a>
    <span class="k">def</span> <span class="nf">create_mrtrix_group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the mrtrix group box.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_mrtrix_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Use mrtrix&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_mrtrix_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mrtrix_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;mrtrix path (e.g. mrtrix_dir/bin):&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mrtrix_choice</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mrtrix_browse</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Browse&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mrtrix_browse</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">browse_mrtrix</span><span class="p">)</span>
        <span class="n">v_box_mrtrix_path</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_mrtrix_path</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mrtrix_label</span><span class="p">)</span>
        <span class="n">v_box_mrtrix_path</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mrtrix_choice</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mrtrix_browse</span><span class="p">,</span> <span class="n">add_stretch</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_mrtrix</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_mrtrix</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_mrtrix_checkbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_mrtrix_label</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_mrtrix</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">v_box_mrtrix_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_mrtrix</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">v_box_mrtrix</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.create_pipeline_tab">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.create_pipeline_tab">[docs]</a>
    <span class="k">def</span> <span class="nf">create_pipeline_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_translate</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create the &#39;Pipeline&#39; tab in the settings interface.</span>

<span class="sd">        This tab allows configuring various neuroimaging tool settings,</span>
<span class="sd">        including Matlab, SPM, FSL, AFNI, ANTS, FreeSurfer, MRtrix, and</span>
<span class="sd">        CAPSUL.</span>

<span class="sd">        :param _translate (Callable): Function used to translate UI text</span>
<span class="sd">                                      (translate method of QCoreApplication</span>
<span class="sd">                                      in the Qt framework.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_pipeline</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_pipeline</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;tab_pipeline&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_widget</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tab_pipeline</span><span class="p">,</span> <span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Dialog&quot;</span><span class="p">,</span> <span class="s2">&quot;Pipeline&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_matlab</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Matlab&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_matlab_group</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_spm</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;SPM&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_spm_group</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_fsl</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;FSL&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_fsl_group</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_afni</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;AFNI&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_afni_group</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_ants</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;ANTS&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_ants_group</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_freesurfer</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;FreeSurfer&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_freesurfer_group</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_mrtrix</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;mrtrix&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_mrtrix_group</span><span class="p">()</span>
        <span class="n">groupbox_capsul</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;CAPSUL&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_capsul_group</span><span class="p">(</span><span class="n">groupbox_capsul</span><span class="p">)</span>
        <span class="c1"># general layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_pipeline_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_pipeline_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupbox_matlab</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_pipeline_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupbox_spm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_pipeline_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupbox_fsl</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_pipeline_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupbox_afni</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_pipeline_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupbox_ants</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_pipeline_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupbox_freesurfer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_pipeline_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupbox_mrtrix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_pipeline_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">groupbox_capsul</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_pipeline_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_pipeline</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_pipeline_layout</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.create_projects_preferences">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.create_projects_preferences">[docs]</a>
    <span class="k">def</span> <span class="nf">create_projects_preferences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the projects preferences group box.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">projects_save_path_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Projects folder:&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">projects_save_path_line_edit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">projects_save_path_browse</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Browse&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">projects_save_path_browse</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">browse_projects_save_path</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_projects_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="s1">&#39;Number of projects in &quot;Saved projects&quot;:&#39;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_projects_box</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_projects_box</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_projects_box</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_projects_box</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">v_box_projects_save</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_projects_save</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projects_save_path_label</span><span class="p">)</span>
        <span class="n">v_box_projects_save</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">projects_save_path_line_edit</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">projects_save_path_browse</span><span class="p">,</span>
                <span class="n">add_stretch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_max_projects</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_max_projects</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_projects_label</span><span class="p">)</span>
        <span class="n">v_box_max_projects</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_projects_box</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">projects_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">projects_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">v_box_projects_save</span><span class="p">)</span>
        <span class="n">projects_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">v_box_max_projects</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_projects</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">projects_layout</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.create_populse_preferences">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.create_populse_preferences">[docs]</a>
    <span class="k">def</span> <span class="nf">create_populse_preferences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the POPULSE third party preferences group box.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mri_conv_path_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="s2">&quot;Absolute path to MRIManager.jar file: (e.g., mri_conv_dir/&quot;</span>
            <span class="s2">&quot;MRIFileManager/MRIManager.jar)&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mri_conv_path_line_edit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mri_conv_path_browse</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Browse&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mri_conv_path_browse</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">browse_mri_conv_path</span><span class="p">)</span>
        <span class="n">v_box_mri_conv</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_mri_conv</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mri_conv_path_label</span><span class="p">)</span>
        <span class="n">v_box_mri_conv</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mri_conv_path_line_edit</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mri_conv_path_browse</span><span class="p">,</span>
                <span class="n">add_stretch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">populse_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">populse_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">v_box_mri_conv</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_populse</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">populse_layout</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.create_resources_preferences">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.create_resources_preferences">[docs]</a>
    <span class="k">def</span> <span class="nf">create_resources_preferences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the external resources preferences group box.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resources_path_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="s2">&quot;Absolute path to the external resource data (required by &quot;</span>
            <span class="s2">&quot;certain processes for proper functionality):&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resources_path_line_edit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resources_path_browse</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Browse&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resources_path_browse</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">browse_resources_path</span><span class="p">)</span>
        <span class="n">v_box_resources</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_resources</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resources_path_label</span><span class="p">)</span>
        <span class="n">v_box_resources</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">resources_path_line_edit</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">resources_path_browse</span><span class="p">,</span>
                <span class="n">add_stretch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">resources_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">resources_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">v_box_resources</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_resources</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">resources_layout</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.create_spm_group">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.create_spm_group">[docs]</a>
    <span class="k">def</span> <span class="nf">create_spm_group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the SPM group box.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Use SPM&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spm_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;SPM path (e.g., spm_dir/spm12):&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spm_choice</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spm_browse</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Browse&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spm_browse</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">browse_spm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_standalone_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Use SPM standalone&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_standalone_checkbox</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="s2">&quot;SPM standalone path (e.g., the directory hosting the &quot;</span>
            <span class="s2">&quot;run_spm12.sh file):&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_choice</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_browse</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Browse&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_browse</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">browse_spm_standalone</span><span class="p">)</span>
        <span class="n">v_box_spm_path</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_spm_path</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spm_label</span><span class="p">)</span>
        <span class="n">v_box_spm_path</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spm_choice</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spm_browse</span><span class="p">,</span> <span class="n">add_stretch</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_spm_standalone_path</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_spm_standalone_path</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_label</span><span class="p">)</span>
        <span class="n">v_box_spm_standalone_path</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_choice</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_browse</span><span class="p">,</span>
                <span class="n">add_stretch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_spm</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">v_box_spm</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_checkbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_label</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_spm</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">v_box_spm_path</span><span class="p">)</span>
        <span class="n">v_box_spm</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_standalone_checkbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_standalone_label</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">v_box_spm</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">v_box_spm_standalone_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_spm</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">v_box_spm</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.create_tools_tab">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.create_tools_tab">[docs]</a>
    <span class="k">def</span> <span class="nf">create_tools_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_translate</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create the &#39;Tools&#39; tab in the settings interface.</span>

<span class="sd">        This tab contains various sections for configuring global preferences,</span>
<span class="sd">        project-specific settings, third-party tool integration, and external</span>
<span class="sd">        resources.</span>

<span class="sd">        :param _translate (Callable): Function used to translate UI text</span>
<span class="sd">                                      (translate method of QCoreApplication</span>
<span class="sd">                                      in the Qt framework.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_tools</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_tools</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;tab_tools&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_widget</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_tools</span><span class="p">,</span> <span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Dialog&quot;</span><span class="p">,</span> <span class="s2">&quot;Tools&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_global</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Global preferences&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_global_preferences</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_projects</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Projects preferences&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_projects_preferences</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_populse</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;POPULSE third party preference&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_populse_preferences</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupbox_resources</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;External resources preferences&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_resources_preferences</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_tools_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_tools_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_horizontal_box</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupbox_global</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_tools_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupbox_projects</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_tools_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupbox_populse</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_tools_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groupbox_resources</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_tools_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_tools</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_tools_layout</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.edit_capsul_config">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.edit_capsul_config">[docs]</a>
    <span class="k">def</span> <span class="nf">edit_capsul_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Capsul engine edition.</span>

<span class="sd">        This method is used when user hit the Edit CAPSUL config button</span>
<span class="sd">        (File &gt; MIA preferences &gt; Pipeline tab).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Validate the current Mia config first</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_and_save</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
        <span class="n">capsul_config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_capsul_config</span><span class="p">(</span><span class="n">sync_from_engine</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">modules</span> <span class="o">=</span> <span class="n">capsul_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;engine_modules&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="c1"># Build a temporary new engine (because it may not be validated)</span>
        <span class="n">engine</span> <span class="o">=</span> <span class="n">capsul_engine</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="n">modules</span> <span class="o">+</span> <span class="p">[</span>
            <span class="s2">&quot;fom&quot;</span><span class="p">,</span>
            <span class="s2">&quot;axon&quot;</span><span class="p">,</span>
            <span class="s2">&quot;python&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fsl&quot;</span><span class="p">,</span>
            <span class="s2">&quot;freesurfer&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nipype&quot;</span><span class="p">,</span>
            <span class="s2">&quot;afni&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ants&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mrtrix&quot;</span><span class="p">,</span>
            <span class="s2">&quot;somaworkflow&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">engine</span><span class="o">.</span><span class="n">load_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

        <span class="n">envs</span> <span class="o">=</span> <span class="n">capsul_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;engine&quot;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="k">for</span> <span class="n">env</span><span class="p">,</span> <span class="n">conf</span> <span class="ow">in</span> <span class="n">envs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">c</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">conf</span><span class="p">)</span>

            <span class="k">if</span> <span class="s2">&quot;capsul_engine&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">c</span> <span class="ow">or</span> <span class="s2">&quot;uses&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">c</span><span class="p">[</span><span class="s2">&quot;capsul_engine&quot;</span><span class="p">]:</span>
                <span class="n">c</span><span class="p">[</span><span class="s2">&quot;capsul_engine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;uses&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="n">engine</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">module_name</span><span class="p">(</span><span class="n">m</span><span class="p">):</span> <span class="s2">&quot;ALL&quot;</span>
                        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">conf</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                    <span class="p">}</span>
                <span class="p">}</span>

            <span class="n">engine</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">import_configs</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">cont_on_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">dialog</span> <span class="o">=</span> <span class="n">SettingsEditor</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">settings</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">export_config_dict</span><span class="p">()</span>
            <span class="n">capsul_config</span><span class="p">[</span><span class="s2">&quot;engine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">settings</span>
            <span class="n">capsul_config</span><span class="p">[</span><span class="s2">&quot;engine_modules&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">engine</span><span class="o">.</span><span class="n">_loaded_modules</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_capsul_config</span><span class="p">(</span><span class="n">capsul_config</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="k">return</span>

            <span class="c1"># Update Mia preferences GUI which might have changed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_from_capsul_config</span><span class="p">(</span><span class="n">capsul_config</span><span class="p">)</span>

        <span class="k">del</span> <span class="n">dialog</span>
        <span class="k">del</span> <span class="n">engine</span></div>


<div class="viewcode-block" id="PopUpPreferences.edit_config_file">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.edit_config_file">[docs]</a>
    <span class="k">def</span> <span class="nf">edit_config_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a window to view, edit the mia configuration file.&quot;&quot;&quot;</span>

        <span class="c1"># import verCmp only here to prevent circular import issue</span>
        <span class="kn">from</span> <span class="nn">populse_mia.utils</span> <span class="kn">import</span> <span class="n">verCmp</span>

        <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editConf</span> <span class="o">=</span> <span class="n">QDialog</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">config</span><span class="o">.</span><span class="n">get_properties_path</span><span class="p">(),</span> <span class="s2">&quot;properties&quot;</span><span class="p">,</span> <span class="s2">&quot;config.yml&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">txt</span> <span class="o">=</span> <span class="n">QPlainTextEdit</span><span class="p">()</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span>
            <span class="n">config</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="n">default_flow_style</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_unicode</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">insertPlainText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">stream</span><span class="p">))</span>
        <span class="n">textWidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">+</span> <span class="mi">100</span>
        <span class="n">textHeight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">+</span> <span class="mi">200</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">textWidth</span><span class="p">,</span> <span class="n">textHeight</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">textWidth</span><span class="p">,</span> <span class="n">textHeight</span><span class="p">)</span>
        <span class="n">buttonBox</span> <span class="o">=</span> <span class="n">QDialogButtonBox</span><span class="p">(</span>
            <span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Ok</span> <span class="o">|</span> <span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">,</span> <span class="bp">self</span>
        <span class="p">)</span>
        <span class="n">buttonBox</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span><span class="o">.</span><span class="n">setDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">buttonBox</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">)</span><span class="o">.</span><span class="n">setDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">findChar_line_edit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="n">findChar_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Find&quot;</span><span class="p">)</span>
        <span class="n">findChar_button</span><span class="o">.</span><span class="n">setDefault</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">h_box_find</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">h_box_find</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">findChar_line_edit</span><span class="p">)</span>
        <span class="n">h_box_find</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">findChar_button</span><span class="p">)</span>
        <span class="n">findChar_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">findChar</span><span class="p">)</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QFormLayout</span><span class="p">()</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">txt</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">h_box_find</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">buttonBox</span><span class="p">)</span>
        <span class="n">buttonBox</span><span class="o">.</span><span class="n">accepted</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">accept</span><span class="p">)</span>
        <span class="n">buttonBox</span><span class="o">.</span><span class="n">rejected</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">reject</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
        <span class="n">event</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">event</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">stream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">verCmp</span><span class="p">(</span><span class="n">yaml</span><span class="o">.</span><span class="n">__version__</span><span class="p">,</span> <span class="s2">&quot;5.1&quot;</span><span class="p">,</span> <span class="s2">&quot;sup&quot;</span><span class="p">):</span>
                <span class="n">config</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">config</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>

            <span class="n">config</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpPreferences.findChar">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.findChar">[docs]</a>
    <span class="k">def</span> <span class="nf">findChar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Highlights characters in red when using the Find button in the</span>
<span class="sd">        configuration editor.</span>

<span class="sd">        This method searches for a pattern entered in the find field and</span>
<span class="sd">        highlights all matching occurrences in the text editor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">textCursor</span><span class="p">()</span>
        <span class="n">cursor</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QTextCursor</span><span class="o">.</span><span class="n">Document</span><span class="p">)</span>
        <span class="n">cursor</span><span class="o">.</span><span class="n">setCharFormat</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QTextCharFormat</span><span class="p">())</span>
        <span class="n">cursor</span><span class="o">.</span><span class="n">clearSelection</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">setTextCursor</span><span class="p">(</span><span class="n">cursor</span><span class="p">)</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findChar_line_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pattern</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">textCursor</span><span class="p">()</span>
        <span class="nb">format</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QTextCharFormat</span><span class="p">()</span>
        <span class="nb">format</span><span class="o">.</span><span class="n">setBackground</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QBrush</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QColor</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)))</span>
        <span class="n">regex</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRegExp</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">indexIn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">(),</span> <span class="n">pos</span><span class="p">)</span>

        <span class="k">while</span> <span class="n">index</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">cursor</span><span class="o">.</span><span class="n">setPosition</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">pattern</span><span class="p">:</span>
                <span class="n">cursor</span><span class="o">.</span><span class="n">movePosition</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QTextCursor</span><span class="o">.</span><span class="n">Right</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

            <span class="n">cursor</span><span class="o">.</span><span class="n">mergeCharFormat</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="n">regex</span><span class="o">.</span><span class="n">matchedLength</span><span class="p">()</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">indexIn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editConf</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">(),</span> <span class="n">pos</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.load_config">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.load_config">[docs]</a>
    <span class="k">def</span> <span class="nf">load_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load the configuration settings.&quot;&quot;&quot;</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">isAutoSave</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clinical_mode_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_use_clinical</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">admin_mode_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">get_user_mode</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">change_psswd</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">get_user_mode</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edit_config</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">get_user_mode</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">isControlV1</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_thumbnails_box</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_max_thumbnails</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radioView_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">isRadioView</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">projects_save_path_line_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
            <span class="n">config</span><span class="o">.</span><span class="n">get_projects_save_path</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_projects_box</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_max_projects</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mri_conv_path_line_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_mri_conv_path</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resources_path_line_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_resources_path</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_afni_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_use_afni</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">afni_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_afni_path</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_ants_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_use_ants</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ants_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_ants_path</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_freesurfer_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_use_freesurfer</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freesurfer_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_freesurfer_setup</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_fsl_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_use_fsl</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fsl_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_fsl_config</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matlab_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_matlab_path</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
            <span class="n">config</span><span class="o">.</span><span class="n">get_matlab_standalone_path</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_mrtrix_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_use_mrtrix</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mrtrix_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_mrtrix_path</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spm_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_spm_path</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">get_use_spm_standalone</span><span class="p">():</span>
            <span class="n">archi</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">architecture</span><span class="p">()</span>

            <span class="k">if</span> <span class="s2">&quot;Windows&quot;</span> <span class="ow">in</span> <span class="n">archi</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_standalone_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">config</span><span class="o">.</span><span class="n">get_use_spm</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_standalone_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">config</span><span class="o">.</span><span class="n">get_use_matlab</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_standalone_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">config</span><span class="o">.</span><span class="n">get_use_matlab_standalone</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_standalone_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_spm_standalone_path</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">background_color_combo</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span>
            <span class="n">config</span><span class="o">.</span><span class="n">getBackgroundColor</span><span class="p">()</span> <span class="ow">or</span> <span class="s2">&quot;White&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_color_combo</span><span class="o">.</span><span class="n">setCurrentText</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">getTextColor</span><span class="p">()</span> <span class="ow">or</span> <span class="s2">&quot;Black&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fullscreen_cbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get_mainwindow_maximized</span><span class="p">())</span>
        <span class="n">wsize</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_mainwindow_size</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wsize</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">wsize</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow_size_x_spinbox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">wsize</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow_size_y_spinbox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">wsize</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>


<div class="viewcode-block" id="PopUpPreferences.ok_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.ok_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">ok_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the OK button click event.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_and_save</span><span class="p">(</span><span class="n">OK_clicked</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpPreferences.save_minimal_config">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.save_minimal_config">[docs]</a>
    <span class="k">def</span> <span class="nf">save_minimal_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves a minimal configuration for CAPSUL config synchronization.</span>

<span class="sd">        :param config (Config): The configuration object to update and save.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_afni_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">afni_choice</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_use_afni</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_afni_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_ants_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ants_choice</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_use_ants</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_ants_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_freesurfer_setup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">freesurfer_choice</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_use_freesurfer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_freesurfer_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_fsl_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fsl_choice</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_use_fsl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_fsl_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_matlab_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matlab_choice</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_matlab_standalone_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_choice</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab_standalone</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_mrtrix_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mrtrix_choice</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_use_mrtrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_mrtrix_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_spm_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spm_choice</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">use_spm_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_spm_standalone_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_choice</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm_standalone</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_standalone_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.save_full_config">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.save_full_config">[docs]</a>
    <span class="k">def</span> <span class="nf">save_full_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves the full configuration and validates settings.</span>

<span class="sd">        :param config (Config): The configuration object to update and save.</span>

<span class="sd">        :return (bool): True if the configuration is valid and successfully</span>
<span class="sd">                        saved, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">config</span><span class="o">.</span><span class="n">setAutoSave</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_radioView</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radioView_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">setControlV1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">control_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_max_thumbnails</span><span class="p">(</span>
            <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_thumbnails_box</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">15</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_max_projects</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_projects_box</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">20</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">windowName</span> <span class="o">=</span> <span class="s2">&quot;MIA - Multiparametric Image Analysis&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">admin_mode_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set_user_mode</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">windowName</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">windowName</span><span class="si">}</span><span class="s2"> (Admin mode)&quot;</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set_user_mode</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Final Window name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">windowName</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">windowName</span><span class="si">}</span><span class="s2"> - &quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">windowName</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">projectName</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">clinical_mode_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set_clinical_mode</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_clinical_mode_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set_clinical_mode</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">not_use_clinical_mode_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>

        <span class="n">fullscreen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullscreen_cbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">config</span><span class="o">.</span><span class="n">set_mainwindow_maximized</span><span class="p">(</span><span class="n">fullscreen</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">fullscreen</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">showMaximized</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">showNormal</span><span class="p">()</span>

        <span class="n">config</span><span class="o">.</span><span class="n">set_mainwindow_size</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow_size_x_spinbox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow_size_y_spinbox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">setBackgroundColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">background_color_combo</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
        <span class="n">config</span><span class="o">.</span><span class="n">setTextColor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text_color_combo</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;background-color:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">background_color_combo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="si">}</span><span class="s2">;&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;color:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">text_color_combo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="si">}</span><span class="s2">;&quot;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_paths</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">signal_preferences_change</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="PopUpPreferences.setup_ui">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.setup_ui">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up the user interface components.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;Dialog&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;MIA preferences&quot;</span><span class="p">)</span>
        <span class="n">_translate</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">translate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_widget</span> <span class="o">=</span> <span class="n">QTabWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_widget</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Create tabs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_tools_tab</span><span class="p">(</span><span class="n">_translate</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_pipeline_tab</span><span class="p">(</span><span class="n">_translate</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_appearance_tab</span><span class="p">(</span><span class="n">_translate</span><span class="p">)</span>
        <span class="c1"># Buttons layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_ok&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ok_clicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Cancel&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_cancel&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">hbox_buttons</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="p">)</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="p">)</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="p">)</span>
        <span class="n">vbox</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_widget</span><span class="p">)</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">hbox_buttons</span><span class="p">)</span>
        <span class="c1"># Global layout - scrollable global window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span> <span class="o">=</span> <span class="n">QScrollArea</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">setWidgetResizable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">vbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_layout</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.show_error_message">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.show_error_message">[docs]</a>
    <span class="k">def</span> <span class="nf">show_error_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Displays an error message dialog.</span>

<span class="sd">        :param title (str): The title of the error message dialog.</span>
<span class="sd">        :param message (str): The detailed error message to display.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Critical</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setInformativeText</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">buttonClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpPreferences.show_warning_message">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.show_warning_message">[docs]</a>
    <span class="k">def</span> <span class="nf">show_warning_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Displays a warning message dialog.</span>

<span class="sd">        :param title (str): The title of the warning message dialog.</span>
<span class="sd">        :param message (str): The detailed warning message to display.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setInformativeText</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">buttonClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpPreferences.update_gui_from_capsul_config">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.update_gui_from_capsul_config">[docs]</a>
    <span class="k">def</span> <span class="nf">update_gui_from_capsul_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conf</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the GUI elements based on the CAPSUL configuration.</span>

<span class="sd">        This method retrieves the configuration settings for various</span>
<span class="sd">        neuroimaging tools (e.g., AFNI, ANTs, FreeSurfer, FSL, Matlab,</span>
<span class="sd">        SPM, etc.) and updates the corresponding GUI fields, including</span>
<span class="sd">        checkboxes and text fields.</span>

<span class="sd">        :param conf (CapsulConfig): The CAPSUL configuration object containing</span>
<span class="sd">                                    the paths and usage states of different</span>
<span class="sd">                                    tools.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># afni</span>
        <span class="n">use_afni</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">get_use_afni</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">use_afni</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">afni_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">get_afni_path</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">use_afni_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">use_afni</span><span class="p">)</span>
        <span class="c1"># ants</span>
        <span class="n">use_ants</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">get_use_ants</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">use_ants</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ants_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">get_ants_path</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">use_ants_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">use_ants</span><span class="p">)</span>
        <span class="c1"># freesurfer</span>
        <span class="n">use_freesurfer</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">get_use_freesurfer</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">use_freesurfer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">freesurfer_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">get_freesurfer_setup</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">use_freesurfer_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">use_freesurfer</span><span class="p">)</span>
        <span class="c1"># fsl</span>
        <span class="n">use_fsl</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">get_use_fsl</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">use_fsl</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fsl_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">get_fsl_config</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">use_fsl_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">use_fsl</span><span class="p">)</span>
        <span class="c1"># matlab</span>
        <span class="n">use_matlab</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">get_use_matlab</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">use_matlab</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matlab_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">get_matlab_path</span><span class="p">())</span>
        <span class="c1"># matlab - MCR</span>
        <span class="n">use_matlab_sa</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">get_use_matlab_standalone</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">use_matlab_sa</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
            <span class="n">conf</span><span class="o">.</span><span class="n">get_matlab_standalone_path</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="c1"># mrtrix</span>
        <span class="n">use_mrtrix</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">get_use_mrtrix</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">use_mrtrix</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mrtrix_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">get_mrtrix_path</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">use_mrtrix_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">use_mrtrix</span><span class="p">)</span>
        <span class="c1"># spm</span>
        <span class="n">use_spm</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">get_use_spm</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">use_spm</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spm_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">get_spm_path</span><span class="p">())</span>
        <span class="c1"># spm - Standalone</span>
        <span class="n">use_spm_sa</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">get_use_spm_standalone</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_standalone_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">use_spm_sa</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_choice</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">get_spm_standalone_path</span><span class="p">())</span></div>


<div class="viewcode-block" id="PopUpPreferences.use_afni_changed">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.use_afni_changed">[docs]</a>
    <span class="k">def</span> <span class="nf">use_afni_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the use_afni checkbox change event.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">afni_choice</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_afni_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">afni_label</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_afni_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span></div>


<div class="viewcode-block" id="PopUpPreferences.use_ants_changed">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.use_ants_changed">[docs]</a>
    <span class="k">def</span> <span class="nf">use_ants_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the use_ants checkbox change event.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ants_choice</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_ants_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ants_label</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_ants_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span></div>


<div class="viewcode-block" id="PopUpPreferences.use_current_mainwindow_size">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.use_current_mainwindow_size">[docs]</a>
    <span class="k">def</span> <span class="nf">use_current_mainwindow_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Use the current main window size.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow_size_x_spinbox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">width</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow_size_y_spinbox</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_window</span><span class="o">.</span><span class="n">height</span><span class="p">())</span></div>


<div class="viewcode-block" id="PopUpPreferences.use_freesurfer_changed">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.use_freesurfer_changed">[docs]</a>
    <span class="k">def</span> <span class="nf">use_freesurfer_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the use_freesurfer checkbox change event.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freesurfer_choice</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span>
            <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_freesurfer_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">freesurfer_label</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span>
            <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_freesurfer_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.use_fsl_changed">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.use_fsl_changed">[docs]</a>
    <span class="k">def</span> <span class="nf">use_fsl_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the use_fsl checkbox change event.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fsl_choice</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_fsl_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fsl_label</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_fsl_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span></div>


<div class="viewcode-block" id="PopUpPreferences.use_matlab_changed">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.use_matlab_changed">[docs]</a>
    <span class="k">def</span> <span class="nf">use_matlab_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the use_matlab checkbox change event.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matlab_choice</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_choice</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matlab_label</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_label</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_browse</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matlab_browse</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matlab_choice</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matlab_label</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matlab_browse</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.use_matlab_standalone_changed">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.use_matlab_standalone_changed">[docs]</a>
    <span class="k">def</span> <span class="nf">use_matlab_standalone_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the use_matlab_standalone checkbox change event.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">archi</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">architecture</span><span class="p">()</span>

            <span class="k">if</span> <span class="s2">&quot;Windows&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">archi</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_choice</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_standalone_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_label</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_browse</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_choice</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_label</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_browse</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_choice</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_label</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_browse</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.use_mrtrix_changed">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.use_mrtrix_changed">[docs]</a>
    <span class="k">def</span> <span class="nf">use_mrtrix_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the use_mrtrix checkbox change event.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mrtrix_choice</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span>
            <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_mrtrix_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mrtrix_label</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_mrtrix_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span></div>


<div class="viewcode-block" id="PopUpPreferences.use_spm_changed">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.use_spm_changed">[docs]</a>
    <span class="k">def</span> <span class="nf">use_spm_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the use_spm checkbox change event.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_choice</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_label</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_browse</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_choice</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_label</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_browse</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_choice</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_label</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_browse</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_standalone_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.use_spm_standalone_changed">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.use_spm_standalone_changed">[docs]</a>
    <span class="k">def</span> <span class="nf">use_spm_standalone_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the use_spm_standalone checkbox change event.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_standalone_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_choice</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_label</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_browse</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">archi</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">architecture</span><span class="p">()</span>

            <span class="k">if</span> <span class="s2">&quot;Windows&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">archi</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_choice</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_label</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_browse</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_choice</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_label</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spm_browse</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_checkbox</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpPreferences.validate_and_save">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.validate_and_save">[docs]</a>
    <span class="k">def</span> <span class="nf">validate_and_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">OK_clicked</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate and save the preferences.</span>

<span class="sd">        :param ok_clicked (bool): Whether the OK button was clicked (True)</span>
<span class="sd">                                  when this method was launched.</span>

<span class="sd">        :Contains:</span>
<span class="sd">            - remove_capsul_config: Helper function to remove a</span>
<span class="sd">                                    module&#39;s configuration</span>
<span class="sd">            - clean_spm_config: Cleans the SPM configuration based</span>
<span class="sd">                                on standalone mode</span>
<span class="sd">            - clean_matlab_config: Removes MATLAB-related configuration keys</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">OK_clicked</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_minimal_config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_full_config</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">c_c</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;capsul_config&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">c_e</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_capsul_engine</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">c_c</span> <span class="ow">and</span> <span class="n">c_e</span><span class="p">):</span>
            <span class="n">config</span><span class="o">.</span><span class="n">get_capsul_config</span><span class="p">(</span><span class="n">sync_from_engine</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">config</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">def</span> <span class="nf">remove_capsul_config</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Helper function to remove a module&#39;s configuration.</span>

<span class="sd">            :param module (str): The name of the module to remove.</span>
<span class="sd">            :param key (str): The specific configuration key to remove.</span>

<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># TODO: We only deal here with the global environment</span>
            <span class="n">cif</span> <span class="o">=</span> <span class="n">c_e</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">config_id_field</span>

            <span class="k">with</span> <span class="n">c_e</span><span class="o">.</span><span class="n">settings</span> <span class="k">as</span> <span class="n">settings</span><span class="p">:</span>
                <span class="n">config_module</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;global&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">config_module</span><span class="p">:</span>
                    <span class="n">settings</span><span class="o">.</span><span class="n">remove_config</span><span class="p">(</span>
                        <span class="n">module</span><span class="p">,</span> <span class="s2">&quot;global&quot;</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config_module</span><span class="p">,</span> <span class="n">cif</span><span class="p">)</span>
                    <span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">module</span> <span class="o">==</span> <span class="s2">&quot;freesurfer&quot;</span><span class="p">:</span>
                <span class="n">c_c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;engine&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;global&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;capsul.engine.module.</span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">{}</span>
                <span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># Sync capsul config from mia config, if module is not used:</span>
        <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;afni&quot;</span><span class="p">,</span> <span class="s2">&quot;ants&quot;</span><span class="p">,</span> <span class="s2">&quot;freesurfer&quot;</span><span class="p">,</span> <span class="s2">&quot;fsl&quot;</span><span class="p">,</span> <span class="s2">&quot;mrtrix&quot;</span><span class="p">]:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;get_use_</span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)():</span>
                <span class="n">remove_capsul_config</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;directory&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">module</span> <span class="o">==</span> <span class="s2">&quot;fsl&quot;</span><span class="p">:</span>
                    <span class="n">remove_capsul_config</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">clean_spm_config</span><span class="p">(</span><span class="n">standalone_check</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Cleans the SPM configuration based on standalone mode.</span>

<span class="sd">            :param standalone_check (bool): Indicates whether to clean based</span>
<span class="sd">                                            on standalone mode.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="n">c_c</span><span class="p">[</span><span class="s2">&quot;engine&quot;</span><span class="p">][</span><span class="s2">&quot;global&quot;</span><span class="p">][</span><span class="s2">&quot;capsul.engine.module.spm&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                <span class="p">)</span>

            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="n">dict4clean</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span>
                    <span class="s2">&quot;standalone&quot;</span>
                    <span class="ow">in</span> <span class="n">c_c</span><span class="p">[</span><span class="s2">&quot;engine&quot;</span><span class="p">][</span><span class="s2">&quot;global&quot;</span><span class="p">][</span><span class="s2">&quot;capsul.engine.module.spm&quot;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
                    <span class="ow">and</span> <span class="n">c_c</span><span class="p">[</span><span class="s2">&quot;engine&quot;</span><span class="p">][</span><span class="s2">&quot;global&quot;</span><span class="p">][</span><span class="s2">&quot;capsul.engine.module.spm&quot;</span><span class="p">][</span><span class="n">k</span><span class="p">][</span>
                        <span class="s2">&quot;standalone&quot;</span>
                    <span class="p">]</span>
                    <span class="o">==</span> <span class="n">standalone_check</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">should_remove</span> <span class="ow">in</span> <span class="n">dict4clean</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                <span class="k">if</span> <span class="n">should_remove</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">c_c</span><span class="p">[</span><span class="s2">&quot;engine&quot;</span><span class="p">][</span><span class="s2">&quot;global&quot;</span><span class="p">][</span><span class="s2">&quot;capsul.engine.module.spm&quot;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">get_use_spm_standalone</span><span class="p">():</span>
            <span class="n">clean_spm_config</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">get_use_spm</span><span class="p">():</span>
            <span class="n">clean_spm_config</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="n">c_c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;engine&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;global&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;capsul.engine.module.spm&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="p">):</span>
            <span class="n">c_c</span><span class="p">[</span><span class="s2">&quot;engine&quot;</span><span class="p">][</span><span class="s2">&quot;global&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;capsul.engine.module.spm&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">clean_matlab_config</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Removes MATLAB-related configuration keys.</span>

<span class="sd">            :param key (str): The configuration key to remove from the MATLAB</span>
<span class="sd">                              module.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="n">c_c</span><span class="p">[</span><span class="s2">&quot;engine&quot;</span><span class="p">][</span><span class="s2">&quot;global&quot;</span><span class="p">][</span>
                        <span class="s2">&quot;capsul.engine.module.matlab&quot;</span>
                    <span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                <span class="p">)</span>

            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                <span class="n">c_c</span><span class="p">[</span><span class="s2">&quot;engine&quot;</span><span class="p">][</span><span class="s2">&quot;global&quot;</span><span class="p">][</span><span class="s2">&quot;capsul.engine.module.matlab&quot;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span>
                    <span class="n">key</span><span class="p">,</span> <span class="kc">None</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">get_use_matlab</span><span class="p">():</span>
            <span class="n">clean_matlab_config</span><span class="p">(</span><span class="s2">&quot;executable&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">get_use_matlab_standalone</span><span class="p">():</span>
            <span class="n">clean_matlab_config</span><span class="p">(</span><span class="s2">&quot;mcr_directory&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="n">c_c</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;engine&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;global&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;capsul.engine.module.matlab&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="p">):</span>
            <span class="n">c_c</span><span class="p">[</span><span class="s2">&quot;engine&quot;</span><span class="p">][</span><span class="s2">&quot;global&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;capsul.engine.module.matlab&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">config</span><span class="o">.</span><span class="n">get_capsul_config</span><span class="p">(</span><span class="n">sync_from_engine</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">config</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="PopUpPreferences.validate_matlab_path">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.validate_matlab_path">[docs]</a>
    <span class="k">def</span> <span class="nf">validate_matlab_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates the given Matlab executable path.</span>

<span class="sd">        :param path (str): The path to the Matlab executable.</span>
<span class="sd">        :param config (Config): The configuration object to update.</span>

<span class="sd">        :return (bool): True if the path is valid and updated in the</span>
<span class="sd">                        configuration, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;Matlab&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">path</span> <span class="o">==</span> <span class="n">config</span><span class="o">.</span><span class="n">get_matlab_path</span><span class="p">():</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="c1"># We don&#39;t test matlab because it has already been</span>
                <span class="c1"># tested before</span>

            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">matlab_cmd</span> <span class="o">=</span> <span class="s2">&quot;ver; exit&quot;</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">path</span><span class="p">,</span>
                        <span class="s2">&quot;-nodisplay&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;-nodesktop&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;-nosplash&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;-singleCompThread&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;-r&quot;</span><span class="p">,</span>
                        <span class="n">matlab_cmd</span><span class="p">,</span>
                    <span class="p">],</span>
                    <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">err</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span>

            <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;Matlab&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># Catch any other unexpected errors</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ Unexpected error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;Matlab&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="n">err</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_matlab_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;Matlab&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If self.use_spm_checkbox.isChecked() is True, the test will</span>
            <span class="c1"># take place when SPM is validated.</span>
            <span class="k">pass</span></div>


<div class="viewcode-block" id="PopUpPreferences.validate_matlab_standalone_path">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.validate_matlab_standalone_path">[docs]</a>
    <span class="k">def</span> <span class="nf">validate_matlab_standalone_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate the Matlab standalone path.</span>

<span class="sd">        This method does not thoroughly test the configuration for Matlab</span>
<span class="sd">        MCR alone (without SPM standalone) due to the lack of a concrete</span>
<span class="sd">        example.</span>

<span class="sd">        :param path (str): The path to the Matlab standalone directory.</span>
<span class="sd">        :param config (Config): The configuration object to update.</span>

<span class="sd">        :return (bool): True if the path is valid and updated in the</span>
<span class="sd">                        configuration, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;Matlab standalone&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_standalone_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">archi</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">architecture</span><span class="p">()</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set_matlab_standalone_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

            <span class="k">if</span> <span class="s2">&quot;Windows&quot;</span> <span class="ow">in</span> <span class="n">archi</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="s2">&quot;Matlab Standalone Path enter, this is &quot;</span>
                    <span class="s2">&quot;unnecessary to use SPM12 with Windows OS.&quot;</span>
                <span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab_standalone</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If self.use_spm_standalone_checkbox.isChecked() is True,</span>
            <span class="c1"># the test will take place when SPM Stadalone is validated.</span>
            <span class="k">pass</span></div>


<div class="viewcode-block" id="PopUpPreferences.validate_paths">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.validate_paths">[docs]</a>
    <span class="k">def</span> <span class="nf">validate_paths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate the paths and settings.</span>

<span class="sd">        This method checks the validity of paths for various neuroimaging</span>
<span class="sd">        tools (AFNI, ANTS, FreeSurfer, FSL, MRtrix, Matlab, SPM, etc.) and</span>
<span class="sd">        updates the configuration accordingly. It also validates additional</span>
<span class="sd">        paths such as the projects folder, MRIFileManager.jar path, and</span>
<span class="sd">        resources folder.</span>

<span class="sd">        :param config (Config): The configuration object where validated</span>
<span class="sd">                                paths and settings will be stored.</span>

<span class="sd">        :return (bool): True if all paths and settings are valid, False</span>
<span class="sd">                        otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WaitCursor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Testing configuration ...&quot;</span><span class="p">)</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="n">tools</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span>
                <span class="s2">&quot;AFNI&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">afni_choice</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_afni_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_afni</span><span class="p">,</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_afni_path</span><span class="p">,</span>
                <span class="s2">&quot;afni&quot;</span><span class="p">,</span>
                <span class="s2">&quot;afni&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="s2">&quot;ANTS&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ants_choice</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_ants_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_ants</span><span class="p">,</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_ants_path</span><span class="p">,</span>
                <span class="s2">&quot;antsRegistration&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ANTS&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="s2">&quot;FreeSurfer&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">freesurfer_choice</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_freesurfer_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_freesurfer</span><span class="p">,</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_freesurfer_setup</span><span class="p">,</span>
                <span class="s2">&quot;recon-all&quot;</span><span class="p">,</span>
                <span class="s2">&quot;freesurfer&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="s2">&quot;FSL&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fsl_choice</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_fsl_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_fsl</span><span class="p">,</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_fsl_config</span><span class="p">,</span>
                <span class="s2">&quot;flirt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;FSL&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="s2">&quot;mrtrix&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mrtrix_choice</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_mrtrix_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_mrtrix</span><span class="p">,</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_mrtrix_path</span><span class="p">,</span>
                <span class="s2">&quot;mrinfo&quot;</span><span class="p">,</span>
                <span class="s2">&quot;mrtrix&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="s2">&quot;Matlab&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">matlab_choice</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab</span><span class="p">,</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_matlab_path</span><span class="p">,</span>
                <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;Matlab&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="s2">&quot;SPM&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spm_choice</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm</span><span class="p">,</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_spm_path</span><span class="p">,</span>
                <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;SPM&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="s2">&quot;Matlab Standalone&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_choice</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_matlab_standalone_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab_standalone</span><span class="p">,</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_matlab_standalone_path</span><span class="p">,</span>
                <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;Matlab standalone&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span>
                <span class="s2">&quot;SPM Standalone&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spm_standalone_choice</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">use_spm_standalone_checkbox</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm_standalone</span><span class="p">,</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_spm_standalone_path</span><span class="p">,</span>
                <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;SPM standalone&quot;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="p">(</span>
            <span class="n">tool_name</span><span class="p">,</span>
            <span class="n">path</span><span class="p">,</span>
            <span class="n">is_checked</span><span class="p">,</span>
            <span class="n">set_in_use</span><span class="p">,</span>
            <span class="n">set_path</span><span class="p">,</span>
            <span class="n">cmd</span><span class="p">,</span>
            <span class="n">config_name</span><span class="p">,</span>
        <span class="p">)</span> <span class="ow">in</span> <span class="n">tools</span><span class="p">:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_checked</span><span class="p">:</span>
                <span class="n">set_in_use</span><span class="p">(</span><span class="n">is_checked</span><span class="p">)</span>

            <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_tool_path</span><span class="p">(</span>
                <span class="n">tool_name</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">config_name</span><span class="p">,</span> <span class="n">set_in_use</span><span class="p">,</span> <span class="n">set_path</span>
            <span class="p">):</span>
                <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Projects folder</span>
        <span class="n">projects_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projects_save_path_line_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">projects_folder</span><span class="p">):</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set_projects_save_path</span><span class="p">(</span><span class="n">projects_folder</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show_error_message</span><span class="p">(</span>
                <span class="s2">&quot;Invalid projects folder path&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;The projects folder path entered `</span><span class="si">{</span><span class="n">projects_folder</span><span class="si">}</span><span class="s2">` is &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;invalid.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># MRIFileManager.jar path</span>
        <span class="n">mri_conv_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mri_conv_path_line_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">mri_conv_path</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show_warning_message</span><span class="p">(</span>
                <span class="s2">&quot;Empty MRIFileManager.jar path&quot;</span><span class="p">,</span>
                <span class="s2">&quot;No path has been entered for MRIFileManager.jar.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set_mri_conv_path</span><span class="p">(</span><span class="n">mri_conv_path</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">mri_conv_path</span><span class="p">):</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set_mri_conv_path</span><span class="p">(</span><span class="n">mri_conv_path</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show_error_message</span><span class="p">(</span>
                <span class="s2">&quot;Invalid MRIFileManager.jar path&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;The MRIFileManager.jar path entered &#39;</span><span class="si">{</span><span class="n">mri_conv_path</span><span class="si">}</span><span class="s2">&#39; is &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;invalid.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Resources folder</span>
        <span class="n">resources_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources_path_line_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">resources_folder</span><span class="p">):</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set_resources_path</span><span class="p">(</span><span class="n">resources_folder</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show_error_message</span><span class="p">(</span>
                <span class="s2">&quot;Invalid resources folder path&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;The resources folder path entered &#39;</span><span class="si">{</span><span class="n">resources_folder</span><span class="si">}</span><span class="s2">&#39; is &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;invalid.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="PopUpPreferences.validate_spm_path">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.validate_spm_path">[docs]</a>
    <span class="k">def</span> <span class="nf">validate_spm_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates the SPM path and its compatibility with Matlab.</span>

<span class="sd">        This method checks whether the provided SPM and Matlab paths are</span>
<span class="sd">        valid. If they are already configured correctly, it enables SPM and</span>
<span class="sd">        Matlab usage without further checks. Otherwise, it attempts to run</span>
<span class="sd">        an SPM command via Matlab to confirm the setup.</span>

<span class="sd">        :param path (str): The file path to the SPM installation.</span>
<span class="sd">        :param config (Config): The configuration object where validated</span>
<span class="sd">                                paths and settings will be stored.</span>

<span class="sd">        :return (bool): True if the SPM path and Matlab path are valid,</span>
<span class="sd">                        False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">matlab_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matlab_choice</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;SPM&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">matlab_path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">matlab_path</span><span class="p">,</span> <span class="s2">&quot;Matlab&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">path</span> <span class="o">==</span> <span class="n">config</span><span class="o">.</span><span class="n">get_spm_path</span><span class="p">()</span>
            <span class="ow">and</span> <span class="n">matlab_path</span> <span class="o">==</span> <span class="n">config</span><span class="o">.</span><span class="n">get_matlab_path</span><span class="p">()</span>
        <span class="p">):</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="c1"># We don&#39;t test Matlab and SPM because it has already been</span>
            <span class="c1"># tested before</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">matlab_cmd</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;restoredefaultpath; &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;addpath(&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&#39;); &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;[name, ~]=spm(&#39;Ver&#39;); &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;exit&quot;</span>
                <span class="p">)</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">matlab_path</span><span class="p">,</span>
                        <span class="s2">&quot;-nodisplay&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;-nodesktop&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;-nosplash&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;-singleCompThread&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;-r&quot;</span><span class="p">,</span>
                        <span class="n">matlab_cmd</span><span class="p">,</span>
                    <span class="p">],</span>
                    <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">err</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span>

            <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">matlab_path</span><span class="p">,</span> <span class="s2">&quot;Matlab&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># Catch any other unexpected errors</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ Unexpected error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">matlab_path</span><span class="p">,</span> <span class="s2">&quot;Matlab&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="n">err</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_matlab_path</span><span class="p">(</span><span class="n">matlab_path</span><span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_spm_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>

            <span class="k">elif</span> <span class="s2">&quot;spm&quot;</span> <span class="ow">in</span> <span class="n">err</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;SPM&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">matlab_path</span><span class="p">,</span> <span class="s2">&quot;Matlab&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="PopUpPreferences.validate_spm_standalone_path">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.validate_spm_standalone_path">[docs]</a>
    <span class="k">def</span> <span class="nf">validate_spm_standalone_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates the SPM standalone path and its compatibility with</span>
<span class="sd">        Matlab standalone.</span>

<span class="sd">        This method checks whether the provided paths for SPM standalone</span>
<span class="sd">        and Matlab standalone (if applicable) are valid. It also verifies</span>
<span class="sd">        system architecture compatibility and attempts to execute SPM</span>
<span class="sd">        standalone to confirm its functionality.</span>

<span class="sd">        :param path (str): The file path to the SPM standalone installation.</span>
<span class="sd">        :param config (Config): The configuration object where validated</span>
<span class="sd">                                paths and settings will be stored.</span>

<span class="sd">        :return (bool): True if the SPM standalone and Matlab standalone</span>
<span class="sd">                        paths are valid, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">matlab_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matlab_standalone_choice</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="n">archi</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">architecture</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">matlab_path</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;Windows&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">archi</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">matlab_path</span><span class="p">,</span> <span class="s2">&quot;Matlab standalone&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">matlab_path</span> <span class="o">==</span> <span class="n">config</span><span class="o">.</span><span class="n">get_matlab_standalone_path</span><span class="p">())</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="n">path</span> <span class="o">==</span> <span class="n">config</span><span class="o">.</span><span class="n">get_spm_standalone_path</span><span class="p">()</span>
        <span class="p">):</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm_standalone</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">if</span> <span class="s2">&quot;Windows&quot;</span> <span class="ow">in</span> <span class="n">archi</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab_standalone</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>

            <span class="k">if</span> <span class="s2">&quot;Windows&quot;</span> <span class="ow">in</span> <span class="n">archi</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">mcr</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;spm*_win*.exe&quot;</span><span class="p">))</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">nb_bit_sys</span> <span class="o">=</span> <span class="n">archi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mcr_path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mcr</span><span class="p">):</span>
                    <span class="n">spm_path</span><span class="p">,</span> <span class="n">spm_file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">mcr_path</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">nb_bit_sys</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="n">spm_file_name</span><span class="p">:</span>
                        <span class="n">pos</span> <span class="o">=</span> <span class="n">i</span>

                <span class="k">if</span> <span class="n">pos</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;SPM standalone&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kc">False</span>

            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">matlab_path</span><span class="p">):</span>
                <span class="n">mcr</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;run_spm*.sh&quot;</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">mcr</span><span class="p">:</span>

                <span class="k">try</span><span class="p">:</span>

                    <span class="k">if</span> <span class="s2">&quot;Windows&quot;</span> <span class="ow">in</span> <span class="n">archi</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                            <span class="p">[</span><span class="n">mcr</span><span class="p">[</span><span class="n">pos</span><span class="p">],</span> <span class="s2">&quot;--version&quot;</span><span class="p">],</span>
                            <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="p">)</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                            <span class="p">[</span><span class="n">mcr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">matlab_path</span><span class="p">,</span> <span class="s2">&quot;--version&quot;</span><span class="p">],</span>
                            <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="p">)</span>

                    <span class="n">err</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span>
                    <span class="n">output</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span>

                <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;SPM standalone&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kc">False</span>

                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># Catch any other unexpected errors</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ Unexpected error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;SPM standalone&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kc">False</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">output</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">output</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;SPM8 &quot;</span><span class="p">):</span>
                    <span class="c1"># spm8 standalone doesn&#39;t accept --version but prints a</span>
                    <span class="c1"># message that we can interpret as saying that SPM8 is</span>
                    <span class="c1"># working anyway.</span>
                    <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm_standalone</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">config</span><span class="o">.</span><span class="n">set_spm_standalone_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
                    <span class="n">config</span><span class="o">.</span><span class="n">set_matlab_standalone_path</span><span class="p">(</span><span class="n">matlab_path</span><span class="p">)</span>

                    <span class="k">if</span> <span class="s2">&quot;Windows&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">archi</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab_standalone</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

                    <span class="k">return</span> <span class="kc">True</span>

                <span class="k">elif</span> <span class="p">(</span>
                    <span class="p">(</span><span class="n">err</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;version&quot;</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">:])</span>
                    <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;(standalone)&quot;</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">:])</span>
                <span class="p">):</span>
                    <span class="n">config</span><span class="o">.</span><span class="n">set_use_spm_standalone</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">config</span><span class="o">.</span><span class="n">set_spm_standalone_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
                    <span class="n">config</span><span class="o">.</span><span class="n">set_matlab_standalone_path</span><span class="p">(</span><span class="n">matlab_path</span><span class="p">)</span>

                    <span class="k">if</span> <span class="s2">&quot;Windows&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">archi</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">config</span><span class="o">.</span><span class="n">set_use_matlab_standalone</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="s2">&quot;The configuration for Matlab MCR and SPM &quot;</span>
                        <span class="s2">&quot;standalone as defined in Mia&#39;s preferences &quot;</span>
                        <span class="s2">&quot;seems to be valid, but the following issue has &quot;</span>
                        <span class="s2">&quot;been detected:&quot;</span>
                    <span class="p">)</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="s2">&quot;Please fix this issue to avoid a malfunction...&quot;</span>
                    <span class="p">)</span>
                    <span class="k">return</span> <span class="kc">True</span>

                <span class="k">elif</span> <span class="n">err</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>

                    <span class="k">if</span> <span class="s2">&quot;shared libraries&quot;</span> <span class="ow">in</span> <span class="n">err</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">matlab_path</span><span class="p">,</span> <span class="s2">&quot;Matlab standalone&quot;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="kc">False</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;SPM standalone&quot;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="kc">False</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;SPM standalone&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;SPM standalone&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="PopUpPreferences.validate_tool_path">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.validate_tool_path">[docs]</a>
    <span class="k">def</span> <span class="nf">validate_tool_path</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">config_name</span><span class="p">,</span> <span class="n">set_in_use</span><span class="p">,</span> <span class="n">set_path</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates the specified tool&#39;s path and checks its functionality.</span>

<span class="sd">        This method checks if the given tool path exists and verifies that</span>
<span class="sd">        the tool is functional by running a command to check its version.</span>
<span class="sd">        It also handles tool-specific setup for FreeSurfer and FSL by setting</span>
<span class="sd">        environment variables and adjusting paths as necessary.</span>

<span class="sd">        :param tool_name (str): The name of the tool to validate</span>
<span class="sd">                                (e.g., &quot;FreeSurfer&quot;, &quot;FSL&quot;, &quot;Matlab&quot;, etc.).</span>
<span class="sd">        :param path (str): The file path to the tool&#39;s installation directory.</span>
<span class="sd">        :param cmd (str): The command to execute within the tool&#39;s directory</span>
<span class="sd">                          to check its version.</span>
<span class="sd">        :param config (Config): The configuration object where validated</span>
<span class="sd">                                paths and settings will be stored.</span>
<span class="sd">        :param config_name (str): The name of the configuration setting for</span>
<span class="sd">                                  the tool.</span>
<span class="sd">        :param set_in_use (Callable): A function to set the tool&#39;s &quot;in use&quot;</span>
<span class="sd">                                     status in the configuration.</span>
<span class="sd">        :param set_path (Callable): A function to set the tool&#39;s path in the</span>
<span class="sd">                                   configuration.</span>

<span class="sd">        :return (bool): True if the tool&#39;s path is valid and functional,</span>
<span class="sd">                        False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">extra</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">option</span> <span class="o">=</span> <span class="s2">&quot;--version&quot;</span>

        <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;FreeSurfer&quot;</span><span class="p">,</span> <span class="s2">&quot;FSL&quot;</span><span class="p">]:</span>
            <span class="n">path_setup</span> <span class="o">=</span> <span class="n">path</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">extra</span> <span class="o">=</span> <span class="s2">&quot;bin&quot;</span>

            <span class="k">if</span> <span class="s2">&quot;FREESURFER_HOME&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;FREESURFER_HOME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>

            <span class="k">if</span> <span class="n">tool_name</span> <span class="o">==</span> <span class="s2">&quot;FSL&quot;</span><span class="p">:</span>
                <span class="n">option</span> <span class="o">=</span> <span class="s2">&quot;-version&quot;</span>

                <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;etc&quot;</span><span class="p">,</span> <span class="s2">&quot;fslconf&quot;</span><span class="p">)):</span>
                    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

                <span class="k">elif</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;etc&quot;</span><span class="p">):</span>
                    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;Matlab&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Matlab Standalone&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SPM&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SPM Standalone&quot;</span><span class="p">,</span>
        <span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">cmd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">extra</span><span class="p">,</span> <span class="n">cmd</span><span class="p">)</span> <span class="k">if</span> <span class="n">cmd</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">cmd</span><span class="p">:</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">cmd</span><span class="p">,</span> <span class="n">option</span><span class="p">],</span>
                    <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">err</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stderr</span>

            <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="s2">&quot;config file&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># Catch any other unexpected errors</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ Unexpected error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="c1"># Filter out lines containing &#39;warning&#39; (case-insensitive)</span>
            <span class="n">filtered_lines</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">line</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">err</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="s2">&quot;warning&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="p">]</span>
            <span class="c1"># If no lines left after filtering, set err to an empty string</span>
            <span class="n">err</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filtered_lines</span><span class="p">)</span> <span class="k">if</span> <span class="n">filtered_lines</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

            <span class="k">if</span> <span class="n">err</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;FreeSurfer&quot;</span><span class="p">,</span> <span class="s2">&quot;FSL&quot;</span><span class="p">]:</span>
                    <span class="n">set_path</span><span class="p">(</span><span class="n">path_setup</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">set_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

                <span class="n">set_in_use</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wrong_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">tool_name</span> <span class="o">==</span> <span class="s2">&quot;Matlab&quot;</span><span class="p">:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_matlab_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">elif</span> <span class="n">tool_name</span> <span class="o">==</span> <span class="s2">&quot;SPM&quot;</span><span class="p">:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_spm_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">elif</span> <span class="n">tool_name</span> <span class="o">==</span> <span class="s2">&quot;Matlab Standalone&quot;</span><span class="p">:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_matlab_standalone_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">elif</span> <span class="n">tool_name</span> <span class="o">==</span> <span class="s2">&quot;SPM Standalone&quot;</span><span class="p">:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">validate_spm_standalone_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="PopUpPreferences.wrong_path">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpPreferences.wrong_path">[docs]</a>
    <span class="k">def</span> <span class="nf">wrong_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">tool</span><span class="p">,</span> <span class="n">extra_mess</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Displays an error message for an invalid tool path.</span>

<span class="sd">        This method restores the cursor, clears the status label,</span>
<span class="sd">        and shows a QMessageBox with an error message indicating</span>
<span class="sd">        that the provided path for a specified tool is invalid.</span>

<span class="sd">        :param path (str): The invalid path entered by the user.</span>
<span class="sd">        :param tool (str): The name of the tool for which the path is</span>
<span class="sd">                           being validated.</span>
<span class="sd">        :param extra_mess (str, optional): Additional context for the</span>
<span class="sd">                                           error message, such as specifying</span>
<span class="sd">                                           a configuration file.</span>

<span class="sd">        :return (None): This function does not return anything.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Critical</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid </span><span class="si">{</span><span class="n">tool</span><span class="si">}</span><span class="s2"> path&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">extra_mess</span><span class="p">:</span>
            <span class="n">extra_mess</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">extra_mess</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setInformativeText</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The </span><span class="si">{</span><span class="n">tool</span><span class="si">}{</span><span class="n">extra_mess</span><span class="si">}</span><span class="s2"> path entered </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2"> is invalid.&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">buttonClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PopUpProperties">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpProperties">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpProperties</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog for modifying project properties.</span>

<span class="sd">    Allows users to change project settings, including visualized tags</span>
<span class="sd">    and information.</span>
<span class="sd">    Is called when the user wants to change the current project&#39;s</span>
<span class="sd">    properties (File &gt; properties).</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - ok_clicked: saves the modifications and updates the data browser</span>

<span class="sd">    .. Signals:</span>
<span class="sd">        - signal_settings_change: Qt signal emitted when project settings are</span>
<span class="sd">                                  modified.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Signal that will be emitted at the end to tell that the project has</span>
    <span class="c1"># been created</span>
    <span class="n">signal_settings_change</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>

<div class="viewcode-block" id="PopUpProperties.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpProperties.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">databrowser</span><span class="p">,</span> <span class="n">old_tags</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the project properties dialog.</span>

<span class="sd">        :param project: current project in the software</span>
<span class="sd">        :param databrowser: data browser instance of the software</span>
<span class="sd">        :param old_tags: visualized tags before opening this dialog</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># Dialog setup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setModal</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span> <span class="o">=</span> <span class="n">databrowser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">old_tags</span> <span class="o">=</span> <span class="n">old_tags</span>
        <span class="n">_translate</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">translate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;Dialog&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;project properties&quot;</span><span class="p">)</span>
        <span class="c1"># Create tab widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_widget</span> <span class="o">=</span> <span class="n">QTabWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_widget</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># The &#39;Visualized tags&quot; tab</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tab_tags</span> <span class="o">=</span> <span class="n">PopUpVisualizedTags</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_shown_tags</span><span class="p">()</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tab_tags</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;tab_tags&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_widget</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tab_tags</span><span class="p">,</span> <span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Dialog&quot;</span><span class="p">,</span> <span class="s2">&quot;Visualized tags&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># The &#39;Informations&quot; tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_infos</span> <span class="o">=</span> <span class="n">PopUpInformation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_infos</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;tab_infos&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_widget</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tab_infos</span><span class="p">,</span> <span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Dialog&quot;</span><span class="p">,</span> <span class="s2">&quot;Information&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># Create buttons</span>
        <span class="c1"># The &#39;OK&#39; push button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_ok&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ok_clicked</span><span class="p">)</span>
        <span class="c1"># The &#39;Cancel&#39; push button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Cancel&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_cancel&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="c1"># Layout setup</span>
        <span class="n">hbox_buttons</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="p">)</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="p">)</span>
        <span class="n">vbox</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_widget</span><span class="p">)</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">hbox_buttons</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">vbox</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpProperties.ok_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpProperties.ok_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">ok_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves the modifications and updates the data browser.&quot;&quot;&quot;</span>
        <span class="c1"># Prepare history tracking</span>
        <span class="n">history_maker</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;modified_visibilities&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">old_tags</span><span class="p">]</span>
        <span class="c1"># Collect newly selected tags</span>
        <span class="n">new_visibilities</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tab_tags</span><span class="o">.</span><span class="n">list_widget_selected_tags</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_tags</span><span class="o">.</span><span class="n">list_widget_selected_tags</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
        <span class="p">]</span>
        <span class="n">new_visibilities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TAG_FILENAME</span><span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">write</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
            <span class="n">database_data</span><span class="o">.</span><span class="n">set_shown_tags</span><span class="p">(</span><span class="n">new_visibilities</span><span class="p">)</span>

        <span class="n">history_maker</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_visibilities</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">undos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">history_maker</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">redos</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">unsavedModifications</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Update data browser columns</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span><span class="o">.</span><span class="n">table_data</span><span class="o">.</span><span class="n">update_visualized_columns</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">old_tags</span><span class="p">,</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_shown_tags</span><span class="p">()</span>
            <span class="p">)</span>

        <span class="c1"># Close dialog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PopUpQuit">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpQuit">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpQuit</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">     Dialog to handle unsaved project modifications when closing the software.</span>

<span class="sd">    Provides options to save, discard, or cancel the exit process.</span>
<span class="sd">    Is called when the user closes the software and the current project has</span>
<span class="sd">    been modified.</span>

<span class="sd">    .. Signals:</span>
<span class="sd">        - save_as_signal: Signal emitted when user chooses to save the</span>
<span class="sd">                          project.</span>
<span class="sd">        - do_not_save_signal: Signal emitted when user chooses to exit</span>
<span class="sd">                              without saving.</span>
<span class="sd">        - cancel_signal: Signal emitted when user cancels the exit process.</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - can_exit: returns the value of _bool_exit</span>
<span class="sd">        - cancel_clicked: makes the actions to cancel the action</span>
<span class="sd">        - do_not_save_clicked: makes the actions not to save the project</span>
<span class="sd">        - save_as_clicked: makes the actions to save the project</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">save_as_signal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>
    <span class="n">do_not_save_signal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>
    <span class="n">cancel_signal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>

<div class="viewcode-block" id="PopUpQuit.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpQuit.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         Initialize the quit confirmation dialog.</span>

<span class="sd">        :param project: Current project with unsaved modifications.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bool_exit</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Confirm exit&quot;</span><span class="p">)</span>
        <span class="c1"># Create confirmation label</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Do you want to exit without saving </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span><span class="si">}</span><span class="s2">?&quot;</span>
        <span class="p">)</span>
        <span class="c1"># Create action buttons</span>
        <span class="n">push_button_save_as</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Save&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">push_button_do_not_save</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Do not save&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">push_button_cancel</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Cancel&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="c1"># Button connections</span>
        <span class="n">push_button_save_as</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_as_clicked</span><span class="p">)</span>
        <span class="n">push_button_do_not_save</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">do_not_save_clicked</span><span class="p">)</span>
        <span class="n">push_button_cancel</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cancel_clicked</span><span class="p">)</span>
        <span class="c1"># Create horizontal layout for buttons</span>
        <span class="n">hbox</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">push_button_save_as</span><span class="p">)</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">push_button_do_not_save</span><span class="p">)</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">push_button_cancel</span><span class="p">)</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># Create vertical layout</span>
        <span class="n">vbox</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">hbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">vbox</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpQuit.can_exit">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpQuit.can_exit">[docs]</a>
    <span class="k">def</span> <span class="nf">can_exit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if the application can exit.</span>

<span class="sd">        :return (bool): True if  exit is allowed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bool_exit</span></div>


<div class="viewcode-block" id="PopUpQuit.cancel_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpQuit.cancel_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">cancel_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle cancel action by preventing exit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bool_exit</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancel_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpQuit.do_not_save_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpQuit.do_not_save_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">do_not_save_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle &#39;do not save&#39; action by allowing exit without saving.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bool_exit</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">do_not_save_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpQuit.save_as_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpQuit.save_as_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">save_as_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle save action by emitting save signal and allowing exit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_as_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bool_exit</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PopUpRemoveScan">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpRemoveScan">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpRemoveScan</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog to confirm removal of a scan previously sent to the pipeline</span>
<span class="sd">    manager.</span>

<span class="sd">    Provides options to remove or keep a scan, with additional &#39;apply to all&#39;</span>
<span class="sd">    functionality when multiple scans are involved.</span>
<span class="sd">    Is called when the user wants to remove a scan that was previously sent</span>
<span class="sd">    to the pipeline manager.</span>

<span class="sd">     .. Methods:</span>
<span class="sd">         - cancel_clicked:</span>
<span class="sd">         - no_all_clicked:</span>
<span class="sd">         - yes_all_clicked:</span>
<span class="sd">         - yes_clicked:</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PopUpRemoveScan.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpRemoveScan.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the remove scan confirmation dialog.</span>

<span class="sd">        :param scan: Identifier of the scan to be potentially removed.</span>
<span class="sd">        :param size: Total number of scans in the removal process.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Document exists in Pipeline Manager&quot;</span><span class="p">)</span>
        <span class="c1"># Flags to control removal behavior</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repeat</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Create confirmation message</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The document </span><span class="si">{</span><span class="n">scan</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">was previously sent to the pipeline &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;manager, do you really want to delete it?&quot;</span>
        <span class="p">)</span>
        <span class="c1"># Create buttons</span>
        <span class="n">push_button_yes</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Ok&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">push_button_cancel</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;No&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="c1"># Setup layout</span>
        <span class="n">hbox</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">push_button_yes</span><span class="p">)</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">push_button_cancel</span><span class="p">)</span>

        <span class="c1"># Add &#39;apply to all&#39; buttons if multiple scans</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">push_button_yes_all</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Ok to all&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="n">push_button_no_all</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;No to all&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">push_button_yes_all</span><span class="p">)</span>
            <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">push_button_no_all</span><span class="p">)</span>
            <span class="n">push_button_yes_all</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yes_all_clicked</span><span class="p">)</span>
            <span class="n">push_button_no_all</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no_all_clicked</span><span class="p">)</span>

        <span class="n">hbox</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># Create main layout</span>
        <span class="n">vbox</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">hbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">vbox</span><span class="p">)</span>
        <span class="c1"># Connect standard buttons</span>
        <span class="n">push_button_yes</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yes_clicked</span><span class="p">)</span>
        <span class="n">push_button_cancel</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cancel_clicked</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpRemoveScan.cancel_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpRemoveScan.cancel_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">cancel_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle &#39;Cancel&#39; action.</span>

<span class="sd">        Sets stop flag to True and indicates no global action.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repeat</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpRemoveScan.no_all_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpRemoveScan.no_all_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">no_all_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle &#39;No to All&#39; action.</span>

<span class="sd">        Sets stop flag to True and indicates a global &#39;No&#39; action.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repeat</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpRemoveScan.yes_all_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpRemoveScan.yes_all_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">yes_all_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle &#39;Yes to All&#39; action.</span>

<span class="sd">        Clears stop flag and indicates a global &#39;Yes&#39; action.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repeat</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpRemoveScan.yes_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpRemoveScan.yes_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">yes_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle &#39;Yes&#39; action.</span>

<span class="sd">        Clears both stop and repeat flags for a single item removal.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repeat</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PopUpRemoveTag">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpRemoveTag">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpRemoveTag</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog for removing user-defined tags from a Populse MIA project.</span>

<span class="sd">    Allows users to select and remove custom tags from the project&#39;s database.</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - ok_action: Verifies the selected tags and send the information to</span>
<span class="sd">                     the data browser.</span>
<span class="sd">        - search_str: Matches the searched pattern with the tags of the</span>
<span class="sd">                      project.</span>

<span class="sd">    .. Signals:</span>
<span class="sd">        - signal_remove_tag: Qt signal emitted when tags are removed.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Signal that will be emitted at the end to tell that</span>
    <span class="c1"># the project has been created</span>
    <span class="n">signal_remove_tag</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>

<div class="viewcode-block" id="PopUpRemoveTag.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpRemoveTag.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">databrowser</span><span class="p">,</span> <span class="n">project</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the remove tag dialog.</span>

<span class="sd">        :param databrowser: Data browser instance managing project data.</span>
<span class="sd">        :param project: Current project containing tags to be removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span> <span class="o">=</span> <span class="n">databrowser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Remove a tag&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setModal</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_translate</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">translate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;Remove a tag&quot;</span><span class="p">)</span>

        <span class="c1"># The &#39;OK&#39; push button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;push_button_ok&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Remove a tag&quot;</span><span class="p">,</span> <span class="s2">&quot;OK&quot;</span><span class="p">))</span>
        <span class="c1"># The &quot;Tag list&quot; label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_tag_list</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_tag_list</span><span class="o">.</span><span class="n">setTextFormat</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AutoText</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_tag_list</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_tag_list&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_tag_list</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Remove a tag&quot;</span><span class="p">,</span> <span class="s2">&quot;Available tags:&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># Search bar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;lineEdit_search_bar&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s2">&quot;Search&quot;</span><span class="p">)</span>
        <span class="c1"># Tag list widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span> <span class="o">=</span> <span class="n">QListWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;listWidget_tags&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">setSelectionMode</span><span class="p">(</span>
            <span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">MultiSelection</span>
        <span class="p">)</span>
        <span class="c1"># Layout setup</span>
        <span class="n">hbox_buttons</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="p">)</span>
        <span class="n">hbox_top</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">hbox_top</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_tag_list</span><span class="p">)</span>
        <span class="n">hbox_top</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">hbox_top</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span><span class="p">)</span>
        <span class="n">vbox</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">hbox_top</span><span class="p">)</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="p">)</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">hbox_buttons</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">vbox</span><span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
            <span class="n">user_tags</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">tag</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_field_attributes</span><span class="p">(</span>
                    <span class="n">COLLECTION_CURRENT</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">tag</span><span class="p">[</span><span class="s2">&quot;origin&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">TAG_ORIGIN_USER</span>
            <span class="p">]</span>

        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">user_tags</span><span class="p">:</span>
            <span class="n">QListWidgetItem</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Dialog&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span>
            <span class="p">)</span>

        <span class="c1"># Connect signals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ok_action</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_str</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpRemoveTag.ok_action">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpRemoveTag.ok_action">[docs]</a>
    <span class="k">def</span> <span class="nf">ok_action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Process selected tags for removal and update the data browser.</span>

<span class="sd">        Retrieves selected tags and passes them to the data browser for</span>
<span class="sd">        removal.</span>
<span class="sd">        Closes the dialog after processing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="c1"># Collect selected tag names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tag_names_to_remove</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">selectedItems</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="c1"># Remove selected tags</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span><span class="o">.</span><span class="n">remove_tag_infos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tag_names_to_remove</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpRemoveTag.search_str">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpRemoveTag.search_str">[docs]</a>
    <span class="k">def</span> <span class="nf">search_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search_pattern</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter tags based on search pattern.</span>

<span class="sd">        :param search_pattern: String to match against tag names.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
            <span class="n">field_attributes</span> <span class="o">=</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_field_attributes</span><span class="p">(</span>
                <span class="n">COLLECTION_CURRENT</span>
            <span class="p">)</span>

        <span class="c1"># Filter tags based on search pattern</span>
        <span class="n">matching_tags</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">tag</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">field_attributes</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">tag</span><span class="p">[</span><span class="s2">&quot;origin&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">TAG_ORIGIN_USER</span>
                <span class="ow">and</span> <span class="p">(</span>
                    <span class="ow">not</span> <span class="n">search_pattern</span>
                    <span class="ow">or</span> <span class="n">search_pattern</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
                    <span class="ow">in</span> <span class="n">tag</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">]</span>
        <span class="c1"># Update list widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">matching_tags</span><span class="p">:</span>
            <span class="n">QListWidgetItem</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;Dialog&quot;</span><span class="p">,</span> <span class="n">tag</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span>
            <span class="p">)</span></div>
</div>



<div class="viewcode-block" id="PopUpSaveProjectAs">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSaveProjectAs">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpSaveProjectAs</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog for saving a project under a new name.</span>

<span class="sd">    Provides a user interface to select and save a project with a new name,</span>
<span class="sd">    with options to browse existing projects and validate the new project</span>
<span class="sd">    name.</span>

<span class="sd">    .. Method:</span>
<span class="sd">        - fill_input: Fills the input field when a project is clicked on</span>
<span class="sd">        - return_value: Sets the widget&#39;s attributes depending on the</span>
<span class="sd">          selected file name</span>

<span class="sd">    .. Signals:</span>
<span class="sd">        - signal_saved_project: Qt signal emitted when a new project name</span>
<span class="sd">                                is selected.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Signal that will be emitted at the end to tell</span>
    <span class="c1"># that the new file name has been chosen</span>
    <span class="n">signal_saved_project</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>

<div class="viewcode-block" id="PopUpSaveProjectAs.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSaveProjectAs.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the save project as dialog.</span>

<span class="sd">        Sets up the user interface with a scrollable list of existing</span>
<span class="sd">        projects, input field for new project name, and save/cancel buttons.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Save project as&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Configuration and path setup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get_projects_save_path</span><span class="p">()</span>
        <span class="c1"># Project name input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_project</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_project_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;New project name&quot;</span><span class="p">)</span>
        <span class="c1"># Projects list setup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_box</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">project_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">proj</span>
                <span class="k">for</span> <span class="n">proj</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_path</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project_path</span><span class="p">,</span> <span class="n">proj</span><span class="p">))</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">project_name</span> <span class="ow">in</span> <span class="n">project_list</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel_clickable</span><span class="p">(</span><span class="n">project_name</span><span class="p">)</span>
            <span class="n">label</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_input</span><span class="p">,</span> <span class="n">project_name</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

        <span class="c1"># Scroll area for projects list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span> <span class="o">=</span> <span class="n">QScrollArea</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">setVerticalScrollBarPolicy</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ScrollBarAlwaysOn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="p">)</span>
        <span class="c1"># Wrap projects list in a widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">)</span>
        <span class="c1"># Create input layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_text</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_text</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">new_project_label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_text</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">new_project</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_bottom</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_bottom</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># Save button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Save as&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_ok&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">return_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_bottom</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="p">)</span>
        <span class="c1"># Cancel button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Cancel&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_cancel&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_bottom</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="p">)</span>
        <span class="c1"># Final layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Projects list:&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_box_text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_box_bottom</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_layout</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpSaveProjectAs.fill_input">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSaveProjectAs.fill_input">[docs]</a>
    <span class="k">def</span> <span class="nf">fill_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fill the project name input field with the selected project name.</span>

<span class="sd">        :param name: Name of the project to fill in the input field.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_project</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpSaveProjectAs.return_value">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSaveProjectAs.return_value">[docs]</a>
    <span class="k">def</span> <span class="nf">return_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate and process the selected project name.</span>

<span class="sd">        Checks project name validity, handles potential naming conflicts,</span>
<span class="sd">        and emits a signal when a valid project name is selected.</span>

<span class="sd">        :return (str): Full path of the new project if successful,</span>
<span class="sd">                       None otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># import message_already_exists only here to prevent circular</span>
        <span class="c1"># import issue</span>
        <span class="kn">from</span> <span class="nn">populse_mia.utils</span> <span class="kn">import</span> <span class="n">message_already_exists</span>

        <span class="n">file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_project</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_name</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">projects_folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_path</span>
        <span class="n">entire_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">projects_folder</span><span class="p">,</span> <span class="n">file_name</span><span class="p">))</span>
        <span class="c1"># Set path attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">entire_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_path</span> <span class="o">=</span> <span class="n">entire_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relative_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">entire_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relative_subpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># Handle project name conflicts</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relative_path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">signal_saved_project</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validate</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">entire_path</span>

        <span class="c1"># Project already exists - handle based on user mode</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get_user_mode</span><span class="p">():</span>
            <span class="n">message_already_exists</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Confirm project overwrite</span>
        <span class="n">msgtext</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Do you really want to overwrite the </span><span class="si">{</span><span class="n">file_name</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;project?</span><span class="se">\n</span><span class="s2">This action will delete all contents &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;inside this folder!&quot;</span>
        <span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
        <span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
        <span class="n">reply</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">question</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;populse_mia - Warning: Overwriting project&quot;</span><span class="p">,</span>
            <span class="n">msgtext</span><span class="p">,</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">reply</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validate</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">entire_path</span>

        <span class="k">return</span> <span class="kc">None</span></div>
</div>



<div class="viewcode-block" id="PopUpSeeAllProjects">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSeeAllProjects">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpSeeAllProjects</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A dialog window for displaying and managing saved projects.</span>

<span class="sd">    This dialog allows users to view a list of saved projects,</span>
<span class="sd">    check their existence, and open a selected project.</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - checkState: Checks if the project still exists and returns the</span>
<span class="sd">                      corresponding icon</span>
<span class="sd">        - item_to_path: Returns the path of the first selected item</span>
<span class="sd">        - open_project: Switches to the selected project</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PopUpSeeAllProjects.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSeeAllProjects.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">saved_projects</span><span class="p">,</span> <span class="n">main_window</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the PopUpSeeAllProjects dialog.</span>

<span class="sd">        :param saved_projects: Container with a list of project paths.</span>
<span class="sd">        :param main_window: Main window.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span> <span class="o">=</span> <span class="n">main_window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;See all saved projects&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
        <span class="c1"># Create and configure widgets</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;List of Saved Projects&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeWidget</span> <span class="o">=</span> <span class="n">QTreeWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeWidget</span><span class="o">.</span><span class="n">setColumnCount</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeWidget</span><span class="o">.</span><span class="n">setHeaderLabels</span><span class="p">([</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Path&quot;</span><span class="p">,</span> <span class="s2">&quot;State&quot;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">saved_projects</span><span class="o">.</span><span class="n">pathsList</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">QTreeWidgetItem</span><span class="p">()</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkState</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeWidget</span><span class="o">.</span><span class="n">addTopLevelItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeWidget</span><span class="o">.</span><span class="n">header</span><span class="p">()</span>
        <span class="n">header</span><span class="o">.</span><span class="n">setSectionResizeMode</span><span class="p">(</span><span class="n">QHeaderView</span><span class="o">.</span><span class="n">ResizeToContents</span><span class="p">)</span>
        <span class="c1"># Create buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButtonOpenProject</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Open project&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButtonOpenProject</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_ok&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButtonOpenProject</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_project</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButtonCancel</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Cancel&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButtonCancel</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_cancel&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButtonCancel</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="c1"># Button layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hBoxButtons</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hBoxButtons</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hBoxButtons</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pushButtonOpenProject</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hBoxButtons</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pushButtonCancel</span><span class="p">)</span>
        <span class="c1"># Main vertical layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vBox</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vBox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vBox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">treeWidget</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vBox</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hBoxButtons</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vBox</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpSeeAllProjects.checkState">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSeeAllProjects.checkState">[docs]</a>
    <span class="k">def</span> <span class="nf">checkState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine the icon based on project existence.</span>

<span class="sd">        :param path (str): Path to the project directory.</span>

<span class="sd">        :return: QIcon: Green checkmark if project exists, red cross if not.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sources_images_dir</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span><span class="o">.</span><span class="n">getSourceImageDir</span><span class="p">()</span>
        <span class="n">icon_name</span> <span class="o">=</span> <span class="s2">&quot;green_v.png&quot;</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;red_cross.png&quot;</span>
        <span class="k">return</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sources_images_dir</span><span class="p">,</span> <span class="n">icon_name</span><span class="p">))</span></div>


<div class="viewcode-block" id="PopUpSeeAllProjects.item_to_path">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSeeAllProjects.item_to_path">[docs]</a>
    <span class="k">def</span> <span class="nf">item_to_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the path of the first selected item.</span>

<span class="sd">        :return (str): Absolute path of the selected project, or empty string</span>
<span class="sd">                       if no selection.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selected_items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeWidget</span><span class="o">.</span><span class="n">selectedItems</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">selected_items</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
            <span class="n">msg</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
            <span class="n">msg</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Please select a project to open&quot;</span><span class="p">)</span>
            <span class="n">msg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Warning&quot;</span><span class="p">)</span>
            <span class="n">msg</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="n">msg</span><span class="o">.</span><span class="n">buttonClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
            <span class="n">msg</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>

        <span class="k">return</span> <span class="n">selected_items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpSeeAllProjects.open_project">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSeeAllProjects.open_project">[docs]</a>
    <span class="k">def</span> <span class="nf">open_project</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Attempt to switch to the selected project.</span>

<span class="sd">        Opens the selected project in the main window if a valid project</span>
<span class="sd">        is chosen. Closes the dialog upon successful project switch.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_to_path</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">file_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">file_name</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">relative_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">switch_project</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relative_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PopUpSelectFilter">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSelectFilter">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpSelectFilter</span><span class="p">(</span><span class="n">PopUpFilterSelection</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Popup window for selecting and opening a previously saved filter.</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - ok_clicked: Saves the modifications and updates the data browser.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PopUpSelectFilter.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSelectFilter.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">databrowser</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the PopUpSelectFilter dialog</span>

<span class="sd">        :param project (Project): The current project instance.</span>
<span class="sd">        :param databrowser (DataBrowser): The data browser instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">project</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span> <span class="o">=</span> <span class="n">databrowser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Open a filter&quot;</span><span class="p">)</span>

        <span class="c1"># Populate the filter list</span>
        <span class="k">for</span> <span class="n">filter_obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">filters</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">QListWidgetItem</span><span class="p">(</span><span class="n">filter_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_filters</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpSelectFilter.ok_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSelectFilter.ok_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">ok_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves the selected filter as the current filter and updates the</span>
<span class="sd">        data browser.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selected_items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_filters</span><span class="o">.</span><span class="n">selectedItems</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">selected_items</span><span class="p">:</span>
            <span class="n">filter_name</span> <span class="o">=</span> <span class="n">selected_items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">setCurrentFilter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">getFilter</span><span class="p">(</span><span class="n">filter_name</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span><span class="o">.</span><span class="n">open_filter_infos</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PopUpSelectIteration">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSelectIteration">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpSelectIteration</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Dialog for selecting values to iterate over when running an</span>
<span class="sd">    iterated pipeline.</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - ok_clicked: Stores selected values and closes the dialog.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PopUpSelectIteration.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSelectIteration.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iterated_tag</span><span class="p">,</span> <span class="n">tag_values</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the selection popup.</span>

<span class="sd">        :param iterated_tag (str): The name of the tag being iterated.</span>
<span class="sd">        :param tag_values (list[str]): The possible values for the</span>
<span class="sd">                                       iterated tag.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iterated_tag</span> <span class="o">=</span> <span class="n">iterated_tag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tag_values</span> <span class="o">=</span> <span class="n">tag_values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Iterate pipeline run over tag </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">iterated_tag</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_box</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Select values to iterate over:&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_boxes</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">tag_value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag_values</span><span class="p">:</span>
            <span class="n">check_box</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="n">tag_value</span><span class="p">)</span>
            <span class="n">check_box</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_boxes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">check_box</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v_box</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">check_box</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_bottom</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_bottom</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># The &#39;OK&#39; push button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_ok&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ok_clicked</span><span class="p">)</span>
        <span class="c1"># The &#39;Cancel&#39; push button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Cancel&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;pushButton_cancel&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_bottom</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_box_bottom</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span> <span class="o">=</span> <span class="n">QScrollArea</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scroll</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_box_bottom</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_layout</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpSelectIteration.ok_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSelectIteration.ok_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">ok_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stores selected values and closes the dialog.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">final_values</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="k">for</span> <span class="n">cb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_boxes</span> <span class="k">if</span> <span class="n">cb</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PopUpTagSelection">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpTagSelection">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpTagSelection</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A dialog for selecting and filtering tags in a data browser.</span>

<span class="sd">    This class provides a user interface for:</span>
<span class="sd">    - Displaying available tags</span>
<span class="sd">    - Searching through tags</span>
<span class="sd">    - Selecting a single tag</span>

<span class="sd">    Is called when the user wants to update the tags that are visualized in</span>
<span class="sd">       the data browser.</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - _create_button: Create a standard button with text and click handler</span>
<span class="sd">        - _setup_ui: Set up the user interface components</span>
<span class="sd">        - cancel_clicked: closes the pop-up</span>
<span class="sd">        - item_clicked: checks the checkbox of an item when the latter</span>
<span class="sd">                        is clicked</span>
<span class="sd">        - ok_clicked: actions when the &quot;OK&quot; button is clicked</span>
<span class="sd">        - search_str: matches the searched pattern with the tags of the</span>
<span class="sd">                      project</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PopUpTagSelection.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpTagSelection.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the tag selection dialog.</span>

<span class="sd">        :param project: The current project containing the database</span>
<span class="sd">                        with available tags</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
        <span class="n">_translate</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">translate</span>
        <span class="c1"># Create UI components</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_ui</span><span class="p">(</span><span class="n">_translate</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_setup_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_translate</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set up the user interface components.</span>

<span class="sd">        :param_translate (callable): Localization translation function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># The &quot;Tag list&quot; label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_tag_list</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_tag_list</span><span class="o">.</span><span class="n">setTextFormat</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AutoText</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_tag_list</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;label_tag_list&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_tag_list</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
            <span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;main_window&quot;</span><span class="p">,</span> <span class="s2">&quot;Available tags:&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># The search bar to search in the list of tags</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;lineEdit_search_bar&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s2">&quot;Search&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_str</span><span class="p">)</span>
        <span class="c1"># The list of tags</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span> <span class="o">=</span> <span class="n">QListWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;listWidget_tags&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">setSelectionMode</span><span class="p">(</span>
            <span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">SingleSelection</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">itemClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item_clicked</span><span class="p">)</span>
        <span class="c1"># OK and Cancel buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_button</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ok_clicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_button</span><span class="p">(</span>
            <span class="s2">&quot;Cancel&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cancel_clicked</span>
        <span class="p">)</span>
        <span class="c1"># Top layout with label and search bar</span>
        <span class="n">hbox_top_left</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">hbox_top_left</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_tag_list</span><span class="p">)</span>
        <span class="n">hbox_top_left</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span><span class="p">)</span>
        <span class="c1"># Vertical layout for top section</span>
        <span class="n">vbox_top_left</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">vbox_top_left</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">hbox_top_left</span><span class="p">)</span>
        <span class="n">vbox_top_left</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="p">)</span>
        <span class="c1"># Buttons layout</span>
        <span class="n">hbox_buttons</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_ok</span><span class="p">)</span>
        <span class="n">hbox_buttons</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_cancel</span><span class="p">)</span>
        <span class="c1"># Final vertical layout</span>
        <span class="n">vbox_final</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">vbox_final</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">vbox_top_left</span><span class="p">)</span>
        <span class="n">vbox_final</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">hbox_buttons</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">vbox_final</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">clicked_handler</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a standard button with text and click handler.</span>

<span class="sd">        :param text (str): Button text</span>
<span class="sd">        :param clicked_handler (callable): Function to call when button</span>
<span class="sd">                                           is clicked</span>

<span class="sd">        :return (QPushButton): Configured button</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">button</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pushButton_</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">clicked_handler</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">button</span>

<div class="viewcode-block" id="PopUpTagSelection.cancel_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpTagSelection.cancel_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">cancel_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Close the dialog without selecting a tag.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpTagSelection.item_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpTagSelection.item_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">item_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle item selection by checking/unchecking tags.</span>

<span class="sd">        :param (QListWidgetItem): The clicked list item</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">count</span><span class="p">()):</span>
            <span class="n">itm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
            <span class="n">itm</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span> <span class="k">if</span> <span class="n">itm</span> <span class="o">==</span> <span class="n">item</span> <span class="k">else</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Unchecked</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="PopUpTagSelection.ok_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpTagSelection.ok_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">ok_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Placeholder method to be overridden by subclasses.</span>

<span class="sd">        Defines actions to take when the OK button is clicked.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Has to be override in the PopUpSelectTag* classes</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="PopUpTagSelection.search_str">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpTagSelection.search_str">[docs]</a>
    <span class="k">def</span> <span class="nf">search_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">str_search</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter tags based on search term.</span>


<span class="sd">        :param str_search (str): Text to search for in tag names</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
            <span class="n">field_names</span> <span class="o">=</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_field_names</span><span class="p">(</span><span class="n">COLLECTION_CURRENT</span><span class="p">)</span>

        <span class="c1"># Filter tags based on search term</span>
        <span class="n">filtered_tags</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">tag</span>
            <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">field_names</span>
            <span class="k">if</span> <span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">TAG_CHECKSUM</span><span class="p">,</span> <span class="n">COLLECTION_HISTORY</span><span class="p">]</span>
            <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">str_search</span> <span class="ow">or</span> <span class="n">str_search</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="n">tag</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
        <span class="p">]</span>

        <span class="c1"># Update visibility of list items</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">count</span><span class="p">()):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setHidden</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">filtered_tags</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="PopUpSelectTag">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSelectTag">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpSelectTag</span><span class="p">(</span><span class="n">PopUpTagSelection</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A dialog for selecting and updating the thumbnail tag in the mini viewer.</span>

<span class="sd">    This class allows users to choose which tag will be displayed as the</span>
<span class="sd">    thumbnail in the application&#39;s mini viewer. It presents a list of</span>
<span class="sd">    available tags and allows selecting a single tag to be used as the</span>
<span class="sd">    thumbnail.</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - _populate_tag_list: Populate the list widget with tags from</span>
<span class="sd">                              the database.</span>
<span class="sd">        - ok_clicked: saves the modifications and updates the mini viewer</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PopUpSelectTag.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSelectTag.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the tag selection dialog.</span>

<span class="sd">        :param project: The current project in the software context.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">project</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate_tag_list</span><span class="p">(</span>
                <span class="n">database_data</span><span class="o">.</span><span class="n">get_field_names</span><span class="p">(</span><span class="n">COLLECTION_CURRENT</span><span class="p">)</span>
            <span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_populate_tag_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_names</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Populate the list widget with tags from the database.</span>

<span class="sd">        :param field_names (list): List of available field names/tags.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Filter out special tags and create checkable list items</span>
        <span class="n">filtered_tags</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">tag</span>
            <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">field_names</span>
            <span class="k">if</span> <span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="n">TAG_CHECKSUM</span><span class="p">,</span> <span class="n">TAG_HISTORY</span><span class="p">}</span>
        <span class="p">]</span>
        <span class="n">current_thumbnail_tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getThumbnailTag</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">filtered_tags</span><span class="p">):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">QListWidgetItem</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">|</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsUserCheckable</span><span class="p">)</span>

            <span class="c1"># Set initial check state based on current thumbnail tag</span>
            <span class="n">check_state</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span>
                <span class="k">if</span> <span class="n">tag</span> <span class="o">==</span> <span class="n">current_thumbnail_tag</span>
                <span class="k">else</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Unchecked</span>
            <span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">check_state</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">sortItems</span><span class="p">()</span>

<div class="viewcode-block" id="PopUpSelectTag.ok_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSelectTag.ok_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">ok_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the selected tag and update the mini viewer.</span>

<span class="sd">        Finds the checked tag and sets it as the new thumbnail tag.</span>
<span class="sd">        Closes the dialog after selection.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">count</span><span class="p">()):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">checkState</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">setThumbnailTag</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="k">break</span>

        <span class="c1"># Close the dialog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PopUpSelectTagCountTable">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSelectTagCountTable">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpSelectTagCountTable</span><span class="p">(</span><span class="n">PopUpTagSelection</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A pop-up dialog for selecting a tag from a count table.</span>

<span class="sd">    Allows users to choose a single tag from a list of available tags,</span>
<span class="sd">    with an option to pre-select a specific tag.</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - ok_clicked: updates the selected tag and closes the pop-up</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PopUpSelectTagCountTable.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSelectTagCountTable.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">tags_to_display</span><span class="p">,</span> <span class="n">tag_name_checked</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the tag selection pop-up.</span>

<span class="sd">        :param project: The current project context.</span>
<span class="sd">        :param tags_to_display (list): List of tags to be displayed for</span>
<span class="sd">                                       selection.</span>
<span class="sd">        :param tag_name_checked (str): Optional tag to be pre-checked on</span>
<span class="sd">                                 initialization.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">project</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected_tag</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Filtered tags, excluding specific system tags</span>
        <span class="n">filterable_tags</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">tag</span>
            <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags_to_display</span>
            <span class="k">if</span> <span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="n">TAG_CHECKSUM</span><span class="p">,</span> <span class="n">TAG_HISTORY</span><span class="p">}</span>
        <span class="p">]</span>

        <span class="c1"># Populate list widget with checkable items</span>
        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">filterable_tags</span><span class="p">):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">QListWidgetItem</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">|</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsUserCheckable</span><span class="p">)</span>
            <span class="c1"># Set initial check state</span>
            <span class="n">check_state</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span>
                <span class="k">if</span> <span class="n">tag</span> <span class="o">==</span> <span class="n">tag_name_checked</span>
                <span class="k">else</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Unchecked</span>
            <span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">check_state</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">sortItems</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpSelectTagCountTable.ok_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpSelectTagCountTable.ok_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">ok_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine the selected tag and close the dialog.</span>

<span class="sd">        Finds the first checked item and sets it as the selected tag,</span>
<span class="sd">        then closes the dialog.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">count</span><span class="p">()):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">checkState</span><span class="p">()</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">selected_tag</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                <span class="k">break</span>

        <span class="c1"># Close the dialog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="PopUpShowHistory">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpShowHistory</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A dialog for displaying the history of a document in a software pipeline.</span>

<span class="sd">    This class creates a popup window that provides comprehensive information</span>
<span class="sd">    about a specific brick (processing node) in a pipeline, including:</span>
<span class="sd">    - Pipeline visualization</span>
<span class="sd">    - Input and output parameters</span>
<span class="sd">    - Initialization and execution details</span>

<span class="sd">    The dialog allows users to:</span>
<span class="sd">    - View the pipeline structure</span>
<span class="sd">    - Inspect node details</span>
<span class="sd">    - Navigate between associated bricks</span>
<span class="sd">    - Select and highlight specific files</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - _updateio_table: fill in the input and output sections of the table</span>
<span class="sd">        - adjust_size: Adjust the size of the dialog based on screen</span>
<span class="sd">                       resolution</span>
<span class="sd">        - file_clicked: close the history window and select the file in the</span>
<span class="sd">                        data browser</span>
<span class="sd">        - find_associated_bricks: Find bricks associated with a given node</span>
<span class="sd">                                  name.</span>
<span class="sd">        - find_process_from_plug: Find the process and plug name from a</span>
<span class="sd">                                  given plug.</span>
<span class="sd">        - handle_pipeline_nodes: Handle pipeline nodes and initialize the</span>
<span class="sd">                                 pipeline visualization</span>
<span class="sd">        - highlight_selected_node: Highlight the selected node in the pipeline</span>
<span class="sd">                                   view</span>
<span class="sd">        - initialize_pipeline: Initialize the pipeline view using the given</span>
<span class="sd">                               pipeline XML.</span>
<span class="sd">        - io_value_is_scan: Checks if the I/O value is a scan</span>
<span class="sd">        - load_data: Load data from the project database</span>
<span class="sd">        - load_pipeline_data: Load pipeline data from the database</span>
<span class="sd">        - node_selected: Handle node selection and update the table.</span>
<span class="sd">        - select_node: Select the node in the pipeline view based on the</span>
<span class="sd">                       provided brick UUID</span>
<span class="sd">        - setup_ui: Set up the user interface components</span>
<span class="sd">        - update_table: Update the brick row at the bottom of the table.</span>
<span class="sd">        - update_table_for_single_brick: Update the table for a single brick</span>
<span class="sd">        - update_table_for_subpipeline: Update the table for a subpipeline</span>
<span class="sd">        - update_table_with_brick_data: Update the table with the brick&#39;s</span>
<span class="sd">                                        input and output data after processing</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="PopUpShowHistory.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">brick_uuid</span><span class="p">,</span> <span class="n">scan</span><span class="p">,</span> <span class="n">databrowser</span><span class="p">,</span> <span class="n">main_window</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the document history popup.</span>

<span class="sd">        :param project: Current project in the software</span>
<span class="sd">        :param brick_uuid (str): Unique identifier of the brick</span>
<span class="sd">        :param scan (str): Filename of the scan</span>
<span class="sd">        :param databrowser: Data browser instance</span>
<span class="sd">        :param main_window: Main window of the software</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># We do not want few parameters in the outputs parameters display</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">banished_param</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;notInDb&quot;</span><span class="p">,</span> <span class="s2">&quot;dict4runtime&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setModal</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">windowFlags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowStaysOnBottomHint</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span> <span class="o">=</span> <span class="n">databrowser</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_window</span> <span class="o">=</span> <span class="n">main_window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;History of </span><span class="si">{</span><span class="n">scan</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_ui</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">brick_uuid</span><span class="p">,</span> <span class="n">scan</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_updateio_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">io_dict</span><span class="p">,</span> <span class="n">item_idx</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Populate the table&#39;s input and output sections with given</span>
<span class="sd">        dictionary data.</span>

<span class="sd">        This method dynamically creates table headers and cell widgets</span>
<span class="sd">        based on the input dictionary, handling nested lists and detecting</span>
<span class="sd">        scanned file paths.</span>

<span class="sd">        :param io_dict (dict): Dictionary containing input or output data</span>
<span class="sd">                               to be displayed. Keys represent column</span>
<span class="sd">                               headers, and values can be strings, lists,</span>
<span class="sd">                               or nested lists.</span>
<span class="sd">        :param item_idx (int): The starting column index for populating</span>
<span class="sd">                               the table</span>

<span class="sd">        :return (int): The updated column index after processing the</span>
<span class="sd">                       dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">io_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setHorizontalHeaderItem</span><span class="p">(</span><span class="n">item_idx</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
                <span class="n">v_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
                <span class="n">v_layout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignTop</span><span class="p">)</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span>
                <span class="n">v_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">sub_value</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>

                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sub_value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sub_value</span><span class="p">:</span>
                        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">)</span>
                        <span class="n">v_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

                        <span class="k">for</span> <span class="n">sub_sub_value</span> <span class="ow">in</span> <span class="n">sub_value</span><span class="p">:</span>
                            <span class="n">sub_sub_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sub_sub_value</span><span class="p">)</span>
                            <span class="n">value_scan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">io_value_is_scan</span><span class="p">(</span><span class="n">sub_sub_value</span><span class="p">)</span>

                            <span class="k">if</span> <span class="n">value_scan</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="k">del</span> <span class="n">v_layout</span>
                                <span class="k">del</span> <span class="n">label</span>
                                <span class="n">v_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
                                <span class="n">v_layout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span>
                                    <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignHCenter</span> <span class="o">|</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignTop</span>
                                <span class="p">)</span>
                                <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
                                <span class="n">v_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                                <span class="k">break</span>

                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">h_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
                                <span class="n">h_layout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignLeft</span><span class="p">)</span>
                                <span class="n">button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="n">value_scan</span><span class="p">)</span>
                                <span class="n">button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_clicked</span><span class="p">)</span>
                                <span class="n">h_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">button</span><span class="p">)</span>
                                <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                                <span class="n">h_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                                <span class="n">v_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">h_layout</span><span class="p">)</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;],&quot;</span><span class="p">)</span>
                            <span class="n">v_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                            <span class="k">continue</span>

                        <span class="k">break</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">sub_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sub_value</span><span class="p">)</span>
                        <span class="n">value_scan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">io_value_is_scan</span><span class="p">(</span><span class="n">sub_value</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">value_scan</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="k">del</span> <span class="n">v_layout</span>
                            <span class="k">del</span> <span class="n">label</span>
                            <span class="n">v_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
                            <span class="n">v_layout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span>
                                <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignHCenter</span> <span class="o">|</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignTop</span>
                            <span class="p">)</span>
                            <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
                            <span class="n">v_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                            <span class="k">break</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">h_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
                            <span class="n">button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="n">value_scan</span><span class="p">)</span>
                            <span class="n">button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_clicked</span><span class="p">)</span>
                            <span class="n">h_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">button</span><span class="p">)</span>
                            <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                            <span class="n">h_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                            <span class="n">v_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">h_layout</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">)</span>
                    <span class="n">v_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

                <span class="n">widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">v_layout</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">item_idx</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">value_scan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">io_value_is_scan</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">value_scan</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
                    <span class="n">v_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
                    <span class="n">button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="n">value_scan</span><span class="p">)</span>
                    <span class="n">button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_clicked</span><span class="p">)</span>
                    <span class="n">v_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">button</span><span class="p">)</span>
                    <span class="n">v_layout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span>
                        <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignHCenter</span> <span class="o">|</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignTop</span>
                    <span class="p">)</span>
                    <span class="n">widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">v_layout</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">item_idx</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
                    <span class="n">v_layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
                    <span class="n">v_layout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span>
                        <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignHCenter</span> <span class="o">|</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignTop</span>
                    <span class="p">)</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
                    <span class="n">v_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
                    <span class="n">widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">v_layout</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">item_idx</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span>

            <span class="n">item_idx</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">item_idx</span>

<div class="viewcode-block" id="PopUpShowHistory.adjust_size">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory.adjust_size">[docs]</a>
    <span class="k">def</span> <span class="nf">adjust_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adjust the size of the dialog based on screen resolution.&quot;&quot;&quot;</span>
        <span class="n">screen_resolution</span> <span class="o">=</span> <span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">desktop</span><span class="p">()</span><span class="o">.</span><span class="n">screenGeometry</span><span class="p">()</span>
        <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">screen_resolution</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="n">screen_resolution</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="mf">0.6</span> <span class="o">*</span> <span class="n">width</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="mf">0.4</span> <span class="o">*</span> <span class="n">height</span><span class="p">))</span></div>


<div class="viewcode-block" id="PopUpShowHistory.file_clicked">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory.file_clicked">[docs]</a>
    <span class="k">def</span> <span class="nf">file_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Close the history window and select the file in the data browser.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span><span class="o">.</span><span class="n">table_data</span><span class="o">.</span><span class="n">clearSelection</span><span class="p">()</span>
        <span class="n">row_to_select</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span><span class="o">.</span><span class="n">table_data</span><span class="o">.</span><span class="n">get_scan_row</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span><span class="o">.</span><span class="n">table_data</span><span class="o">.</span><span class="n">selectRow</span><span class="p">(</span><span class="n">row_to_select</span><span class="p">)</span>
        <span class="n">item_to_scroll_to</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span><span class="o">.</span><span class="n">table_data</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">row_to_select</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">databrowser</span><span class="o">.</span><span class="n">table_data</span><span class="o">.</span><span class="n">scrollToItem</span><span class="p">(</span><span class="n">item_to_scroll_to</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpShowHistory.find_associated_bricks">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory.find_associated_bricks">[docs]</a>
    <span class="k">def</span> <span class="nf">find_associated_bricks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find bricks associated with a given node name.</span>

<span class="sd">        :param node_name (str): The name of the node to find associated</span>
<span class="sd">                                bricks for.</span>

<span class="sd">        :return (dict): A dictionary where the keys are the full brick</span>
<span class="sd">                        names and the values are lists of associated UUIDs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bricks</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">uuid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">brick_list</span><span class="p">:</span>

            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
                <span class="n">full_brick_name</span> <span class="o">=</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span>
                    <span class="n">collection_name</span><span class="o">=</span><span class="n">COLLECTION_BRICK</span><span class="p">,</span>
                    <span class="n">primary_key</span><span class="o">=</span><span class="n">uuid</span><span class="p">,</span>
                    <span class="n">field</span><span class="o">=</span><span class="n">BRICK_NAME</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="n">list_full_brick_name</span> <span class="o">=</span> <span class="n">full_brick_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitary_pipeline</span><span class="p">:</span>
                <span class="n">list_full_brick_name</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">list_full_brick_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">node_name</span><span class="p">:</span>
                <span class="n">bricks</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">full_brick_name</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">uuid</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">bricks</span></div>


<div class="viewcode-block" id="PopUpShowHistory.find_process_from_plug">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory.find_process_from_plug">[docs]</a>
    <span class="k">def</span> <span class="nf">find_process_from_plug</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plug</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find the process and plug name from a given plug.</span>

<span class="sd">        :param plug (Plug): The plug object to find the process and plug</span>
<span class="sd">                            name from.</span>

<span class="sd">        :return (tuple): A tuple containing the process name (str) and</span>
<span class="sd">                         plug name (str).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">process_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">plug_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">plug</span><span class="o">.</span><span class="n">links_from</span> <span class="k">if</span> <span class="n">plug</span><span class="o">.</span><span class="n">output</span> <span class="k">else</span> <span class="n">plug</span><span class="o">.</span><span class="n">links_to</span><span class="p">:</span>
            <span class="n">process_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">process_name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">link</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">plug_name</span> <span class="o">=</span> <span class="n">link</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">link</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">PipelineNode</span><span class="p">):</span>
                <span class="n">sub_process_name</span><span class="p">,</span> <span class="n">plug_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_process_from_plug</span><span class="p">(</span>
                    <span class="n">link</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plugs</span><span class="p">[</span><span class="n">link</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
                <span class="p">)</span>
                <span class="n">process_name</span> <span class="o">+=</span> <span class="n">sub_process_name</span>

            <span class="k">break</span>

        <span class="k">return</span> <span class="n">process_name</span><span class="p">,</span> <span class="n">plug_name</span></div>


<div class="viewcode-block" id="PopUpShowHistory.handle_pipeline_nodes">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory.handle_pipeline_nodes">[docs]</a>
    <span class="k">def</span> <span class="nf">handle_pipeline_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pipeline</span><span class="p">,</span> <span class="n">full_brick_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle pipeline nodes, set up the view, and initialize the</span>
<span class="sd">        pipeline visualization.</span>

<span class="sd">        :param pipeline (Pipeline): The pipeline object containing the</span>
<span class="sd">                                    nodes to handle.</span>
<span class="sd">        :param full_brick_name (list): The full name of the brick, split</span>
<span class="sd">                                       into parts.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># handle case of pipeline node alone --&gt; exploded view</span>
        <span class="c1"># (e.g. a pipeline alone and plug exported)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                <span class="k">if</span> <span class="n">key</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">PipelineNode</span><span class="p">):</span>
                    <span class="n">pipeline</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">process</span>
                    <span class="n">full_brick_name</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">unitary_pipeline</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitary_pipeline</span> <span class="ow">and</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;CustomPipeline&quot;</span>
        <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">full_brick_name</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">full_brick_name</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;main&quot;</span><span class="p">):</span>
            <span class="n">full_brick_name</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unitary_pipeline</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pipeline_view</span> <span class="o">=</span> <span class="n">PipelineDeveloperView</span><span class="p">(</span>
            <span class="n">pipeline</span><span class="p">,</span> <span class="n">allow_open_controller</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pipeline_view</span><span class="o">.</span><span class="n">auto_dot_node_positions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pipeline_view</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pipeline_view</span><span class="o">.</span><span class="n">node_clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_selected</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pipeline_view</span><span class="o">.</span><span class="n">process_clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_selected</span><span class="p">)</span>
        <span class="n">bricks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_associated_bricks</span><span class="p">(</span><span class="n">full_brick_name</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">select_node</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">bricks</span><span class="p">,</span> <span class="n">full_brick_name</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpShowHistory.highlight_selected_node">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory.highlight_selected_node">[docs]</a>
    <span class="k">def</span> <span class="nf">highlight_selected_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Highlight the selected node in the pipeline view.</span>

<span class="sd">        :param node_name (str): The name of the node to highlight.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">gnode</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pipeline_view</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">gnodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">gnode</span><span class="o">.</span><span class="n">fonced_viewer</span><span class="p">(</span><span class="n">name</span> <span class="o">!=</span> <span class="n">node_name</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpShowHistory.initialize_pipeline">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory.initialize_pipeline">[docs]</a>
    <span class="k">def</span> <span class="nf">initialize_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full_brick_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the pipeline view using the given pipeline XML.</span>

<span class="sd">        :param full_brick_name (list): The full name of the brick,</span>
<span class="sd">                                       split into parts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">engine</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">get_capsul_engine</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">pipeline</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">get_process_instance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pipeline_xml</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">pipeline</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">pipeline</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">handle_pipeline_nodes</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">full_brick_name</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpShowHistory.io_value_is_scan">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory.io_value_is_scan">[docs]</a>
    <span class="k">def</span> <span class="nf">io_value_is_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if the I/O value is a scan.</span>

<span class="sd">        :param value: I/O value</span>

<span class="sd">        :return: The scan corresponding to the value if it exists,</span>
<span class="sd">         None otherwise</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">scan</span> <span class="ow">in</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_document_names</span><span class="p">(</span><span class="n">COLLECTION_CURRENT</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">scan</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">scan</span>

        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="PopUpShowHistory.load_data">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory.load_data">[docs]</a>
    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">brick_uuid</span><span class="p">,</span> <span class="n">scan</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load data from the project database and update the table with brick</span>
<span class="sd">        data.</span>

<span class="sd">        :param brick_uuid (str): The UUID of the brick to load.</span>
<span class="sd">        :param scan (str): The identifier of the scan associated with the</span>
<span class="sd">                           brick.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
            <span class="n">brick_row</span> <span class="o">=</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_document</span><span class="p">(</span>
                <span class="n">collection_name</span><span class="o">=</span><span class="n">COLLECTION_BRICK</span><span class="p">,</span> <span class="n">primary_keys</span><span class="o">=</span><span class="n">brick_uuid</span>
            <span class="p">)</span>
            <span class="n">full_brick_name</span> <span class="o">=</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span>
                <span class="n">collection_name</span><span class="o">=</span><span class="n">COLLECTION_BRICK</span><span class="p">,</span>
                <span class="n">primary_key</span><span class="o">=</span><span class="n">brick_uuid</span><span class="p">,</span>
                <span class="n">field</span><span class="o">=</span><span class="n">BRICK_NAME</span><span class="p">,</span>
            <span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
            <span class="n">history_uuid</span> <span class="o">=</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span>
                <span class="n">collection_name</span><span class="o">=</span><span class="n">COLLECTION_CURRENT</span><span class="p">,</span>
                <span class="n">primary_key</span><span class="o">=</span><span class="n">scan</span><span class="p">,</span>
                <span class="n">field</span><span class="o">=</span><span class="n">TAG_HISTORY</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">unitary_pipeline</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uuid_idx</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">history_uuid</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_pipeline_data</span><span class="p">(</span><span class="n">history_uuid</span><span class="p">,</span> <span class="n">full_brick_name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_table_with_brick_data</span><span class="p">(</span><span class="n">brick_row</span><span class="p">,</span> <span class="n">full_brick_name</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpShowHistory.load_pipeline_data">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory.load_pipeline_data">[docs]</a>
    <span class="k">def</span> <span class="nf">load_pipeline_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">history_uuid</span><span class="p">,</span> <span class="n">full_brick_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load pipeline data from the database based on the provided</span>
<span class="sd">        history UUID.</span>

<span class="sd">        :param history_uuid (str): The UUID of the history record to load</span>
<span class="sd">                                   pipeline data from.</span>
<span class="sd">        :param full_brick_name (list): The full name of the brick, split</span>
<span class="sd">                                       into parts.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pipeline_xml</span> <span class="o">=</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span>
                <span class="n">collection_name</span><span class="o">=</span><span class="n">COLLECTION_HISTORY</span><span class="p">,</span>
                <span class="n">primary_key</span><span class="o">=</span><span class="n">history_uuid</span><span class="p">,</span>
                <span class="n">field</span><span class="o">=</span><span class="n">HISTORY_PIPELINE</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pipeline_xml</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">brick_list</span> <span class="o">=</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span>
                    <span class="n">collection_name</span><span class="o">=</span><span class="n">COLLECTION_HISTORY</span><span class="p">,</span>
                    <span class="n">primary_key</span><span class="o">=</span><span class="n">history_uuid</span><span class="p">,</span>
                    <span class="n">field</span><span class="o">=</span><span class="n">HISTORY_BRICKS</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialize_pipeline</span><span class="p">(</span><span class="n">full_brick_name</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpShowHistory.node_selected">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory.node_selected">[docs]</a>
    <span class="k">def</span> <span class="nf">node_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">process</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle node selection and update the table.</span>

<span class="sd">        :param node_name: node name</span>
<span class="sd">        :param process: process of the corresponding node</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">process</span><span class="p">,</span> <span class="s2">&quot;pipeline_node&quot;</span><span class="p">):</span>
            <span class="n">process</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">pipeline_node</span>

        <span class="n">bricks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_associated_bricks</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
        <span class="n">full_node_name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">process</span><span class="p">,</span> <span class="s2">&quot;full_name&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">node_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">full_node_name</span><span class="p">:</span>
            <span class="n">full_node_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">if</span> <span class="n">bricks</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bricks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_table_for_single_brick</span><span class="p">(</span>
                    <span class="n">bricks</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">full_node_name</span>
                <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_table_for_subpipeline</span><span class="p">(</span>
                    <span class="n">bricks</span><span class="p">,</span> <span class="n">process</span><span class="p">,</span> <span class="n">full_node_name</span>
                <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">highlight_selected_node</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpShowHistory.select_node">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory.select_node">[docs]</a>
    <span class="k">def</span> <span class="nf">select_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pipeline</span><span class="p">,</span> <span class="n">bricks</span><span class="p">,</span> <span class="n">full_brick_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select the node in the pipeline view based on the provided brick UUID.</span>

<span class="sd">        :param pipeline (Pipeline): The pipeline object containing the</span>
<span class="sd">                                    nodes to handle.</span>
<span class="sd">        :param bricks (dict): A dictionary of bricks with UUIDs as values.</span>
<span class="sd">        :param full_brick_name (list): The full name of the brick, split into</span>
<span class="sd">                                       parts.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">bricks_uuids</span> <span class="ow">in</span> <span class="n">bricks</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>

            <span class="k">if</span> <span class="n">bricks_uuids</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid_idx</span><span class="p">]</span> <span class="o">==</span> <span class="n">full_brick_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">break</span>

        <span class="n">selected_name</span> <span class="o">=</span> <span class="n">full_brick_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node_selected</span><span class="p">(</span><span class="n">selected_name</span><span class="p">,</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">selected_name</span><span class="p">])</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Error in naming association brick/pipeline, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;cannot select node: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="PopUpShowHistory.setup_ui">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory.setup_ui">[docs]</a>
    <span class="k">def</span> <span class="nf">setup_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up the user interface components.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">splitter</span> <span class="o">=</span> <span class="n">QSplitter</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Vertical</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">QTableWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setVerticalScrollMode</span><span class="p">(</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">ScrollPerPixel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setHorizontalScrollMode</span><span class="p">(</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">ScrollPerPixel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splitter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjust_size</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpShowHistory.update_table">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory.update_table">[docs]</a>
    <span class="k">def</span> <span class="nf">update_table</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">inputs</span><span class="p">,</span>
        <span class="n">outputs</span><span class="p">,</span>
        <span class="n">brick_name</span><span class="p">,</span>
        <span class="n">init</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">init_time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">exec</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">exec_time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the table with information about a brick&#39;s execution state.</span>

<span class="sd">        :param inputs (dict): Dictionary containing input data.</span>
<span class="sd">        :param outputs (dict): Dictionary containing output data.</span>
<span class="sd">        :param brick_name (str): Name of the brick.</span>
<span class="sd">        :param init (str, optional): Initialization status.</span>
<span class="sd">        :param init_time (Any, optional): Initialization timestamp.</span>
<span class="sd">        :param exec (str, optional): Execution status.</span>
<span class="sd">        :param exec_time (Any, optional): Execution timestamp.</span>

<span class="sd">        :Contains:</span>
<span class="sd">            - create_cell_widget: Creates a QWidget containing a vertically</span>
<span class="sd">                                  aligned QLabel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">column_count</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mi">1</span>
            <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="k">if</span> <span class="n">init</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
            <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="k">if</span> <span class="n">exec</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
            <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setColumnCount</span><span class="p">(</span><span class="n">column_count</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">create_cell_widget</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Creates a QWidget containing a vertically aligned QLabel with</span>
<span class="sd">            the given text.</span>

<span class="sd">            :param text (str): The text to display in the QLabel.</span>

<span class="sd">            :return (QWidget): A QWidget containing a QLabel with the</span>
<span class="sd">                               specified text, aligned to the top within</span>
<span class="sd">                               a vertical layout.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
            <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignTop</span><span class="p">)</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">widget</span>

        <span class="c1"># Brick name column</span>
        <span class="n">item_idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setHorizontalHeaderItem</span><span class="p">(</span>
            <span class="n">item_idx</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">BRICK_NAME</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">item_idx</span><span class="p">,</span> <span class="n">create_cell_widget</span><span class="p">(</span><span class="n">brick_name</span><span class="p">))</span>
        <span class="n">item_idx</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Brick initialization columns</span>
        <span class="k">if</span> <span class="n">init</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setHorizontalHeaderItem</span><span class="p">(</span>
                <span class="n">item_idx</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">BRICK_INIT</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">item_idx</span><span class="p">,</span> <span class="n">create_cell_widget</span><span class="p">(</span><span class="n">init</span><span class="p">))</span>
            <span class="n">item_idx</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setHorizontalHeaderItem</span><span class="p">(</span>
                <span class="n">item_idx</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">BRICK_INIT_TIME</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="n">item_idx</span><span class="p">,</span>
                <span class="n">create_cell_widget</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">init_time</span><span class="p">)</span> <span class="k">if</span> <span class="n">init_time</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">item_idx</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Brick execution columns</span>
        <span class="k">if</span> <span class="n">exec</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setHorizontalHeaderItem</span><span class="p">(</span>
                <span class="n">item_idx</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">BRICK_EXEC</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">item_idx</span><span class="p">,</span> <span class="n">create_cell_widget</span><span class="p">(</span><span class="n">exec</span><span class="p">))</span>
            <span class="n">item_idx</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setHorizontalHeaderItem</span><span class="p">(</span>
                <span class="n">item_idx</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">BRICK_EXEC_TIME</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">setCellWidget</span><span class="p">(</span>
                <span class="mi">0</span><span class="p">,</span>
                <span class="n">item_idx</span><span class="p">,</span>
                <span class="n">create_cell_widget</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">exec_time</span><span class="p">)</span> <span class="k">if</span> <span class="n">exec_time</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">item_idx</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Update inputs and outputs</span>
        <span class="n">item_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_updateio_table</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">item_idx</span><span class="p">)</span>
        <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_updateio_table</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">item_idx</span><span class="p">)</span>
        <span class="c1"># Final table adjustments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">verticalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setMinimumSectionSize</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">resizeColumnsToContents</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">resizeRowsToContents</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpShowHistory.update_table_for_single_brick">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory.update_table_for_single_brick">[docs]</a>
    <span class="k">def</span> <span class="nf">update_table_for_single_brick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bricks</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">full_node_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the table for a single brick, using the provided brick data.</span>

<span class="sd">        :param bricks (dict): A dictionary of bricks with UUIDs as values.</span>
<span class="sd">        :param node_name (str): The name of the node associated with the</span>
<span class="sd">                                brick.</span>
<span class="sd">        :param full_node_name (list): The full name of the node, split</span>
<span class="sd">                                      into parts.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>
            <span class="n">brick_row</span> <span class="o">=</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_document</span><span class="p">(</span>
                <span class="n">collection_name</span><span class="o">=</span><span class="n">COLLECTION_BRICK</span><span class="p">,</span>
                <span class="n">primary_keys</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">bricks</span><span class="o">.</span><span class="n">values</span><span class="p">()))[</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid_idx</span><span class="p">],</span>
            <span class="p">)</span>

        <span class="n">inputs</span> <span class="o">=</span> <span class="n">brick_row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">BRICK_INPUTS</span><span class="p">]</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">brick_row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">BRICK_OUTPUTS</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">banished_param</span><span class="p">:</span>
            <span class="n">outputs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">inputs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">brick_name</span> <span class="o">=</span> <span class="n">brick_row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">BRICK_NAME</span><span class="p">]</span>
        <span class="n">init</span> <span class="o">=</span> <span class="n">brick_row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">BRICK_INIT</span><span class="p">]</span>
        <span class="n">init_time</span> <span class="o">=</span> <span class="n">brick_row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">BRICK_INIT_TIME</span><span class="p">]</span>
        <span class="n">exec</span> <span class="o">=</span> <span class="n">brick_row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">BRICK_INIT</span><span class="p">]</span>
        <span class="n">exec_time</span> <span class="o">=</span> <span class="n">brick_row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">BRICK_INIT_TIME</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_table</span><span class="p">(</span>
            <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">brick_name</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="n">init_time</span><span class="p">,</span> <span class="n">exec</span><span class="p">,</span> <span class="n">exec_time</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PopUpShowHistory.update_table_for_subpipeline">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory.update_table_for_subpipeline">[docs]</a>
    <span class="k">def</span> <span class="nf">update_table_for_subpipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bricks</span><span class="p">,</span> <span class="n">process</span><span class="p">,</span> <span class="n">full_node_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the table for a subpipeline based on the given process and</span>
<span class="sd">        brick data.</span>

<span class="sd">        :param bricks (dict): A dictionary of bricks with UUIDs as values.</span>
<span class="sd">        :param process (PipelineNode): The process node associated with the</span>
<span class="sd">                                       subpipeline.</span>
<span class="sd">        :param full_node_name (list): The full name of the node, split into</span>
<span class="sd">                                      parts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">inputs_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">outputs_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">process</span><span class="p">,</span> <span class="n">PipelineNode</span><span class="p">):</span>

            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">plug_name</span><span class="p">,</span> <span class="n">plug</span> <span class="ow">in</span> <span class="n">process</span><span class="o">.</span><span class="n">plugs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                    <span class="k">if</span> <span class="n">plug</span><span class="o">.</span><span class="n">activated</span><span class="p">:</span>
                        <span class="n">process_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_process_from_plug</span><span class="p">(</span><span class="n">plug</span><span class="p">)</span>
                        <span class="n">process_name</span> <span class="o">=</span> <span class="n">process_result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">inner_plug_name</span> <span class="o">=</span> <span class="n">process_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

                        <span class="k">for</span> <span class="n">uuid</span> <span class="ow">in</span> <span class="n">bricks</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                            <span class="n">full_brick_name</span> <span class="o">=</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span>
                                <span class="n">collection_name</span><span class="o">=</span><span class="n">COLLECTION_BRICK</span><span class="p">,</span>
                                <span class="n">primary_key</span><span class="o">=</span><span class="n">uuid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">field</span><span class="o">=</span><span class="n">BRICK_NAME</span><span class="p">,</span>
                            <span class="p">)</span>

                            <span class="k">if</span> <span class="n">full_brick_name</span> <span class="o">==</span> <span class="p">(</span>
                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">full_node_name</span><span class="si">}{</span><span class="n">process_name</span><span class="si">}</span><span class="s2">&quot;</span>
                            <span class="p">):</span>
                                <span class="n">plugs</span> <span class="o">=</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span>
                                    <span class="n">collection_name</span><span class="o">=</span><span class="n">COLLECTION_BRICK</span><span class="p">,</span>
                                    <span class="n">primary_key</span><span class="o">=</span><span class="n">uuid</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">uuid_idx</span><span class="p">],</span>
                                    <span class="n">field</span><span class="o">=</span><span class="p">(</span>
                                        <span class="n">BRICK_OUTPUTS</span>
                                        <span class="k">if</span> <span class="n">plug</span><span class="o">.</span><span class="n">output</span>
                                        <span class="k">else</span> <span class="n">BRICK_INPUTS</span>
                                    <span class="p">),</span>
                                <span class="p">)</span>
                                <span class="p">(</span><span class="n">outputs_dict</span> <span class="k">if</span> <span class="n">plug</span><span class="o">.</span><span class="n">output</span> <span class="k">else</span> <span class="n">inputs_dict</span><span class="p">)[</span>
                                    <span class="n">plug_name</span>
                                <span class="p">]</span> <span class="o">=</span> <span class="n">plugs</span><span class="p">[</span><span class="n">inner_plug_name</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">banished_param</span><span class="p">:</span>
            <span class="n">outputs_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">inputs_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_table</span><span class="p">(</span><span class="n">inputs_dict</span><span class="p">,</span> <span class="n">outputs_dict</span><span class="p">,</span> <span class="n">full_node_name</span><span class="p">)</span></div>


<div class="viewcode-block" id="PopUpShowHistory.update_table_with_brick_data">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpShowHistory.update_table_with_brick_data">[docs]</a>
    <span class="k">def</span> <span class="nf">update_table_with_brick_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">brick_row</span><span class="p">,</span> <span class="n">full_brick_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the table with the brick&#39;s input and output data after</span>
<span class="sd">        processing.</span>

<span class="sd">        :param brick_row (list): A list containing the brick data to update</span>
<span class="sd">                                 the table with.</span>
<span class="sd">        :param full_brick_name (list): The full name of the brick, split into</span>
<span class="sd">                                       parts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="n">brick_row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">BRICK_INPUTS</span><span class="p">]</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">brick_row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">BRICK_OUTPUTS</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">banished_param</span><span class="p">:</span>
            <span class="n">outputs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">inputs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">brick_name</span> <span class="o">=</span> <span class="n">brick_row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">BRICK_NAME</span><span class="p">]</span>
        <span class="n">init</span> <span class="o">=</span> <span class="n">brick_row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">BRICK_INIT</span><span class="p">]</span>
        <span class="n">init_time</span> <span class="o">=</span> <span class="n">brick_row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">BRICK_INIT_TIME</span><span class="p">]</span>
        <span class="n">exec</span> <span class="o">=</span> <span class="n">brick_row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">BRICK_INIT</span><span class="p">]</span>
        <span class="n">exec_time</span> <span class="o">=</span> <span class="n">brick_row</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">BRICK_INIT_TIME</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_table</span><span class="p">(</span>
            <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">brick_name</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="n">init_time</span><span class="p">,</span> <span class="n">exec</span><span class="p">,</span> <span class="n">exec_time</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">splitter</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="PopUpVisualizedTags">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpVisualizedTags">[docs]</a>
<span class="k">class</span> <span class="nc">PopUpVisualizedTags</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A widget for managing tag visualization preferences in a project.</span>

<span class="sd">    This class provides an interface for users to select and unselect tags</span>
<span class="sd">    to be displayed in the project. It allows searching through available tags</span>
<span class="sd">    and moving them between available and visualized lists.</span>

<span class="sd">    .. Methods:</span>
<span class="sd">        - _create_button: Create a customized QPushButton with specified</span>
<span class="sd">                          properties</span>
<span class="sd">        - _create_button_layout: Create the layout for selection buttons</span>
<span class="sd">        - _create_label: Create a customized QLabel with specified properties</span>
<span class="sd">        - _create_left_layout: Create the layout for available tags</span>
<span class="sd">        - _create_right_layout: Create the layout for visualized tags</span>
<span class="sd">        - _create_search_bar: Create the search bar with placeholder and</span>
<span class="sd">                              connection</span>
<span class="sd">        - _create_tag_list: Create a QListWidget configured for</span>
<span class="sd">                            multi-selection of tags</span>
<span class="sd">        - _populate_tags: Populate the tags list from the project database</span>
<span class="sd">        - _setup_ui: Create and layout the user interface components</span>
<span class="sd">        - search_str: Matches the searched pattern with the tags of the project</span>
<span class="sd">        - click_select_tag: Puts the selected tags in the &quot;selected tag&quot; table</span>
<span class="sd">        - click_unselect_tag: removes the unselected tags from populse_mia</span>
<span class="sd">                              &quot;selected tag&quot; table</span>

<span class="sd">    .. Signals:</span>
<span class="sd">        - signal_preferences_change (QtCore.pyqtSignal): Emitted when tag</span>
<span class="sd">                                                         visualization</span>
<span class="sd">                                                         preferences are</span>
<span class="sd">                                                         modified.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Signal to indicate preference changes</span>
    <span class="n">signal_preferences_change</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>

<div class="viewcode-block" id="PopUpVisualizedTags.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpVisualizedTags.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">,</span> <span class="n">visualized_tags</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the tag visualization management widget.</span>

<span class="sd">        :param project: The current project in the software.</span>
<span class="sd">        :param visualized_tags: Tags currently being visualized before</span>
<span class="sd">                                opening this widget.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visualized_tags</span> <span class="o">=</span> <span class="n">visualized_tags</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_translate</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">translate</span>
        <span class="c1"># Track available (non-visualized) tags</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left_tags</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Setup the user interface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_ui</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_tags</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">_create_button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_name</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">click_handler</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a customized QPushButton with specified properties.</span>

<span class="sd">        This method instantiates a QPushButton, sets its object name,</span>
<span class="sd">        translates and sets its text, and connects a click event handler.</span>

<span class="sd">        :param object_name (str): The unique identifier name for the button.</span>
<span class="sd">        :param text (str): The text to be displayed on the button, will</span>
<span class="sd">                           be translated.</span>
<span class="sd">        :param click_handler (callable): The function to be called when the</span>
<span class="sd">                                         button is clicked.</span>

<span class="sd">        :return (QPushButton): A configured button with the specified</span>
<span class="sd">                               properties.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">button</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="n">object_name</span><span class="p">)</span>
        <span class="n">button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;main_window&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>
        <span class="n">button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">click_handler</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">button</span>

    <span class="k">def</span> <span class="nf">_create_button_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the layout for selection buttons.&quot;&quot;&quot;</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_select_tag</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_button_unselect_tag</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">layout</span>

    <span class="k">def</span> <span class="nf">_create_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_name</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a customized QLabel with specified properties.</span>

<span class="sd">        This method instantiates a QLabel, sets its text format,</span>
<span class="sd">        object name, and translates its text.</span>

<span class="sd">        :param object_name (str): The unique identifier name for the label.</span>
<span class="sd">        :param text (str): The text to be displayed on the label, will be</span>
<span class="sd">                           translated.</span>

<span class="sd">        :return (QLabel): A configured label with the specified properties.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setTextFormat</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AutoText</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="n">object_name</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_translate</span><span class="p">(</span><span class="s2">&quot;main_window&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">label</span>

    <span class="k">def</span> <span class="nf">_create_left_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the layout for available tags.&quot;&quot;&quot;</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">top_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">top_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_tag_list</span><span class="p">)</span>
        <span class="n">top_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">top_layout</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">layout</span>

    <span class="k">def</span> <span class="nf">_create_right_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the layout for visualized tags.&quot;&quot;&quot;</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_visualized_tags</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_widget_selected_tags</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">layout</span>

    <span class="k">def</span> <span class="nf">_create_search_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the search bar with placeholder and connection.&quot;&quot;&quot;</span>
        <span class="n">search_bar</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">search_bar</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;lineEdit_search_bar&quot;</span><span class="p">)</span>
        <span class="n">search_bar</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="s2">&quot;Search&quot;</span><span class="p">)</span>
        <span class="n">search_bar</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_str</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">search_bar</span>

    <span class="k">def</span> <span class="nf">_create_tag_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a QListWidget configured for multi-selection of tags.</span>

<span class="sd">        This method initializes a QListWidget with multi-selection mode</span>
<span class="sd">        nabled, allowing users to select multiple items simultaneously.</span>
<span class="sd">        The list widget is assigned a unique object name based on the</span>
<span class="sd">        optional text parameter.</span>

<span class="sd">        :param text (str): A prefix used to create a unique object name</span>
<span class="sd">                           for the QListWidget.</span>

<span class="sd">        :return (QListWidget): A configured QListWidget with multi-selection</span>
<span class="sd">                               mode enabled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tag_list</span> <span class="o">=</span> <span class="n">QListWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">tag_list</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;listWidget_</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">tags&quot;</span><span class="p">)</span>
        <span class="n">tag_list</span><span class="o">.</span><span class="n">setSelectionMode</span><span class="p">(</span><span class="n">QAbstractItemView</span><span class="o">.</span><span class="n">MultiSelection</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tag_list</span>

    <span class="k">def</span> <span class="nf">_populate_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Populate the tags list from the project database.&quot;&quot;&quot;</span>
        <span class="n">excluded_tags</span> <span class="o">=</span> <span class="p">{</span><span class="n">TAG_CHECKSUM</span><span class="p">,</span> <span class="n">TAG_FILENAME</span><span class="p">,</span> <span class="n">TAG_HISTORY</span><span class="p">}</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">data</span><span class="p">()</span> <span class="k">as</span> <span class="n">database_data</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">database_data</span><span class="o">.</span><span class="n">get_field_names</span><span class="p">(</span><span class="n">COLLECTION_CURRENT</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">excluded_tags</span><span class="p">:</span>
                    <span class="n">item</span> <span class="o">=</span> <span class="n">QListWidgetItem</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">visualized_tags</span><span class="p">:</span>
                        <span class="c1"># Tag not visible: left side</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">left_tags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># Tag visible: right side</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_selected_tags</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">sortItems</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_setup_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create and layout the user interface components.&quot;&quot;&quot;</span>
        <span class="c1"># Selection buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_select_tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_button</span><span class="p">(</span>
            <span class="s2">&quot;pushButton_select_tag&quot;</span><span class="p">,</span> <span class="s2">&quot;--&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">click_select_tag</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_button_unselect_tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_button</span><span class="p">(</span>
            <span class="s2">&quot;pushButton_unselect_tag&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;--&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">click_unselect_tag</span>
        <span class="p">)</span>
        <span class="c1"># Available tags section</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_tag_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_label</span><span class="p">(</span>
            <span class="s2">&quot;label_tag_list&quot;</span><span class="p">,</span> <span class="s2">&quot;Available tags:&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_bar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_search_bar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_tag_list</span><span class="p">()</span>
        <span class="c1"># Visualized tags section</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_visualized_tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_label</span><span class="p">(</span>
            <span class="s2">&quot;label_visualized_tags&quot;</span><span class="p">,</span> <span class="s2">&quot;Visualized tags:&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_selected_tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_tag_list</span><span class="p">(</span><span class="s2">&quot;visualized_&quot;</span><span class="p">)</span>
        <span class="n">main_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">main_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_left_layout</span><span class="p">())</span>
        <span class="n">main_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_button_layout</span><span class="p">())</span>
        <span class="n">main_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_right_layout</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">main_layout</span><span class="p">)</span>

<div class="viewcode-block" id="PopUpVisualizedTags.search_str">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpVisualizedTags.search_str">[docs]</a>
    <span class="k">def</span> <span class="nf">search_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">str_search</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter tags based on search string.</span>

<span class="sd">        :param str_search (str): Search pattern to match against tags</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Find matching tags, case-insensitive</span>
        <span class="n">return_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">tag</span>
            <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">left_tags</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">str_search</span> <span class="ow">or</span> <span class="n">str_search</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="n">tag</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="c1"># Selection updated</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">tag_name</span> <span class="ow">in</span> <span class="n">return_list</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">QListWidgetItem</span><span class="p">(</span><span class="n">tag_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">sortItems</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpVisualizedTags.click_select_tag">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpVisualizedTags.click_select_tag">[docs]</a>
    <span class="k">def</span> <span class="nf">click_select_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Move selected tags from available to visualized list.</span>

<span class="sd">        Removes selected tags from the left (available) list and</span>
<span class="sd">        adds them to the right (visualized) list.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">rows</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="p">[</span><span class="n">index</span><span class="o">.</span><span class="n">row</span><span class="p">()</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">selectedIndexes</span><span class="p">()],</span>
            <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
            <span class="n">tag_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">takeItem</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="n">tag_text</span> <span class="o">=</span> <span class="n">tag_item</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
            <span class="c1"># assuming the other listWidget is called listWidget_2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left_tags</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tag_text</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_selected_tags</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">tag_text</span><span class="p">)</span>

        <span class="c1"># Emit signal to indicate preferences have changed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signal_preferences_change</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span></div>


<div class="viewcode-block" id="PopUpVisualizedTags.click_unselect_tag">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.PopUpVisualizedTags.click_unselect_tag">[docs]</a>
    <span class="k">def</span> <span class="nf">click_unselect_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove selected tags from the visualized list and</span>
<span class="sd">        return them to the available tags list.</span>

<span class="sd">        Moves selected tags from the right (visualized) list</span>
<span class="sd">        to the left (available) list, maintaining sorted order.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">rows</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">index</span><span class="o">.</span><span class="n">row</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_selected_tags</span><span class="o">.</span><span class="n">selectedIndexes</span><span class="p">()</span>
            <span class="p">],</span>
            <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
            <span class="c1"># Add tag back to left tags and available list</span>
            <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">left_tags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_selected_tags</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_selected_tags</span><span class="o">.</span><span class="n">takeItem</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">list_widget_tags</span><span class="o">.</span><span class="n">sortItems</span><span class="p">()</span></div>
</div>



<div class="viewcode-block" id="QLabel_clickable">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.QLabel_clickable">[docs]</a>
<span class="k">class</span> <span class="nc">QLabel_clickable</span><span class="p">(</span><span class="n">QLabel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A custom QLabel that emits a clicked signal when mouse pressed.</span>

<span class="sd">    This class extends the standard QLabel to provide a signal that can be</span>
<span class="sd">    connected to other methods when the label is clicked, enabling more</span>
<span class="sd">    interactive label behaviors.</span>

<span class="sd">     .. Signals:</span>
<span class="sd">        - clicked (pyqtSignal): Signal emitted when the label is clicked.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">clicked</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>

<div class="viewcode-block" id="QLabel_clickable.__init__">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.QLabel_clickable.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the clickable label.</span>

<span class="sd">        :param parent (QWidget): Parent widget.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span></div>


<div class="viewcode-block" id="QLabel_clickable.mousePressEvent">
<a class="viewcode-back" href="../../../populse_mia.user_interface.html#populse_mia.user_interface.pop_ups.QLabel_clickable.mousePressEvent">[docs]</a>
    <span class="k">def</span> <span class="nf">mousePressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Override the default mouse press event to emit the clicked signal.</span>

<span class="sd">        :parm event (QMouseEvent): Mouse press event details.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">mousePressEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>
</div>

</pre></div>

      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        <a class="uplink" href="../../../index.html">Contents</a>
        </p>

      </div>

    <div class="footer" role="contentinfo">
    &#169; Copyright 2022, populse.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    </div>
  </body>
</html>