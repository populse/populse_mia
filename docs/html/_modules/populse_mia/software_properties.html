
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>populse_mia.software_properties &#8212; populse_mia 2.2.1-dev+96badce30 documentation</title>
    <link rel="stylesheet" href="../../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script >mermaid.initialize({startOnLoad:true});</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../../index.html">
          <span>populse_mia 2.2.1-dev+96badce30 documentation</span></a></h1>
        <h2 class="heading"><span>populse_mia.software_properties</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        <a class="uplink" href="../../index.html">Contents</a>
        </p>

      </div>
      <div class="content" role="main">
        
        
  <h1>Source code for populse_mia.software_properties</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;Module that handle the configuration of the software</span>

<span class="sd">Load and save the parameters from the miniviewer and the MIA preferences</span>
<span class="sd">pop-up in the config.yml file.</span>

<span class="sd">:Contains:</span>
<span class="sd">    :Class:</span>
<span class="sd">        - Config</span>

<span class="sd">    :Function:</span>
<span class="sd">        - verCmp</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">##########################################################################</span>
<span class="c1"># Populse_mia - Copyright (C) IRMaGe/CEA, 2018</span>
<span class="c1"># Distributed under the terms of the CeCILL license, as published by</span>
<span class="c1"># the CEA-CNRS-INRIA. Refer to the LICENSE file or to</span>
<span class="c1"># http://www.cecill.info/licences/Licence_CeCILL_V2.1-en.html</span>
<span class="c1"># for details.</span>
<span class="c1">##########################################################################</span>

<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">import</span> <span class="nn">yaml</span>
<span class="c1"># Capsul import</span>
<span class="kn">from</span> <span class="nn">capsul.api</span> <span class="kn">import</span> <span class="n">capsul_engine</span>
<span class="kn">from</span> <span class="nn">cryptography.fernet</span> <span class="kn">import</span> <span class="n">Fernet</span>

<span class="n">CONFIG</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;5YSmesxZ4ge9au2Bxe7XDiQ3U5VCdLeRdqimOOggKyc=&quot;</span>


<div class="viewcode-block" id="verCmp"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.verCmp">[docs]</a><span class="k">def</span> <span class="nf">verCmp</span><span class="p">(</span><span class="n">first_ver</span><span class="p">,</span> <span class="n">sec_ver</span><span class="p">,</span> <span class="n">comp</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Version comparator.</span>

<span class="sd">    The verCmp() function returns a boolean value to indicate whether its</span>
<span class="sd">    first argument (first_ver) is equal to, less or equal to, or greater or</span>
<span class="sd">    equal to its second argument (sec_ver), as follows:</span>

<span class="sd">      - if third argument (comp) is &#39;eq&#39;: when the first argument is equal to</span>
<span class="sd">        the second argument, return True (False if not).</span>
<span class="sd">      - if third argument (comp) is &#39;sup&#39;: when the first argument is greater</span>
<span class="sd">        than the second argument, return True (False if not).</span>
<span class="sd">      - if third argument (comp) is &#39;inf&#39;: when the first argument is less than</span>
<span class="sd">        the second argument, return True (False if not).</span>

<span class="sd">    :param first_ver: the version of a package (a string; ex. &#39;0.13.0&#39;)</span>
<span class="sd">    :param sec_ver: the version of a package (a string; ex. &#39;0.13.0&#39;)</span>
<span class="sd">    :param comp: comparator argument (accepted values: &#39;sup&#39;, &#39;inf&#39; and &#39;eq&#39; )</span>

<span class="sd">    :return: False or True</span>

<span class="sd">    :Contains:</span>
<span class="sd">        :Private function:</span>
<span class="sd">            - normalise: transform a version of a package to a corresponding</span>
<span class="sd">              list of integer</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">normalise</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Transform a version of a package to a corresponding list of integer.</span>

<span class="sd">        :param v: version of a package (ex. 5.4.1)</span>

<span class="sd">        :return: a list of integer (ex. [0, 13, 0])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">v</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;[^0-9\.]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\.0+)*$&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)]</span>

    <span class="k">if</span> <span class="n">comp</span> <span class="o">==</span> <span class="s2">&quot;eq&quot;</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">normalise</span><span class="p">(</span><span class="n">first_ver</span><span class="p">)</span> <span class="o">==</span> <span class="n">normalise</span><span class="p">(</span><span class="n">sec_ver</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">elif</span> <span class="n">comp</span> <span class="o">==</span> <span class="s2">&quot;sup&quot;</span><span class="p">:</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">normalise</span><span class="p">(</span><span class="n">first_ver</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">normalise</span><span class="p">(</span><span class="n">sec_ver</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="n">verCmp</span><span class="p">(</span><span class="n">first_ver</span><span class="p">,</span> <span class="n">sec_ver</span><span class="p">,</span> <span class="s2">&quot;eq&quot;</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">elif</span> <span class="n">comp</span> <span class="o">==</span> <span class="s2">&quot;inf&quot;</span><span class="p">:</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">normalise</span><span class="p">(</span><span class="n">first_ver</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">normalise</span><span class="p">(</span><span class="n">sec_ver</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="n">verCmp</span><span class="p">(</span><span class="n">first_ver</span><span class="p">,</span> <span class="n">sec_ver</span><span class="p">,</span> <span class="s2">&quot;eq&quot;</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="Config"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config">[docs]</a><span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Object that handles the configuration of the software</span>

<span class="sd">    :Contains:</span>
<span class="sd">        :Methods:</span>
<span class="sd">            - get_admin_hash: get the value of the hash of the admin password</span>
<span class="sd">            - get_afni_path: returns the path of AFNI</span>
<span class="sd">            - get_ants_path: returns the path of ANTS</span>
<span class="sd">            - getBackgroundColor: get background color</span>
<span class="sd">            - get_capsul_config: get CAPSUL config dictionary</span>
<span class="sd">            - get_capsul_engine: get a global CapsulEngine object used for all</span>
<span class="sd">              operations in MIA application</span>
<span class="sd">            - getChainCursors: returns if the &quot;chain cursors&quot; checkbox of the</span>
<span class="sd">              mini viewer is activated</span>
<span class="sd">            - get_config_path: returns the configuration file directory</span>
<span class="sd">            - get_fsl_config: returns the path of the FSL config file</span>
<span class="sd">            - get_mainwindow_maximized: get the maximized (full-screen) flag</span>
<span class="sd">            - get_mainwindow_size: get the main window size</span>
<span class="sd">            - get_matlab_command: returns Matlab command</span>
<span class="sd">            - get_matlab_path: returns the path of Matlab&#39;s executable</span>
<span class="sd">            - get_matlab_standalone_path: returns the path of Matlab Compiler</span>
<span class="sd">              Runtime</span>
<span class="sd">            - get_max_projects: returns the maximum number of projects</span>
<span class="sd">              displayed in the &quot;Saved projects&quot; menu</span>
<span class="sd">            - get_max_thumbnails:  get max thumbnails number at the data browser</span>
<span class="sd">              bottom</span>
<span class="sd">            - get_mia_path: returns the software&#39;s install path</span>
<span class="sd">            - get_mri_conv_path: returns the MRIManager.jar path</span>
<span class="sd">            - getNbAllSlicesMax: returns the maximum number of slices to</span>
<span class="sd">              display in the mini viewer</span>
<span class="sd">            - get_opened_projects: returns the opened projects</span>
<span class="sd">            - getPathToProjectsFolder: returns the project&#39;s path</span>
<span class="sd">            - get_projects_save_path: returns the folder where the projects are</span>
<span class="sd">              saved</span>
<span class="sd">            - get_referential: returns boolean to indicate DataViewer</span>
<span class="sd">              referential</span>
<span class="sd">            - getShowAllSlices: returns if the &quot;show all slices&quot; checkbox of the</span>
<span class="sd">              mini viewer is activated</span>
<span class="sd">            - getSourceImageDir: get the source directory for project images</span>
<span class="sd">            - get_spm_path: returns the path of SPM12 (license version)</span>
<span class="sd">            - get_spm_standalone_path: returns the path of SPM12 (standalone</span>
<span class="sd">              version)</span>
<span class="sd">            - getTextColor: return the text color</span>
<span class="sd">            - getThumbnailTag: returns the tag that is displayed in the mini</span>
<span class="sd">              viewer</span>
<span class="sd">            - get_use_afni: returns the value of &quot;use afni&quot; checkbox in the</span>
<span class="sd">              preferences</span>
<span class="sd">            - get_use_ants: returns the value of &quot;use ants&quot; checkbox in the</span>
<span class="sd">              preferences</span>
<span class="sd">            - get_use_clinical: returns the value of &quot;clinical mode&quot; checkbox</span>
<span class="sd">              in the preferences</span>
<span class="sd">            - get_use_fsl: returns the value of &quot;use fsl&quot; checkbox in the</span>
<span class="sd">              preferences</span>
<span class="sd">            - get_use_matlab: returns the value of &quot;use matlab&quot; checkbox in the</span>
<span class="sd">              preferences</span>
<span class="sd">            - get_use_matlab_standalone: returns the value of &quot;use matlab</span>
<span class="sd">              standalone&quot; checkbox in the preferences</span>
<span class="sd">            - get_user_level: get the user level in the Capsul config</span>
<span class="sd">            - get_user_mode: returns the value of &quot;user mode&quot; checkbox</span>
<span class="sd">              in the preferences</span>
<span class="sd">            - get_use_spm: returns the value of &quot;use spm&quot; checkbox in the</span>
<span class="sd">              preferences</span>
<span class="sd">            - get_use_spm_standalone: returns the value of &quot;use spm standalone&quot;</span>
<span class="sd">              checkbox in the preferences</span>
<span class="sd">            - getViewerConfig: returns the DataViewer configuration (neuro or</span>
<span class="sd">              radio), by default neuro</span>
<span class="sd">            - getViewerFramerate: returns the DataViewer framerate for automatic</span>
<span class="sd">              time running images</span>
<span class="sd">            - isAutoSave: checks if auto-save mode is activated</span>
<span class="sd">            - isControlV1: checks if the selected display of the controller is</span>
<span class="sd">              of V1 type</span>
<span class="sd">            - isRadioView: checks if miniviewer in radiological orientation (if</span>
<span class="sd">              not, then it is in neurological orientation)</span>
<span class="sd">            - loadConfig: reads the config in the config.yml file</span>
<span class="sd">            - saveConfig: saves the config to the config.yml file</span>
<span class="sd">            - set_admin_hash: set the password hash</span>
<span class="sd">            - set_afni_path: set the path of the AFNI</span>
<span class="sd">            - set_ants_path: set the path of the ANTS</span>
<span class="sd">            - setAutoSave: sets the auto-save mode</span>
<span class="sd">            - setBackgroundColor: sets the background color</span>
<span class="sd">            - set_capsul_config: set CAPSUL configuration dict into MIA config</span>
<span class="sd">            - setChainCursors: set the &quot;chain cursors&quot; checkbox of the mini</span>
<span class="sd">              viewer</span>
<span class="sd">            - set_clinical_mode: set the value of &quot;clinical mode&quot; in</span>
<span class="sd">              the preferences</span>
<span class="sd">            - setControlV1: Set controller display mode (True if V1)</span>
<span class="sd">            - set_fsl_config: set the path of the FSL config file</span>
<span class="sd">            - set_mainwindow_maximized: set the maximized (fullscreen) flag</span>
<span class="sd">            - set_mainwindow_size: set main window size</span>
<span class="sd">            - set_matlab_path: set the path of Matlab&#39;s executable</span>
<span class="sd">            - set_matlab_standalone_path: set the path of Matlab Compiler</span>
<span class="sd">              Runtime</span>
<span class="sd">            - set_max_projects: set the maximum number of projects displayed in</span>
<span class="sd">              the &quot;Saved projects&quot; menu</span>
<span class="sd">            - set_max_thumbnails: set max thumbnails number at the data browser</span>
<span class="sd">              bottom</span>
<span class="sd">            - set_mri_conv_path: set the MRIManager.jar path</span>
<span class="sd">            - setNbAllSlicesMax: set the maximum number of slices to display in</span>
<span class="sd">              the mini viewer</span>
<span class="sd">            - set_opened_projects: set the opened projects</span>
<span class="sd">            - set_projects_save_path: set the folder where the projects are</span>
<span class="sd">              saved</span>
<span class="sd">            - set_radioView: set the orientation in miniviewer (True for</span>
<span class="sd">              radiological, False for neurological orientation)</span>
<span class="sd">            - set_referential: sets the DataViewer referential</span>
<span class="sd">            - setShowAllSlices: set the &quot;show all slices&quot; checkbox of the mini</span>
<span class="sd">              viewer</span>
<span class="sd">            - setSourceImageDir: set the source directory for project images</span>
<span class="sd">            - set_spm_path: set the path of SPM12 (license version)</span>
<span class="sd">            - set_spm_standalone_path: set the path of SPM12 (standalone</span>
<span class="sd">              version)</span>
<span class="sd">            - setTextColor: set the text color</span>
<span class="sd">            - setThumbnailTag: set the tag that is displayed in the mini viewer</span>
<span class="sd">            - set_use_afni: set the value of &quot;use afni&quot; checkbox in the</span>
<span class="sd">              preferences</span>
<span class="sd">            - set_use_ants: set the value of &quot;use ants&quot; checkbox in the</span>
<span class="sd">              preferences</span>
<span class="sd">            - set_use_fsl: set the value of &quot;use fsl&quot; checkbox in the</span>
<span class="sd">              preferences</span>
<span class="sd">            - set_use_matlab: set the value of &quot;use matlab&quot; checkbox in the</span>
<span class="sd">              preferences</span>
<span class="sd">            - set_use_matlab_standalone: set the value of &quot;use matlab</span>
<span class="sd">              standalone&quot; checkbox in the preferences</span>
<span class="sd">            - set_user_mode: set the value of &quot;user mode&quot; checkbox in</span>
<span class="sd">              the preferences</span>
<span class="sd">            - set_use_spm: set the value of &quot;use spm&quot; checkbox in the</span>
<span class="sd">              preferences</span>
<span class="sd">            - set_use_spm_standalone: set the value of &quot;use spm standalone&quot;</span>
<span class="sd">              checkbox in the preferences</span>
<span class="sd">            - setViewerConfig: set the Viewer configuration neuro or radio</span>
<span class="sd">            - setViewerFramerate: set the Viewer frame rate for automatic</span>
<span class="sd">              running time images</span>
<span class="sd">            - update_capsul_config: update a global CapsulEngine object used</span>
<span class="sd">              for all operations in MIA application</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">capsul_engine</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="Config.__init__"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialization of the Config class</span>

<span class="sd">        :Parameters:</span>
<span class="sd">            - :config_path: str (optional). If provided, the configuration file</span>
<span class="sd">               will be loaded/saved from the given directory. Otherwise, the</span>
<span class="sd">               regular heuristics will be used to determine the config path.</span>
<span class="sd">               This option allows to use an alternative config directory (for</span>
<span class="sd">               tests for instance).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">config_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config_path</span> <span class="o">=</span> <span class="n">config_path</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadConfig</span><span class="p">()</span>

        <span class="k">if</span> <span class="s2">&quot;mia_user_path&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;mia_user_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mia_path</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.get_admin_hash"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_admin_hash">[docs]</a>    <span class="k">def</span> <span class="nf">get_admin_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the value of the hash of the admin password.</span>

<span class="sd">        :returns: string</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;admin_hash&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Config.get_afni_path"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_afni_path">[docs]</a>    <span class="k">def</span> <span class="nf">get_afni_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the AFNI path</span>

<span class="sd">        :returns: string of path to AFNI</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;afni&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_ants_path"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_ants_path">[docs]</a>    <span class="k">def</span> <span class="nf">get_ants_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the ANTS path</span>

<span class="sd">        :returns: string of path to ANTS</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ants&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.getBackgroundColor"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.getBackgroundColor">[docs]</a>    <span class="k">def</span> <span class="nf">getBackgroundColor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get background color.</span>

<span class="sd">        :returns: string of the background color</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;background_color&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_capsul_config"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_capsul_config">[docs]</a>    <span class="k">def</span> <span class="nf">get_capsul_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sync_from_engine</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get CAPSUL config dictionary.</span>

<span class="sd">        :param sync_from_engine: if True, perform a synchronisation</span>
<span class="sd">                                 with CAPSUL engine (Bool)</span>

<span class="sd">        :return: capsul_config: the CAPSUL configuration saved into</span>
<span class="sd">                                Mia config (Dict)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">capsul_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;capsul_config&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">capsul_config</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span>
            <span class="s2">&quot;engine_modules&quot;</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="s2">&quot;nipype&quot;</span><span class="p">,</span>
                <span class="s2">&quot;fsl&quot;</span><span class="p">,</span>
                <span class="s2">&quot;freesurfer&quot;</span><span class="p">,</span>
                <span class="s2">&quot;matlab&quot;</span><span class="p">,</span>
                <span class="s2">&quot;spm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;fom&quot;</span><span class="p">,</span>
                <span class="s2">&quot;python&quot;</span><span class="p">,</span>
                <span class="s2">&quot;afni&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ants&quot;</span><span class="p">,</span>
                <span class="s2">&quot;somaworkflow&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">)</span>
        <span class="n">econf</span> <span class="o">=</span> <span class="n">capsul_config</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;engine&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">eeconf</span> <span class="o">=</span> <span class="n">econf</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;global&quot;</span><span class="p">,</span> <span class="p">{})</span>

        <span class="c1"># Take mia pref parameters</span>
        <span class="n">use_spm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_use_spm</span><span class="p">()</span>
        <span class="n">spm_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spm_path</span><span class="p">()</span>

        <span class="n">use_spm_standalone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_use_spm_standalone</span><span class="p">()</span>
        <span class="n">spm_standalone_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spm_standalone_path</span><span class="p">()</span>

        <span class="n">use_matlab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_use_matlab</span><span class="p">()</span>
        <span class="n">matlab_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matlab_path</span><span class="p">()</span>

        <span class="n">use_matlab_standalone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_use_matlab_standalone</span><span class="p">()</span>
        <span class="n">matlab_standalone_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_matlab_standalone_path</span><span class="p">()</span>

        <span class="n">use_fsl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_use_fsl</span><span class="p">()</span>
        <span class="n">fsl_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fsl_config</span><span class="p">()</span>

        <span class="n">use_afni</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_use_afni</span><span class="p">()</span>
        <span class="n">afni_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_afni_path</span><span class="p">()</span>

        <span class="n">use_ants</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_use_ants</span><span class="p">()</span>
        <span class="n">ants_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ants_path</span><span class="p">()</span>

        <span class="c1"># Make synchronisation from Mia pref to Capsul config:</span>

        <span class="c1"># TODO: We do not deal with the version parameter. This can produce</span>
        <span class="c1">#       hidden configurations (spm and spm12 and spm8 ...)!</span>

        <span class="c1"># SPM</span>
        <span class="n">spm_configs</span> <span class="o">=</span> <span class="n">eeconf</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;capsul.engine.module.spm&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="n">use_spm_standalone</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">config_id</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">spm_configs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">m</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;standalone&quot;</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="n">m</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;directory&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">spm_standalone_path</span>
                <span class="p">):</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
                <span class="n">config_id</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;config_id&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">config_id</span> <span class="o">=</span> <span class="s2">&quot;spm-standalone&quot;</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">spm_configs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">config_id</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;config_id&quot;</span><span class="p">:</span> <span class="n">config_id</span><span class="p">,</span>
                    <span class="s2">&quot;config_environment&quot;</span><span class="p">:</span> <span class="s2">&quot;global&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;directory&quot;</span><span class="p">:</span> <span class="n">spm_standalone_path</span><span class="p">,</span>
                    <span class="s2">&quot;standalone&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">use_spm</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">config_id</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">spm_configs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">m</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;standalone&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">m</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;directory&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">spm_path</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
                <span class="n">config_id</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="s2">&quot;config_id&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">config_id</span> <span class="o">=</span> <span class="s2">&quot;spm&quot;</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">spm_configs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">config_id</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">m</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;config_id&quot;</span><span class="p">:</span> <span class="n">config_id</span><span class="p">,</span>
                    <span class="s2">&quot;config_environment&quot;</span><span class="p">:</span> <span class="s2">&quot;global&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;directory&quot;</span><span class="p">:</span> <span class="n">spm_path</span><span class="p">,</span>
                    <span class="s2">&quot;standalone&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="c1"># MATLAB</span>
        <span class="k">if</span> <span class="n">use_matlab_standalone</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">eeconf</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span>
                <span class="s2">&quot;capsul.engine.module.matlab&quot;</span><span class="p">,</span> <span class="p">{}</span>
            <span class="p">)</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;matlab&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">m</span><span class="p">[</span><span class="s2">&quot;mcr_directory&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">matlab_standalone_path</span>
            <span class="n">m</span><span class="p">[</span><span class="s2">&quot;config_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;matlab&quot;</span>
            <span class="n">m</span><span class="p">[</span><span class="s2">&quot;config_environment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;global&quot;</span>

        <span class="k">if</span> <span class="n">use_matlab</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">eeconf</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span>
                <span class="s2">&quot;capsul.engine.module.matlab&quot;</span><span class="p">,</span> <span class="p">{}</span>
            <span class="p">)</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;matlab&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">m</span><span class="p">[</span><span class="s2">&quot;executable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">matlab_path</span>
            <span class="n">m</span><span class="p">[</span><span class="s2">&quot;config_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;matlab&quot;</span>
            <span class="n">m</span><span class="p">[</span><span class="s2">&quot;config_environment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;global&quot;</span>

        <span class="c1"># FSL</span>
        <span class="k">if</span> <span class="n">use_fsl</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">eeconf</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;capsul.engine.module.fsl&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span>
                <span class="s2">&quot;fsl&quot;</span><span class="p">,</span> <span class="p">{}</span>
            <span class="p">)</span>
            <span class="n">m</span><span class="p">[</span><span class="s2">&quot;config_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;fsl&quot;</span>
            <span class="n">m</span><span class="p">[</span><span class="s2">&quot;config_environment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;global&quot;</span>
            <span class="n">m</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fsl_config</span>
            <span class="n">m</span><span class="p">[</span><span class="s2">&quot;directory&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">fsl_config</span><span class="p">))</span>
            <span class="p">)</span>

        <span class="c1"># AFNI</span>
        <span class="k">if</span> <span class="n">use_afni</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">eeconf</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;capsul.engine.module.afni&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span>
                <span class="s2">&quot;afni&quot;</span><span class="p">,</span> <span class="p">{}</span>
            <span class="p">)</span>
            <span class="n">m</span><span class="p">[</span><span class="s2">&quot;config_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;afni&quot;</span>
            <span class="n">m</span><span class="p">[</span><span class="s2">&quot;config_environment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;global&quot;</span>
            <span class="n">m</span><span class="p">[</span><span class="s2">&quot;directory&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">afni_path</span>

        <span class="c1"># ANTS</span>
        <span class="k">if</span> <span class="n">use_ants</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">eeconf</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;capsul.engine.module.ants&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span>
                <span class="s2">&quot;ants&quot;</span><span class="p">,</span> <span class="p">{}</span>
            <span class="p">)</span>
            <span class="n">m</span><span class="p">[</span><span class="s2">&quot;config_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ants&quot;</span>
            <span class="n">m</span><span class="p">[</span><span class="s2">&quot;config_environment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;global&quot;</span>
            <span class="n">m</span><span class="p">[</span><span class="s2">&quot;directory&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ants_path</span>

        <span class="c1"># attributes completion</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">eeconf</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span>
            <span class="s2">&quot;capsul.engine.module.attributes&quot;</span><span class="p">,</span> <span class="p">{}</span>
        <span class="p">)</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;attributes&quot;</span><span class="p">,</span> <span class="p">{})</span>
        <span class="n">m</span><span class="p">[</span><span class="s2">&quot;config_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;attributes&quot;</span>
        <span class="n">m</span><span class="p">[</span><span class="s2">&quot;config_environment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;global&quot;</span>
        <span class="n">m</span><span class="p">[</span><span class="s2">&quot;attributes_schema_paths&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;capsul.attributes.completion_engine_factory&quot;</span><span class="p">,</span>
            <span class="s2">&quot;populse_mia.user_interface.pipeline_manager.process_mia&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">m</span><span class="p">[</span><span class="s2">&quot;process_completion&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mia_completion&quot;</span>

        <span class="c1"># Synchronise from engine, or not</span>
        <span class="k">if</span> <span class="n">sync_from_engine</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">capsul_engine</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">environment</span> <span class="ow">in</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">capsul_engine</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">get_all_environments</span>
            <span class="p">)():</span>
                <span class="n">eeconf</span> <span class="o">=</span> <span class="n">econf</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">environment</span><span class="p">,</span> <span class="p">{})</span>
                <span class="c1"># would need a better merging system</span>
                <span class="n">eeconf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">capsul_engine</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">export_config_dict</span><span class="p">(</span>
                        <span class="n">environment</span>
                    <span class="p">)[</span><span class="n">environment</span><span class="p">]</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">capsul_config</span></div>

<div class="viewcode-block" id="Config.get_capsul_engine"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_capsul_engine">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_capsul_engine</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a global CapsulEngine object used for all operations in MIA</span>
<span class="sd">        application. The engine is created once when needed.</span>

<span class="sd">        :returns: Config.capsul_engine: capsul.engine.CapsulEngine object</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
        <span class="n">config</span><span class="o">.</span><span class="n">get_capsul_config</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">Config</span><span class="o">.</span><span class="n">capsul_engine</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">Config</span><span class="o">.</span><span class="n">capsul_engine</span> <span class="o">=</span> <span class="n">capsul_engine</span><span class="p">()</span>
            <span class="n">Config</span><span class="p">()</span><span class="o">.</span><span class="n">update_capsul_config</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">Config</span><span class="o">.</span><span class="n">capsul_engine</span></div>

<div class="viewcode-block" id="Config.getChainCursors"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.getChainCursors">[docs]</a>    <span class="k">def</span> <span class="nf">getChainCursors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the value of the checkbox &#39;chain cursor&#39; in miniviewer.</span>

<span class="sd">        :returns: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;chain_cursors&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_config_path"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_config_path">[docs]</a>    <span class="k">def</span> <span class="nf">get_config_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the MIA config path (including &quot;properties&quot; directory)</span>

<span class="sd">        :returns: string of directory path to the config.yml file</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">config_path</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;config_path&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">config_path</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">config_path</span>

        <span class="n">mia_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mia_path</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mia_path</span><span class="p">,</span> <span class="s2">&quot;properties&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_fsl_config"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_fsl_config">[docs]</a>    <span class="k">def</span> <span class="nf">get_fsl_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the FSL config file  path</span>

<span class="sd">        :returns: string of path to the fsl/etc/fslconf/fsl.sh file</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;fsl_config&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_mainwindow_maximized"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_mainwindow_maximized">[docs]</a>    <span class="k">def</span> <span class="nf">get_mainwindow_maximized</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the maximized (fullscreen) flag</span>

<span class="sd">        :returns:  boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mainwindow_maximized&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_mainwindow_size"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_mainwindow_size">[docs]</a>    <span class="k">def</span> <span class="nf">get_mainwindow_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the main window size</span>

<span class="sd">        :returns:  list or None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mainwindow_size&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_matlab_command"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_matlab_command">[docs]</a>    <span class="k">def</span> <span class="nf">get_matlab_command</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Matlab command.</span>

<span class="sd">        :returns: matlab executable path or nothing if matlab path not specified</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_spm_standalone&quot;</span><span class="p">):</span>
            <span class="n">archi</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">architecture</span><span class="p">()</span>
            <span class="k">if</span> <span class="s2">&quot;Windows&quot;</span> <span class="ow">in</span> <span class="n">archi</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">spm_script</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;spm_standalone&quot;</span><span class="p">],</span>
                        <span class="s2">&quot;spm*_win&quot;</span> <span class="o">+</span> <span class="n">archi</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.exe&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">spm_script</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;spm_standalone&quot;</span><span class="p">],</span> <span class="s2">&quot;run_spm*.sh&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">spm_script</span><span class="p">:</span>
                <span class="n">spm_script</span> <span class="o">=</span> <span class="n">spm_script</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> </span><span class="si">{1}</span><span class="s2"> script&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">spm_script</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;matlab_standalone&quot;</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;&quot;</span>  <span class="c1"># will not work.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;matlab&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_matlab_path"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_matlab_path">[docs]</a>    <span class="k">def</span> <span class="nf">get_matlab_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the path to the matlab executable.</span>

<span class="sd">        :returns: String of path</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;matlab&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_matlab_standalone_path"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_matlab_standalone_path">[docs]</a>    <span class="k">def</span> <span class="nf">get_matlab_standalone_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the path to matlab compiler runtime.</span>

<span class="sd">        :returns: string of path</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;matlab_standalone&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_max_projects"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_max_projects">[docs]</a>    <span class="k">def</span> <span class="nf">get_max_projects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the maximum number of projects displayed in the &quot;Saved</span>
<span class="sd">        projects&quot; menu.</span>

<span class="sd">        :returns: Integer</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;max_projects&quot;</span><span class="p">])</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">5</span></div>

<div class="viewcode-block" id="Config.get_max_thumbnails"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_max_thumbnails">[docs]</a>    <span class="k">def</span> <span class="nf">get_max_thumbnails</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the max thumbnails number at the data browser bottom.</span>

<span class="sd">        :returns: Integer</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;max_thumbnails&quot;</span><span class="p">])</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">5</span></div>

<div class="viewcode-block" id="Config.get_mia_path"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_mia_path">[docs]</a>    <span class="k">def</span> <span class="nf">get_mia_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the path to the folder containing the processes, properties</span>
<span class="sd">        and resources folders of mia (mia_path).</span>

<span class="sd">        During the mia installation, the mia_path is defined and stored in the</span>
<span class="sd">        configuration.yml file, located in the .populse_mia folder (himself</span>
<span class="sd">        located in the user&#39;s home). If mia is launched in admin mode,</span>
<span class="sd">        mia path is the cloned git repository. If mia is launched in user</span>
<span class="sd">        mode, mia path must compulsorily be returned from the mia_path</span>
<span class="sd">        parameter of the configuration.yml</span>

<span class="sd">        :returns: string of path to mia folder</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">mia_path</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;mia_path&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mia_path</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">mia_path</span>

        <span class="n">dot_mia_config</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s2">&quot;~&quot;</span><span class="p">),</span> <span class="s2">&quot;.populse_mia&quot;</span><span class="p">,</span> <span class="s2">&quot;configuration.yml&quot;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">dot_mia_config</span><span class="p">):</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dot_mia_config</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">stream</span><span class="p">:</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">verCmp</span><span class="p">(</span><span class="n">yaml</span><span class="o">.</span><span class="n">__version__</span><span class="p">,</span> <span class="s2">&quot;5.1&quot;</span><span class="p">,</span> <span class="s2">&quot;sup&quot;</span><span class="p">):</span>
                        <span class="n">mia_home_config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
                            <span class="n">stream</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">mia_home_config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>

                    <span class="k">if</span> <span class="p">(</span>
                        <span class="s2">&quot;user_mode&quot;</span> <span class="ow">in</span> <span class="n">mia_home_config</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                        <span class="ow">and</span> <span class="n">mia_home_config</span><span class="p">[</span><span class="s2">&quot;user_mode&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span>
                    <span class="p">):</span>
                        <span class="c1"># Only for admin mode</span>
                        <span class="n">config_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span>
                            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
                        <span class="p">)</span>

                        <span class="k">while</span> <span class="s2">&quot;properties&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">config_path</span><span class="p">):</span>
                            <span class="n">config_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">mia_path</span> <span class="o">=</span> <span class="n">config_path</span>
                        <span class="k">return</span> <span class="n">config_path</span>

                    <span class="c1"># Only for user mode</span>
                    <span class="c1"># mia_path is obsolete. Use mia_user_path instead</span>
                    <span class="k">if</span> <span class="s2">&quot;mia_path&quot;</span> <span class="ow">in</span> <span class="n">mia_home_config</span><span class="p">:</span>
                        <span class="n">mia_home_config</span><span class="p">[</span><span class="s2">&quot;mia_user_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mia_home_config</span><span class="p">[</span>
                            <span class="s2">&quot;mia_path&quot;</span>
                        <span class="p">]</span>
                        <span class="k">del</span> <span class="n">mia_home_config</span><span class="p">[</span><span class="s2">&quot;mia_path&quot;</span><span class="p">]</span>

                        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span>
                            <span class="n">dot_mia_config</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf8&quot;</span>
                        <span class="p">)</span> <span class="k">as</span> <span class="n">configfile</span><span class="p">:</span>
                            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span>
                                <span class="n">mia_home_config</span><span class="p">,</span>
                                <span class="n">configfile</span><span class="p">,</span>
                                <span class="n">default_flow_style</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                <span class="n">allow_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">mia_path</span> <span class="o">=</span> <span class="n">mia_home_config</span><span class="p">[</span><span class="s2">&quot;mia_user_path&quot;</span><span class="p">]</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mia_path</span>

                <span class="k">except</span> <span class="p">(</span><span class="n">yaml</span><span class="o">.</span><span class="n">YAMLError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mia path (where is located the processes, &quot;</span>
                        <span class="s2">&quot;the properties and resources folders) has not &quot;</span>
                        <span class="s2">&quot;been found ...&quot;</span>
                    <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Only for admin mode</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mia_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;mia_user_path&quot;</span><span class="p">]</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mia_path</span>

            <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
                <span class="n">config_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>

                <span class="k">while</span> <span class="s2">&quot;properties&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">config_path</span><span class="p">):</span>
                    <span class="n">config_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">mia_path</span> <span class="o">=</span> <span class="n">config_path</span>
                <span class="k">return</span> <span class="n">config_path</span></div>

<div class="viewcode-block" id="Config.get_mri_conv_path"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_mri_conv_path">[docs]</a>    <span class="k">def</span> <span class="nf">get_mri_conv_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the MRIManager.jar path.</span>

<span class="sd">        :returns: string of the pathto the MRIManager.jar</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mri_conv_path&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.getNbAllSlicesMax"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.getNbAllSlicesMax">[docs]</a>    <span class="k">def</span> <span class="nf">getNbAllSlicesMax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get number the maximum number of slices to display in the</span>
<span class="sd">        miniviewer.</span>

<span class="sd">        :returns: Integer</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nb_slices_max&quot;</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">))</span></div>

<div class="viewcode-block" id="Config.get_opened_projects"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_opened_projects">[docs]</a>    <span class="k">def</span> <span class="nf">get_opened_projects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get opened projects.</span>

<span class="sd">        :returns: list of opened projects</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;opened_projects&quot;</span><span class="p">,</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="Config.getPathToProjectsFolder"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.getPathToProjectsFolder">[docs]</a>    <span class="k">def</span> <span class="nf">getPathToProjectsFolder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the project&#39;s path.</span>

<span class="sd">        :returns: string of the path</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;projects_save_path&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_projects_save_path"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_projects_save_path">[docs]</a>    <span class="k">def</span> <span class="nf">get_projects_save_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the path where projects are saved.</span>

<span class="sd">        :returns: string of path</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;projects_save_path&quot;</span><span class="p">]</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="c1"># if not os.path.isdir(</span>
            <span class="c1">#         os.path.join(self.get_mia_path(), &#39;projects&#39;)):</span>
            <span class="c1">#     os.mkdir(os.path.join(self.get_mia_path(), &#39;projects&#39;))</span>
            <span class="c1">#</span>
            <span class="c1"># return os.path.join(self.get_mia_path(), &#39;projects&#39;)</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span></div>

<div class="viewcode-block" id="Config.get_referential"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_referential">[docs]</a>    <span class="k">def</span> <span class="nf">get_referential</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks in anatomist_2 data viewer which referential has been chosen</span>

<span class="sd">        :returns: 0 for World Coordinates, 1 for Image ref</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ref&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.getShowAllSlices"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.getShowAllSlices">[docs]</a>    <span class="k">def</span> <span class="nf">getShowAllSlices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get whether the show_all_slices parameters was enabled</span>
<span class="sd">        or not in the miniviewer.</span>

<span class="sd">        :returns: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Used in MiniViewer</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;show_all_slices&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.getSourceImageDir"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.getSourceImageDir">[docs]</a>    <span class="k">def</span> <span class="nf">getSourceImageDir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the source directory for project images.</span>

<span class="sd">        :returns: string of the path</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;source_image_dir&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_spm_path"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_spm_path">[docs]</a>    <span class="k">def</span> <span class="nf">get_spm_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the path of SPM12.</span>

<span class="sd">        :returns: string of path</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;spm&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_spm_standalone_path"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_spm_standalone_path">[docs]</a>    <span class="k">def</span> <span class="nf">get_spm_standalone_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the path to the SPM12 (standalone version).</span>

<span class="sd">        :returns: String of path</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;spm_standalone&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.getTextColor"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.getTextColor">[docs]</a>    <span class="k">def</span> <span class="nf">getTextColor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the text color.</span>

<span class="sd">        :returns: string</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text_color&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.getThumbnailTag"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.getThumbnailTag">[docs]</a>    <span class="k">def</span> <span class="nf">getThumbnailTag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the tag of the thumbnail displayed in the miniviewer.</span>

<span class="sd">        :returns: string</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;thumbnail_tag&quot;</span><span class="p">,</span> <span class="s2">&quot;SequenceName&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_use_afni"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_use_afni">[docs]</a>    <span class="k">def</span> <span class="nf">get_use_afni</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the value of &quot;use afni&quot; checkbox in the preferences.</span>

<span class="sd">        :returns: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_afni&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_use_ants"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_use_ants">[docs]</a>    <span class="k">def</span> <span class="nf">get_use_ants</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the value of &quot;use ants&quot; checkbox in the preferences.</span>

<span class="sd">        :returns: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_ants&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_use_clinical"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_use_clinical">[docs]</a>    <span class="k">def</span> <span class="nf">get_use_clinical</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the clinical mode in the preferences.</span>

<span class="sd">        :returns: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;clinical_mode&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_use_fsl"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_use_fsl">[docs]</a>    <span class="k">def</span> <span class="nf">get_use_fsl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the value of &quot;use fsl&quot; checkbox in the preferences.</span>

<span class="sd">        :returns: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_fsl&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_use_matlab"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_use_matlab">[docs]</a>    <span class="k">def</span> <span class="nf">get_use_matlab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the value of &quot;use matlab&quot; checkbox in the preferences.</span>

<span class="sd">        :returns: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_matlab&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_use_matlab_standalone"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_use_matlab_standalone">[docs]</a>    <span class="k">def</span> <span class="nf">get_use_matlab_standalone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the value of &quot;use matlab standalone&quot; checkbox in the</span>
<span class="sd">        preferences.</span>

<span class="sd">        :returns: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_matlab_standalone&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_user_level"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_user_level">[docs]</a>    <span class="k">def</span> <span class="nf">get_user_level</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the user level in the Capsul config</span>

<span class="sd">        :returns: integer</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;capsul_config&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;engine&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;global&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;capsul.engine.module.axon&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;user_level&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_user_mode"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_user_mode">[docs]</a>    <span class="k">def</span> <span class="nf">get_user_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get if user mode is disabled or enabled in the preferences.</span>

<span class="sd">        :returns: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;user_mode&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_use_spm"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_use_spm">[docs]</a>    <span class="k">def</span> <span class="nf">get_use_spm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the value of &quot;use spm&quot; checkbox in the preferences.</span>

<span class="sd">        :returns: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_spm&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.get_use_spm_standalone"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.get_use_spm_standalone">[docs]</a>    <span class="k">def</span> <span class="nf">get_use_spm_standalone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the value of &quot;use spm standalone&quot; checkbox in the preferences.</span>

<span class="sd">        :returns: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_spm_standalone&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.getViewerConfig"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.getViewerConfig">[docs]</a>    <span class="k">def</span> <span class="nf">getViewerConfig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the viewer config neuro or radio, neuro by default</span>

<span class="sd">        :returns: String</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;config_NeuRad&quot;</span><span class="p">,</span> <span class="s2">&quot;neuro&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.getViewerFramerate"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.getViewerFramerate">[docs]</a>    <span class="k">def</span> <span class="nf">getViewerFramerate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the Viewer framerate</span>

<span class="sd">        :returns: integer</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;im_sec&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.isAutoSave"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.isAutoSave">[docs]</a>    <span class="k">def</span> <span class="nf">isAutoSave</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get if the auto-save mode is enabled or not.</span>

<span class="sd">        :returns: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;auto_save&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.isControlV1"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.isControlV1">[docs]</a>    <span class="k">def</span> <span class="nf">isControlV1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get if the display of the controller is of V1 type.</span>

<span class="sd">        :returns: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;control_V1&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.isRadioView"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.isRadioView">[docs]</a>    <span class="k">def</span> <span class="nf">isRadioView</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get if the display in miniviewer is in radiological orientation.</span>

<span class="sd">        - True for radiological</span>
<span class="sd">        - False for neurological</span>

<span class="sd">        :returns: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;radio_view&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="Config.loadConfig"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.loadConfig">[docs]</a>    <span class="k">def</span> <span class="nf">loadConfig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read the config in the config.yml file.</span>

<span class="sd">        :returns: Returns a dictionary of the contents of config.yml</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">Fernet</span><span class="p">(</span><span class="n">CONFIG</span><span class="p">)</span>
        <span class="n">config_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_config_path</span><span class="p">(),</span> <span class="s2">&quot;config.yml&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">config_file</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{}</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">stream</span><span class="p">:</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">stream</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">readlines</span><span class="p">())</span>
                <span class="n">decrypted</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">verCmp</span><span class="p">(</span><span class="n">yaml</span><span class="o">.</span><span class="n">__version__</span><span class="p">,</span> <span class="s2">&quot;5.1&quot;</span><span class="p">,</span> <span class="s2">&quot;sup&quot;</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">decrypted</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">decrypted</span><span class="p">)</span>

            <span class="k">except</span> <span class="n">yaml</span><span class="o">.</span><span class="n">YAMLError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error loading YAML file: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">config_file</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>

        <span class="c1"># in case of problem, return an empty config</span>
        <span class="k">return</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="Config.saveConfig"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.saveConfig">[docs]</a>    <span class="k">def</span> <span class="nf">saveConfig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save the current parameters in the config.yml file.&quot;&quot;&quot;</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">Fernet</span><span class="p">(</span><span class="n">CONFIG</span><span class="p">)</span>
        <span class="n">config_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_config_path</span><span class="p">(),</span> <span class="s2">&quot;config.yml&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">config_file</span><span class="p">)):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">config_file</span><span class="p">))</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">configfile</span><span class="p">:</span>
            <span class="n">stream</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="n">default_flow_style</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_unicode</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="n">configfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">stream</span><span class="o">.</span><span class="n">encode</span><span class="p">()))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_capsul_config</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_admin_hash"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_admin_hash">[docs]</a>    <span class="k">def</span> <span class="nf">set_admin_hash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">admin_hash</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the password hash.</span>

<span class="sd">        :param admin_hash: string of hash</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;admin_hash&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">admin_hash</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_afni_path"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_afni_path">[docs]</a>    <span class="k">def</span> <span class="nf">set_afni_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the AFNI path</span>

<span class="sd">        :param path: string of AFNI path</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;afni&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_ants_path"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_ants_path">[docs]</a>    <span class="k">def</span> <span class="nf">set_ants_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the ANTS path</span>

<span class="sd">        :param path: string of ANTS path</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;ants&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.setAutoSave"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.setAutoSave">[docs]</a>    <span class="k">def</span> <span class="nf">setAutoSave</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">save</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set auto-save mode.</span>

<span class="sd">        :param save: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;auto_save&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">save</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.setBackgroundColor"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.setBackgroundColor">[docs]</a>    <span class="k">def</span> <span class="nf">setBackgroundColor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set background color and save configuration.</span>

<span class="sd">        :param color: Color string (&#39;Black&#39;, &#39;Blue&#39;, &#39;Green&#39;, &#39;Grey&#39;,</span>
<span class="sd">                                    &#39;Orange&#39;, &#39;Red&#39;, &#39;Yellow&#39;, &#39;White&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;background_color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_capsul_config"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_capsul_config">[docs]</a>    <span class="k">def</span> <span class="nf">set_capsul_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">capsul_config_dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set CAPSUL configuration dict into MIA config.</span>

<span class="sd">        This method is used just (and only) after editing capsul config</span>
<span class="sd">        (in File &gt; Mia preferences, Pipeline tab, Edit CAPSUL config button),</span>
<span class="sd">        in order to synchronise the new Capsul config with the Mia preferences.</span>

<span class="sd">        :param capsul_config_dict: a dict; {&#39;engine&#39;: {...},</span>
<span class="sd">                                            &#39;engine_modules&#39;: [...]}</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;capsul_config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">capsul_config_dict</span>

        <span class="c1"># update MIA values</span>
        <span class="n">engine_config</span> <span class="o">=</span> <span class="n">capsul_config_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;engine&quot;</span><span class="p">)</span>
        <span class="n">new_engine</span> <span class="o">=</span> <span class="n">capsul_engine</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">environment</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">engine_config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

            <span class="k">if</span> <span class="n">environment</span> <span class="o">==</span> <span class="s2">&quot;capsul_engine&quot;</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">new_engine</span><span class="o">.</span><span class="n">import_configs</span><span class="p">(</span><span class="n">environment</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>

        <span class="n">engine_config</span> <span class="o">=</span> <span class="n">new_engine</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">export_config_dict</span><span class="p">(</span><span class="s2">&quot;global&quot;</span><span class="p">)</span>

        <span class="c1"># afni</span>
        <span class="n">afni</span> <span class="o">=</span> <span class="n">engine_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;global&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;capsul.engine.module.afni&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">afni</span><span class="p">:</span>
            <span class="n">afni</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">afni</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">afni_path</span> <span class="o">=</span> <span class="n">afni</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;directory&quot;</span><span class="p">)</span>
            <span class="n">use_afni</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">afni_path</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">afni_path</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_afni_path</span><span class="p">(</span><span class="n">afni_path</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_afni</span><span class="p">(</span><span class="n">use_afni</span><span class="p">)</span>

        <span class="c1"># ants</span>
        <span class="n">ants</span> <span class="o">=</span> <span class="n">engine_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;global&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;capsul.engine.module.ants&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ants</span><span class="p">:</span>
            <span class="n">ants</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">ants_path</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;directory&quot;</span><span class="p">)</span>
            <span class="n">use_ants</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">ants_path</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">ants_path</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_ants_path</span><span class="p">(</span><span class="n">ants_path</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_ants</span><span class="p">(</span><span class="n">use_ants</span><span class="p">)</span>

        <span class="c1"># fsl</span>
        <span class="n">fsl</span> <span class="o">=</span> <span class="n">engine_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;global&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;capsul.engine.module.fsl&quot;</span><span class="p">)</span>
        <span class="n">use_fsl</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">fsl</span><span class="p">:</span>
            <span class="n">fsl</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">fsl</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">fsl_conf_path</span> <span class="o">=</span> <span class="n">fsl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;config&quot;</span><span class="p">)</span>
            <span class="n">fsl_dir_path</span> <span class="o">=</span> <span class="n">fsl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;directory&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">fsl_conf_path</span><span class="p">:</span>
                <span class="n">use_fsl</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_fsl_config</span><span class="p">(</span><span class="n">fsl_conf_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_use_fsl</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># If only the directory parameter has been set, let&#39;s try using</span>
            <span class="c1"># the config parameter = directory/etc/fslconf/fsl.sh:</span>
            <span class="k">elif</span> <span class="n">fsl_dir_path</span><span class="p">:</span>
                <span class="n">fsl_conf</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">fsl_dir_path</span><span class="p">,</span> <span class="s2">&quot;etc&quot;</span><span class="p">,</span> <span class="s2">&quot;fslconf&quot;</span><span class="p">,</span> <span class="s2">&quot;fsl.sh&quot;</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fsl_conf</span><span class="p">):</span>
                    <span class="n">use_fsl</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_fsl_config</span><span class="p">(</span><span class="n">fsl_conf</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_use_fsl</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The automatic determination of the configuration &quot;</span>
                        <span class="s2">&quot;file from the directory known for fsl (</span><span class="si">{}</span><span class="s2">) did not &quot;</span>
                        <span class="s2">&quot;work. FSL is not correctly defined in the &quot;</span>
                        <span class="s2">&quot;preferences (see File &gt; Mia Preferences) &quot;</span>
                        <span class="s2">&quot;...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fsl_dir_path</span><span class="p">)</span>
                    <span class="p">)</span>

        <span class="k">if</span> <span class="n">use_fsl</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_fsl</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># matlab</span>
        <span class="n">matlab</span> <span class="o">=</span> <span class="n">engine_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;global&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;capsul.engine.module.matlab&quot;</span>
        <span class="p">)</span>
        <span class="n">use_matlab</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">use_mcr</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">matlab</span><span class="p">:</span>
            <span class="n">matlab</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">matlab</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">matlab_path</span> <span class="o">=</span> <span class="n">matlab</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;executable&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">matlab_path</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">matlab_path</span><span class="p">):</span>
                <span class="n">use_matlab</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="n">mcr_dir</span> <span class="o">=</span> <span class="n">matlab</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mcr_directory&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">mcr_dir</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">mcr_dir</span><span class="p">):</span>
                <span class="n">use_mcr</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># spm</span>
        <span class="n">spm</span> <span class="o">=</span> <span class="n">engine_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;global&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;capsul.engine.module.spm&quot;</span><span class="p">)</span>
        <span class="n">use_spm_standalone</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">use_spm</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">spm</span><span class="p">:</span>
            <span class="c1"># TODO: we only take the first element of the dictionary (the one</span>
            <span class="c1">#       that is normally edited in the Capsul config GUI). There is</span>
            <span class="c1">#       actually a problem because this means that there may be</span>
            <span class="c1">#       hidden config(s) ... This can produce bugs and at least</span>
            <span class="c1">#       unpredictable results for the user ...</span>

            <span class="n">spm</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">spm</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="n">spm_dir</span> <span class="o">=</span> <span class="n">spm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;directory&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">use_spm_standalone</span> <span class="o">=</span> <span class="n">spm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;standalone&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">use_spm_standalone</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">spm_dir</span><span class="p">)</span> <span class="ow">and</span> <span class="n">use_mcr</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">use_spm_standalone</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">use_spm_standalone</span> <span class="ow">is</span> <span class="kc">False</span>
                <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">spm_dir</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">use_matlab</span>
            <span class="p">):</span>
                <span class="n">use_spm</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">use_spm</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">use_spm</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_spm_path</span><span class="p">(</span><span class="n">spm_dir</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_spm</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_spm_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_matlab_path</span><span class="p">(</span><span class="n">matlab_path</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_matlab</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_matlab_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">use_spm_standalone</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_spm_standalone_path</span><span class="p">(</span><span class="n">spm_dir</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_spm_standalone</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_spm</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_matlab_standalone_path</span><span class="p">(</span><span class="n">mcr_dir</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_matlab_standalone</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_matlab</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># TODO: Because there are two parameters for matlab (executable and</span>
        <span class="c1">#  mcr_directory) in Capsul config, if the user defines both, we don&#39;t</span>
        <span class="c1">#  know which on to choose! Here we choose to favour matlab in front</span>
        <span class="c1">#  of MCR if both are chosen, is it desirable?</span>
        <span class="k">elif</span> <span class="n">use_matlab</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_matlab_path</span><span class="p">(</span><span class="n">matlab_path</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_matlab</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_matlab_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_spm</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_spm_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">use_mcr</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_matlab_standalone_path</span><span class="p">(</span><span class="n">mcr_dir</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_matlab_standalone</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_matlab</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_spm</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_spm_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_matlab</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_matlab_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_spm</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_use_spm_standalone</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">use_matlab</span>
            <span class="ow">and</span> <span class="n">use_mcr</span>
            <span class="ow">and</span> <span class="n">use_spm</span> <span class="ow">is</span> <span class="kc">False</span>
            <span class="ow">and</span> <span class="n">use_spm_standalone</span> <span class="ow">is</span> <span class="kc">False</span>
        <span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> The Matlab executable and the mcr_directory parameters &quot;</span>
                <span class="s2">&quot;have been set concomitantly in the Capsul configuration. &quot;</span>
                <span class="s2">&quot;This leads to an indeterminacy. By default, Matlab is &quot;</span>
                <span class="s2">&quot;retained at the expense of MCR.&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_capsul_config</span><span class="p">()</span>  <span class="c1"># store into capsul engine</span></div>

<div class="viewcode-block" id="Config.setChainCursors"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.setChainCursors">[docs]</a>    <span class="k">def</span> <span class="nf">setChainCursors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chain_cursors</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the value of the checkbox &#39;chain cursor&#39; in the mini viewer.</span>

<span class="sd">        :param chain_cursors: Boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;chain_cursors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">chain_cursors</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_clinical_mode"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_clinical_mode">[docs]</a>    <span class="k">def</span> <span class="nf">set_clinical_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clinical_mode</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enable of disable clinical mode.</span>

<span class="sd">        :param clinical_mode: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;clinical_mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clinical_mode</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.setControlV1"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.setControlV1">[docs]</a>    <span class="k">def</span> <span class="nf">setControlV1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controlV1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set controller display mode (True if V1).</span>

<span class="sd">        :param controlV1: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;control_V1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">controlV1</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_fsl_config"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_fsl_config">[docs]</a>    <span class="k">def</span> <span class="nf">set_fsl_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set  the FSL config file</span>

<span class="sd">        :param path: string of path to fsl/etc/fslconf/fsl.sh</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;fsl_config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_mainwindow_maximized"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_mainwindow_maximized">[docs]</a>    <span class="k">def</span> <span class="nf">set_mainwindow_maximized</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enabled</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the maximized (full-screen) flag</span>

<span class="sd">        :param enabled: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;mainwindow_maximized&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enabled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_mainwindow_size"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_mainwindow_size">[docs]</a>    <span class="k">def</span> <span class="nf">set_mainwindow_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set main window size</span>

<span class="sd">        :param size: list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;mainwindow_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_matlab_path"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_matlab_path">[docs]</a>    <span class="k">def</span> <span class="nf">set_matlab_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the path of Matlab&#39;s executable.</span>

<span class="sd">        :param path: string of path</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;matlab&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_matlab_standalone_path"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_matlab_standalone_path">[docs]</a>    <span class="k">def</span> <span class="nf">set_matlab_standalone_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the path of Matlab Compiler Runtime.</span>

<span class="sd">        :param path: string of path</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;matlab_standalone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_max_projects"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_max_projects">[docs]</a>    <span class="k">def</span> <span class="nf">set_max_projects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nb_max_projects</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the maximum number of projects displayed in</span>
<span class="sd">        the &quot;Saved projects&quot; menu.</span>

<span class="sd">        :param nb_max_projects: Integer</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;max_projects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nb_max_projects</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_max_thumbnails"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_max_thumbnails">[docs]</a>    <span class="k">def</span> <span class="nf">set_max_thumbnails</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nb_max_thumbnails</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set max thumbnails number at the data browser bottom.</span>

<span class="sd">        :param nb_max_thumbnails: Integer</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;max_thumbnails&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nb_max_thumbnails</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_mri_conv_path"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_mri_conv_path">[docs]</a>    <span class="k">def</span> <span class="nf">set_mri_conv_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the MRIManager.jar path.</span>

<span class="sd">        :param path: string of the path</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;mri_conv_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.setNbAllSlicesMax"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.setNbAllSlicesMax">[docs]</a>    <span class="k">def</span> <span class="nf">setNbAllSlicesMax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nb_slices_max</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the number of slices to display in the mini viewer.</span>

<span class="sd">        :param nb_slices_max: maximum number of slices to display (Int)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;nb_slices_max&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nb_slices_max</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_opened_projects"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_opened_projects">[docs]</a>    <span class="k">def</span> <span class="nf">set_opened_projects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_projects</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the list of opened projects and saves the modification.</span>

<span class="sd">        :param new_projects: list of path</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;opened_projects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_projects</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_projects_save_path"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_projects_save_path">[docs]</a>    <span class="k">def</span> <span class="nf">set_projects_save_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the folder where the projects are saved.</span>

<span class="sd">        :param path: string of path</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;projects_save_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_radioView"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_radioView">[docs]</a>    <span class="k">def</span> <span class="nf">set_radioView</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radio_view</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the radiological/neurological orientation in mini viewer.</span>

<span class="sd">        - True for radiological</span>
<span class="sd">        - False for neurological</span>

<span class="sd">        :param radio_view: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;radio_view&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">radio_view</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_referential"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_referential">[docs]</a>    <span class="k">def</span> <span class="nf">set_referential</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ref</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the referential to image ref or world coordinates in anatomist_2</span>
<span class="sd">        data viewer</span>

<span class="sd">        :param ref: str; 0 for World Coordinates, 1 for Image ref</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;ref&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ref</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.setShowAllSlices"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.setShowAllSlices">[docs]</a>    <span class="k">def</span> <span class="nf">setShowAllSlices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show_all_slices</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the show_all_slides setting in miniviewer.</span>

<span class="sd">        :param show_all_slices: Boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;show_all_slices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">show_all_slices</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.setSourceImageDir"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.setSourceImageDir">[docs]</a>    <span class="k">def</span> <span class="nf">setSourceImageDir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_image_dir</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the source directory for project images.</span>

<span class="sd">        :param source_image_dir: String of path</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;source_image_dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source_image_dir</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_spm_path"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_spm_path">[docs]</a>    <span class="k">def</span> <span class="nf">set_spm_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the path of SPM (license version).</span>

<span class="sd">        :param path: string of path</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;spm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_spm_standalone_path"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_spm_standalone_path">[docs]</a>    <span class="k">def</span> <span class="nf">set_spm_standalone_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the path of SPM (standalone version).</span>

<span class="sd">        :param path: string of path</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;spm_standalone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.setTextColor"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.setTextColor">[docs]</a>    <span class="k">def</span> <span class="nf">setTextColor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set text color and save configuration.</span>

<span class="sd">        :param color: Color string (&#39;Black&#39;, &#39;Blue&#39;, &#39;Green&#39;, &#39;Grey&#39;,</span>
<span class="sd">                                    &#39;Orange&#39;, &#39;Red&#39;, &#39;Yellow&#39;, &#39;White&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;text_color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.setThumbnailTag"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.setThumbnailTag">[docs]</a>    <span class="k">def</span> <span class="nf">setThumbnailTag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thumbnail_tag</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the tag that is displayed in the mini viewer.</span>

<span class="sd">        :param thumbnail_tag: string</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;thumbnail_tag&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thumbnail_tag</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_use_afni"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_use_afni">[docs]</a>    <span class="k">def</span> <span class="nf">set_use_afni</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_afni</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the value of &quot;use_afni&quot; checkbox in the preferences.</span>

<span class="sd">        :param use_afni: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;use_afni&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">use_afni</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_use_ants"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_use_ants">[docs]</a>    <span class="k">def</span> <span class="nf">set_use_ants</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_ants</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the value of &quot;use_ants&quot; checkbox in the preferences.</span>

<span class="sd">        :param use_ants: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;use_ants&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">use_ants</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_use_fsl"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_use_fsl">[docs]</a>    <span class="k">def</span> <span class="nf">set_use_fsl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_fsl</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the value of &quot;use_fsl&quot; checkbox in the preferences.</span>

<span class="sd">        :param use_fsl: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;use_fsl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">use_fsl</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_use_matlab"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_use_matlab">[docs]</a>    <span class="k">def</span> <span class="nf">set_use_matlab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_matlab</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the value of &quot;use matlab&quot; checkbox in the preferences.</span>

<span class="sd">        :param use_matlab: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;use_matlab&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">use_matlab</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_use_matlab_standalone"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_use_matlab_standalone">[docs]</a>    <span class="k">def</span> <span class="nf">set_use_matlab_standalone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_matlab_standalone</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the value of &quot;use_matlab_standalone&quot; checkbox in the</span>
<span class="sd">        preferences.</span>

<span class="sd">        :param use_matlab: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;use_matlab_standalone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">use_matlab_standalone</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_user_mode"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_user_mode">[docs]</a>    <span class="k">def</span> <span class="nf">set_user_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_mode</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enable of disable user mode.</span>

<span class="sd">        :param user_mode: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;user_mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_mode</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_use_spm"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_use_spm">[docs]</a>    <span class="k">def</span> <span class="nf">set_use_spm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_spm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the value of &quot;use spm&quot; checkbox in the preferences.</span>

<span class="sd">        :param use_spm: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;use_spm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">use_spm</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.set_use_spm_standalone"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.set_use_spm_standalone">[docs]</a>    <span class="k">def</span> <span class="nf">set_use_spm_standalone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_spm_standalone</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the value of &quot;use spm standalone&quot; checkbox in the preferences.</span>

<span class="sd">        :param use_spm_standalone: boolean</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;use_spm_standalone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">use_spm_standalone</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.setViewerConfig"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.setViewerConfig">[docs]</a>    <span class="k">def</span> <span class="nf">setViewerConfig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_NeuRad</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sets user&#39;s configuration neuro or radio for data_viewer</span>

<span class="sd">        - neuro: neurological</span>
<span class="sd">        - radio: radiological</span>

<span class="sd">        :param config_NeuRad: string</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;config_NeuRad&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">config_NeuRad</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.setViewerFramerate"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.setViewerFramerate">[docs]</a>    <span class="k">def</span> <span class="nf">setViewerFramerate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">im_sec</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;sets user&#39;s framerate for data_viewer</span>

<span class="sd">        :param im_sec: int</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;im_sec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">im_sec</span>
        <span class="c1"># Then save the modification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveConfig</span><span class="p">()</span></div>

<div class="viewcode-block" id="Config.update_capsul_config"><a class="viewcode-back" href="../../populse_mia.html#populse_mia.software_properties.Config.update_capsul_config">[docs]</a>    <span class="k">def</span> <span class="nf">update_capsul_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update a global CapsulEngine object used for all operations in MIA</span>
<span class="sd">        application. The engine is created once when needed, and updated</span>
<span class="sd">        each time the config is saved.</span>

<span class="sd">        :returns: capsul.engine.CapsulEngine object</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">capsul_engine</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># don&#39;t do anything until the config is really created: this</span>
            <span class="c1"># avoids unneeded updates before it is actually used.</span>
            <span class="k">return</span>

        <span class="n">capsul_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_capsul_config</span><span class="p">(</span><span class="n">sync_from_engine</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">engine</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">capsul_engine</span>

        <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="n">capsul_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;engine_modules&quot;</span><span class="p">,</span> <span class="p">[])</span> <span class="o">+</span> <span class="p">[</span>
            <span class="s2">&quot;fom&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nipype&quot;</span><span class="p">,</span>
            <span class="s2">&quot;python&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fsl&quot;</span><span class="p">,</span>
            <span class="s2">&quot;freesurfer&quot;</span><span class="p">,</span>
            <span class="s2">&quot;axon&quot;</span><span class="p">,</span>
            <span class="s2">&quot;afni&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ants&quot;</span><span class="p">,</span>
            <span class="s2">&quot;somaworkflow&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">engine</span><span class="o">.</span><span class="n">load_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

        <span class="n">engine_config</span> <span class="o">=</span> <span class="n">capsul_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;engine&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">engine_config</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">environment</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">engine_config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">c</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span>
                    <span class="s2">&quot;capsul_engine&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">c</span>
                    <span class="ow">or</span> <span class="s2">&quot;uses&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">c</span><span class="p">[</span><span class="s2">&quot;capsul_engine&quot;</span><span class="p">]</span>
                <span class="p">):</span>
                    <span class="n">c</span><span class="p">[</span><span class="s2">&quot;capsul_engine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s2">&quot;uses&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="n">engine</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">module_name</span><span class="p">(</span><span class="n">m</span><span class="p">):</span> <span class="s2">&quot;ALL&quot;</span>
                            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                        <span class="p">}</span>
                    <span class="p">}</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">engine</span><span class="o">.</span><span class="n">import_configs</span><span class="p">(</span><span class="n">environment</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">cont_on_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span>
                        <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">An issue is detected in the Mia&#39;s &quot;</span>
                        <span class="s2">&quot;configuration:</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="s2">Please check the settings &quot;</span>
                        <span class="s2">&quot;in File &gt; Mia Preferences &gt; Pipeline &quot;</span>
                        <span class="s2">&quot;...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>
                    <span class="p">)</span>

        <span class="k">return</span> <span class="n">engine</span></div></div>
</pre></div>

      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        <a class="uplink" href="../../index.html">Contents</a>
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2022, populse.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
  </body>
</html>